2025-02-26 22:42:52,955 - historical_importer - INFO - Starting historical data import
2025-02-26 22:42:53,070 - historical_importer - INFO - Importing 5 years of historical data
2025-02-26 22:42:53,100 - historical_importer - INFO - Fetching 5 years of data for PKO.WA
2025-02-26 22:42:54,367 - historical_importer - ERROR - Error saving historical data: (psycopg2.errors.UndefinedTable) relation "historical_stock_prices" does not exist
LINE 2:                 INSERT INTO historical_stock_prices 
                                    ^

[SQL: 
                INSERT INTO historical_stock_prices 
                (symbol, timestamp, open, high, low, close, volume)
                SELECT symbol, timestamp, open, high, low, close, volume 
                FROM staging_stock_prices
                ON CONFLICT (symbol, timestamp) 
                DO UPDATE SET
                    open = EXCLUDED.open,
                    high = EXCLUDED.high,
                    low = EXCLUDED.low,
                    close = EXCLUDED.close,
                    volume = EXCLUDED.volume;
            ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-02-26 22:42:54,369 - historical_importer - INFO - Imported 0 records for PKO
2025-02-26 22:42:55,377 - historical_importer - INFO - Fetching 5 years of data for PKN.WA
2025-02-26 22:42:55,746 - historical_importer - ERROR - Error saving historical data: (psycopg2.errors.UndefinedColumn) column "('open', 'PKN.WA')" of relation "staging_stock_prices" does not exist
LINE 1: ...ck_prices ("('symbol', '')", "('timestamp', '')", "('open', ...
                                                             ^

[SQL: INSERT INTO staging_stock_prices ("('symbol', '')", "('timestamp', '')", "('open', 'PKN.WA')", "('high', 'PKN.WA')", "('low', 'PKN.WA')", "('close', 'PKN.WA')", "('volume', 'PKN.WA')") VALUES (%(A'symbol',_''Z__0)s, %(A'timestamp',_''Z__0)s, %(A'open ... 201070 characters truncated ... A'Z__999)s, %(A'low',_'PKN_WA'Z__999)s, %(A'close',_'PKN_WA'Z__999)s, %(A'volume',_'PKN_WA'Z__999)s)]
[parameters: {"A'open',_'PKN_WA'Z__0": 45.61237386583663, "A'low',_'PKN_WA'Z__0": 42.193363014034006, "A'volume',_'PKN_WA'Z__0": 3039912, "A'close',_'PKN_WA'Z__0": 44.953102111816406, "A'timestamp',_''Z__0": datetime.datetime(2020, 2, 28, 0, 0), "A'high',_'PKN_WA'Z__0": 45.81168715400911, "A'symbol',_''Z__0": 'PKN', "A'open',_'PKN_WA'Z__1": 47.14555882258641, "A'low',_'PKN_WA'Z__1": 45.65836663768811, "A'volume',_'PKN_WA'Z__1": 2037669, "A'close',_'PKN_WA'Z__1": 46.42496109008789, "A'timestamp',_''Z__1": datetime.datetime(2020, 3, 2, 0, 0), "A'high',_'PKN_WA'Z__1": 47.6821755241314, "A'symbol',_''Z__1": 'PKN', "A'open',_'PKN_WA'Z__2": 47.37554332045723, "A'low',_'PKN_WA'Z__2": 46.47096150385288, "A'volume',_'PKN_WA'Z__2": 1804094, "A'close',_'PKN_WA'Z__2": 47.72817611694336, "A'timestamp',_''Z__2": datetime.datetime(2020, 3, 3, 0, 0), "A'high',_'PKN_WA'Z__2": 48.14213788203203, "A'symbol',_''Z__2": 'PKN', "A'open',_'PKN_WA'Z__3": 47.52885788715139, "A'low',_'PKN_WA'Z__3": 45.25973892211914, "A'volume',_'PKN_WA'Z__3": 1696461, "A'close',_'PKN_WA'Z__3": 45.25973892211914, "A'timestamp',_''Z__3": datetime.datetime(2020, 3, 4, 0, 0), "A'high',_'PKN_WA'Z__3": 47.52885788715139, "A'symbol',_''Z__3": 'PKN', "A'open',_'PKN_WA'Z__4": 46.30231118828197, "A'low',_'PKN_WA'Z__4": 43.358588050261936, "A'volume',_'PKN_WA'Z__4": 1742634, "A'close',_'PKN_WA'Z__4": 43.588565826416016, "A'timestamp',_''Z__4": datetime.datetime(2020, 3, 5, 0, 0), "A'high',_'PKN_WA'Z__4": 46.455627756167296, "A'symbol',_''Z__4": 'PKN', "A'open',_'PKN_WA'Z__5": 43.12860991989979, "A'low',_'PKN_WA'Z__5": 41.028142401708536, "A'volume',_'PKN_WA'Z__5": 1785479, "A'close',_'PKN_WA'Z__5": 41.6567497253418, "A'timestamp',_''Z__5": datetime.datetime(2020, 3, 6, 0, 0), "A'high',_'PKN_WA'Z__5": 43.312593906382666, "A'symbol',_''Z__5": 'PKN', "A'open',_'PKN_WA'Z__6": 38.32972739895677, "A'low',_'PKN_WA'Z__6": 37.77777838862743, "A'volume',_'PKN_WA'Z__6": 3127163, "A'close',_'PKN_WA'Z__6": 41.5800895690918, "A'timestamp',_''Z__6": datetime.datetime(2020, 3, 9, 0, 0), "A'high',_'PKN_WA'Z__6": 43.021285213777766, "A'symbol',_''Z__6": 'PKN', "A'open',_'PKN_WA'Z__7": 42.821970756874414 ... 6900 parameters truncated ... "A'symbol',_''Z__992": 'PKN', "A'open',_'PKN_WA'Z__993": 61.31461900073905, "A'low',_'PKN_WA'Z__993": 60.5691496991742, "A'volume',_'PKN_WA'Z__993": 3073800, "A'close',_'PKN_WA'Z__993": 60.96051788330078, "A'timestamp',_''Z__993": datetime.datetime(2024, 2, 5, 0, 0), "A'high',_'PKN_WA'Z__993": 62.097355368992204, "A'symbol',_''Z__993": 'PKN', "A'open',_'PKN_WA'Z__994": 61.044387235077636, "A'low',_'PKN_WA'Z__994": 60.830062497966125, "A'volume',_'PKN_WA'Z__994": 1636451, "A'close',_'PKN_WA'Z__994": 61.35188674926758, "A'timestamp',_''Z__994": datetime.datetime(2024, 2, 6, 0, 0), "A'high',_'PKN_WA'Z__994": 61.80849007847857, "A'symbol',_''Z__994": 'PKN', "A'open',_'PKN_WA'Z__995": 61.40780233556173, "A'low',_'PKN_WA'Z__995": 61.03506767598135, "A'volume',_'PKN_WA'Z__995": 1442710, "A'close',_'PKN_WA'Z__995": 61.37984848022461, "A'timestamp',_''Z__995": datetime.datetime(2024, 2, 7, 0, 0), "A'high',_'PKN_WA'Z__995": 61.920306271827734, "A'symbol',_''Z__995": 'PKN', "A'open',_'PKN_WA'Z__996": 61.3798485151727, "A'low',_'PKN_WA'Z__996": 60.71824787096892, "A'volume',_'PKN_WA'Z__996": 1793512, "A'close',_'PKN_WA'Z__996": 61.193477630615234, "A'timestamp',_''Z__996": datetime.datetime(2024, 2, 8, 0, 0), "A'high',_'PKN_WA'Z__996": 61.500984258143305, "A'symbol',_''Z__996": 'PKN', "A'open',_'PKN_WA'Z__997": 61.240070286023425, "A'low',_'PKN_WA'Z__997": 61.03506587384113, "A'volume',_'PKN_WA'Z__997": 1996658, "A'close',_'PKN_WA'Z__997": 61.547576904296875, "A'timestamp',_''Z__997": datetime.datetime(2024, 2, 9, 0, 0), "A'high',_'PKN_WA'Z__997": 61.771214849712976, "A'symbol',_''Z__997": 'PKN', "A'open',_'PKN_WA'Z__998": 61.687348018409786, "A'low',_'PKN_WA'Z__998": 61.33325400182001, "A'volume',_'PKN_WA'Z__998": 4029834, "A'close',_'PKN_WA'Z__998": 62.38622283935547, "A'timestamp',_''Z__998": datetime.datetime(2024, 2, 12, 0, 0), "A'high',_'PKN_WA'Z__998": 62.75895749905762, "A'symbol',_''Z__998": 'PKN', "A'open',_'PKN_WA'Z__999": 62.432817004524196, "A'low',_'PKN_WA'Z__999": 61.435755883003935, "A'volume',_'PKN_WA'Z__999": 2213795, "A'close',_'PKN_WA'Z__999": 61.59416580200195, "A'timestamp',_''Z__999": datetime.datetime(2024, 2, 13, 0, 0), "A'high',_'PKN_WA'Z__999": 63.159645676936044, "A'symbol',_''Z__999": 'PKN'}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-02-26 22:42:55,746 - historical_importer - INFO - Imported 0 records for PKN
2025-02-26 22:42:56,751 - historical_importer - INFO - Fetching 5 years of data for PZU.WA
2025-02-26 22:42:57,062 - historical_importer - ERROR - Error saving historical data: (psycopg2.errors.UndefinedColumn) column "('open', 'PZU.WA')" of relation "staging_stock_prices" does not exist
LINE 1: ...ck_prices ("('symbol', '')", "('timestamp', '')", "('open', ...
                                                             ^

[SQL: INSERT INTO staging_stock_prices ("('symbol', '')", "('timestamp', '')", "('open', 'PZU.WA')", "('high', 'PZU.WA')", "('low', 'PZU.WA')", "('close', 'PZU.WA')", "('volume', 'PZU.WA')") VALUES (%(A'symbol',_''Z__0)s, %(A'timestamp',_''Z__0)s, %(A'open ... 201070 characters truncated ... A'Z__999)s, %(A'low',_'PZU_WA'Z__999)s, %(A'close',_'PZU_WA'Z__999)s, %(A'volume',_'PZU_WA'Z__999)s)]
[parameters: {"A'low',_'PZU_WA'Z__0": 24.931228113024858, "A'open',_'PZU_WA'Z__0": 26.078995782584656, "A'close',_'PZU_WA'Z__0": 25.243595123291016, "A'timestamp',_''Z__0": datetime.datetime(2020, 2, 28, 0, 0), "A'high',_'PZU_WA'Z__0": 26.078995782584656, "A'symbol',_''Z__0": 'PZU', "A'volume',_'PZU_WA'Z__0": 3567606, "A'low',_'PZU_WA'Z__1": 24.698770335910552, "A'open',_'PZU_WA'Z__1": 25.85380117717029, "A'close',_'PZU_WA'Z__1": 25.388883590698242, "A'timestamp',_''Z__1": datetime.datetime(2020, 3, 2, 0, 0), "A'high',_'PZU_WA'Z__1": 26.093523095326702, "A'symbol',_''Z__1": 'PZU', "A'volume',_'PZU_WA'Z__1": 2421089, "A'low',_'PZU_WA'Z__2": 25.54869545281171, "A'open',_'PZU_WA'Z__2": 25.62860367686095, "A'close',_'PZU_WA'Z__2": 26.376832962036133, "A'timestamp',_''Z__2": datetime.datetime(2020, 3, 3, 0, 0), "A'high',_'PZU_WA'Z__2": 26.580233698796235, "A'symbol',_''Z__2": 'PZU', "A'volume',_'PZU_WA'Z__2": 2335620, "A'low',_'PZU_WA'Z__3": 26.158901307888918, "A'open',_'PZU_WA'Z__3": 26.304188740910185, "A'close',_'PZU_WA'Z__3": 26.58749771118164, "A'timestamp',_''Z__3": datetime.datetime(2020, 3, 4, 0, 0), "A'high',_'PZU_WA'Z__3": 26.979772949000868, "A'symbol',_''Z__3": 'PZU', "A'volume',_'PZU_WA'Z__3": 2231654, "A'low',_'PZU_WA'Z__4": 26.006351470947266, "A'open',_'PZU_WA'Z__4": 26.878073322105905, "A'close',_'PZU_WA'Z__4": 26.006351470947266, "A'timestamp',_''Z__4": datetime.datetime(2020, 3, 5, 0, 0), "A'high',_'PZU_WA'Z__4": 27.342990903756547, "A'symbol',_''Z__4": 'PZU', "A'volume',_'PZU_WA'Z__4": 1854994, "A'low',_'PZU_WA'Z__5": 24.953022609210514, "A'open',_'PZU_WA'Z__5": 25.635872775588094, "A'close',_'PZU_WA'Z__5": 25.279918670654297, "A'timestamp',_''Z__5": datetime.datetime(2020, 3, 6, 0, 0), "A'high',_'PZU_WA'Z__5": 26.04994019637437, "A'symbol',_''Z__5": 'PZU', "A'volume',_'PZU_WA'Z__5": 2346680, "A'low',_'PZU_WA'Z__6": 22.61390335698317, "A'open',_'PZU_WA'Z__6": 23.97233636038644, "A'close',_'PZU_WA'Z__6": 22.8826847076416, "A'timestamp',_''Z__6": datetime.datetime(2020, 3, 9, 0, 0), "A'high',_'PZU_WA'Z__6": 24.081302634111907, "A'symbol',_''Z__6": 'PZU', "A'volume',_'PZU_WA'Z__6": 2706524, "A'low',_'PZU_WA'Z__7": 22.59211029708132 ... 6900 parameters truncated ... "A'volume',_'PZU_WA'Z__992": 1605623, "A'low',_'PZU_WA'Z__993": 44.255107390166586, "A'open',_'PZU_WA'Z__993": 44.581580052476276, "A'close',_'PZU_WA'Z__993": 44.43648147583008, "A'timestamp',_''Z__993": datetime.datetime(2024, 2, 5, 0, 0), "A'high',_'PZU_WA'Z__993": 45.161974359061084, "A'symbol',_''Z__993": 'PZU', "A'volume',_'PZU_WA'Z__993": 1996124, "A'low',_'PZU_WA'Z__994": 44.472758641885854, "A'open',_'PZU_WA'Z__994": 44.56344395838502, "A'close',_'PZU_WA'Z__994": 44.844573974609375, "A'timestamp',_''Z__994": datetime.datetime(2024, 2, 6, 0, 0), "A'high',_'PZU_WA'Z__994": 45.50658647143794, "A'symbol',_''Z__994": 'PZU', "A'volume',_'PZU_WA'Z__994": 2029732, "A'low',_'PZU_WA'Z__995": 44.50903148903357, "A'open',_'PZU_WA'Z__995": 44.84457129131099, "A'close',_'PZU_WA'Z__995": 44.862709045410156, "A'timestamp',_''Z__995": datetime.datetime(2024, 2, 7, 0, 0), "A'high',_'PZU_WA'Z__995": 45.43403273213102, "A'symbol',_''Z__995": 'PZU', "A'volume',_'PZU_WA'Z__995": 1400023, "A'low',_'PZU_WA'Z__996": 43.157798767089844, "A'open',_'PZU_WA'Z__996": 44.88991452240575, "A'close',_'PZU_WA'Z__996": 43.157798767089844, "A'timestamp',_''Z__996": datetime.datetime(2024, 2, 8, 0, 0), "A'high',_'PZU_WA'Z__996": 44.98059983464145, "A'symbol',_''Z__996": 'PZU', "A'volume',_'PZU_WA'Z__996": 1380473, "A'low',_'PZU_WA'Z__997": 42.53206401168334, "A'open',_'PZU_WA'Z__997": 43.17593875638595, "A'close',_'PZU_WA'Z__997": 42.62274932861328, "A'timestamp',_''Z__997": datetime.datetime(2024, 2, 9, 0, 0), "A'high',_'PZU_WA'Z__997": 43.34824224232208, "A'symbol',_''Z__997": 'PZU', "A'volume',_'PZU_WA'Z__997": 854835, "A'low',_'PZU_WA'Z__998": 42.42323701972987, "A'open',_'PZU_WA'Z__998": 42.740642544386716, "A'close',_'PZU_WA'Z__998": 43.375450134277344, "A'timestamp',_''Z__998": datetime.datetime(2024, 2, 12, 0, 0), "A'high',_'PZU_WA'Z__998": 43.60216688356521, "A'symbol',_''Z__998": 'PZU', "A'volume',_'PZU_WA'Z__998": 830959, "A'low',_'PZU_WA'Z__999": 42.695299889631045, "A'open',_'PZU_WA'Z__999": 43.42985994334832, "A'close',_'PZU_WA'Z__999": 42.74064254760742, "A'timestamp',_''Z__999": datetime.datetime(2024, 2, 13, 0, 0), "A'high',_'PZU_WA'Z__999": 43.56589137670051, "A'symbol',_''Z__999": 'PZU', "A'volume',_'PZU_WA'Z__999": 992259}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-02-26 22:42:57,062 - historical_importer - INFO - Imported 0 records for PZU
2025-02-26 22:42:58,066 - historical_importer - INFO - Fetching 5 years of data for PEO.WA
2025-02-26 22:42:58,410 - historical_importer - ERROR - Error saving historical data: (psycopg2.errors.UndefinedColumn) column "('open', 'PEO.WA')" of relation "staging_stock_prices" does not exist
LINE 1: ...ck_prices ("('symbol', '')", "('timestamp', '')", "('open', ...
                                                             ^

[SQL: INSERT INTO staging_stock_prices ("('symbol', '')", "('timestamp', '')", "('open', 'PEO.WA')", "('high', 'PEO.WA')", "('low', 'PEO.WA')", "('close', 'PEO.WA')", "('volume', 'PEO.WA')") VALUES (%(A'symbol',_''Z__0)s, %(A'timestamp',_''Z__0)s, %(A'open ... 201070 characters truncated ... A'Z__999)s, %(A'low',_'PEO_WA'Z__999)s, %(A'close',_'PEO_WA'Z__999)s, %(A'volume',_'PEO_WA'Z__999)s)]
[parameters: {"A'volume',_'PEO_WA'Z__0": 1628582, "A'close',_'PEO_WA'Z__0": 68.96673583984375, "A'timestamp',_''Z__0": datetime.datetime(2020, 2, 28, 0, 0), "A'high',_'PEO_WA'Z__0": 72.46050657480659, "A'open',_'PEO_WA'Z__0": 71.66148524009098, "A'low',_'PEO_WA'Z__0": 68.93540084954573, "A'symbol',_''Z__0": 'PEO', "A'volume',_'PEO_WA'Z__1": 756361, "A'close',_'PEO_WA'Z__1": 69.92243194580078, "A'timestamp',_''Z__1": datetime.datetime(2020, 3, 2, 0, 0), "A'high',_'PEO_WA'Z__1": 72.63284584594086, "A'open',_'PEO_WA'Z__1": 70.4237798362002, "A'low',_'PEO_WA'Z__1": 68.27738380689404, "A'symbol',_''Z__1": 'PEO', "A'volume',_'PEO_WA'Z__2": 998119, "A'close',_'PEO_WA'Z__2": 74.24656677246094, "A'timestamp',_''Z__2": datetime.datetime(2020, 3, 3, 0, 0), "A'high',_'PEO_WA'Z__2": 74.6382452264001, "A'open',_'PEO_WA'Z__2": 70.6587907000089, "A'low',_'PEO_WA'Z__2": 70.51778621752923, "A'symbol',_''Z__2": 'PEO', "A'volume',_'PEO_WA'Z__3": 527940, "A'close',_'PEO_WA'Z__3": 73.7452163696289, "A'timestamp',_''Z__3": datetime.datetime(2020, 3, 4, 0, 0), "A'high',_'PEO_WA'Z__3": 75.1082556704395, "A'open',_'PEO_WA'Z__3": 73.94889083231422, "A'low',_'PEO_WA'Z__3": 73.16553395056627, "A'symbol',_''Z__3": 'PEO', "A'volume',_'PEO_WA'Z__4": 515614, "A'close',_'PEO_WA'Z__4": 72.77385711669922, "A'timestamp',_''Z__4": datetime.datetime(2020, 3, 5, 0, 0), "A'high',_'PEO_WA'Z__4": 74.99858784125176, "A'open',_'PEO_WA'Z__4": 74.6695793780217, "A'low',_'PEO_WA'Z__4": 72.58585313435901, "A'symbol',_''Z__4": 'PEO', "A'volume',_'PEO_WA'Z__5": 940230, "A'close',_'PEO_WA'Z__5": 70.2514419555664, "A'timestamp',_''Z__5": datetime.datetime(2020, 3, 6, 0, 0), "A'high',_'PEO_WA'Z__5": 72.38217352587247, "A'open',_'PEO_WA'Z__5": 71.99049510417028, "A'low',_'PEO_WA'Z__5": 69.57775459211557, "A'symbol',_''Z__5": 'PEO', "A'volume',_'PEO_WA'Z__6": 833133, "A'close',_'PEO_WA'Z__6": 64.47026824951172, "A'timestamp',_''Z__6": datetime.datetime(2020, 3, 9, 0, 0), "A'high',_'PEO_WA'Z__6": 67.36868607369495, "A'open',_'PEO_WA'Z__6": 66.58532925888454, "A'low',_'PEO_WA'Z__6": 63.091558582014706, "A'symbol',_''Z__6": 'PEO', "A'volume',_'PEO_WA'Z__7": 757085 ... 6900 parameters truncated ... "A'symbol',_''Z__992": 'PEO', "A'volume',_'PEO_WA'Z__993": 697117, "A'close',_'PEO_WA'Z__993": 142.44935607910156, "A'timestamp',_''Z__993": datetime.datetime(2024, 2, 5, 0, 0), "A'high',_'PEO_WA'Z__993": 145.4151813774105, "A'open',_'PEO_WA'Z__993": 143.79745724073342, "A'low',_'PEO_WA'Z__993": 142.26961200026946, "A'symbol',_''Z__993": 'PEO', "A'volume',_'PEO_WA'Z__994": 602024, "A'close',_'PEO_WA'Z__994": 142.44935607910156, "A'timestamp',_''Z__994": datetime.datetime(2024, 2, 6, 0, 0), "A'high',_'PEO_WA'Z__994": 145.28036303309082, "A'open',_'PEO_WA'Z__994": 142.89872313297886, "A'low',_'PEO_WA'Z__994": 141.86518439449875, "A'symbol',_''Z__994": 'PEO', "A'volume',_'PEO_WA'Z__995": 589225, "A'close',_'PEO_WA'Z__995": 143.57278442382812, "A'timestamp',_''Z__995": datetime.datetime(2024, 2, 7, 0, 0), "A'high',_'PEO_WA'Z__995": 143.61772387528703, "A'open',_'PEO_WA'Z__995": 142.76392915194887, "A'low',_'PEO_WA'Z__995": 140.8316424479781, "A'symbol',_''Z__995": 'PEO', "A'volume',_'PEO_WA'Z__996": 553609, "A'close',_'PEO_WA'Z__996": 142.0, "A'timestamp',_''Z__996": datetime.datetime(2024, 2, 8, 0, 0), "A'high',_'PEO_WA'Z__996": 144.69620253164558, "A'open',_'PEO_WA'Z__996": 144.24683544303798, "A'low',_'PEO_WA'Z__996": 140.60695928259742, "A'symbol',_''Z__996": 'PEO', "A'volume',_'PEO_WA'Z__997": 499612, "A'close',_'PEO_WA'Z__997": 142.0, "A'timestamp',_''Z__997": datetime.datetime(2024, 2, 9, 0, 0), "A'high',_'PEO_WA'Z__997": 143.70758945127076, "A'open',_'PEO_WA'Z__997": 141.5506329113924, "A'low',_'PEO_WA'Z__997": 141.10126582278482, "A'symbol',_''Z__997": 'PEO', "A'volume',_'PEO_WA'Z__998": 396464, "A'close',_'PEO_WA'Z__998": 142.67404174804688, "A'timestamp',_''Z__998": datetime.datetime(2024, 2, 12, 0, 0), "A'high',_'PEO_WA'Z__998": 143.97720348113694, "A'open',_'PEO_WA'Z__998": 142.8537858295775, "A'low',_'PEO_WA'Z__998": 139.3037887933686, "A'symbol',_''Z__998": 'PEO', "A'volume',_'PEO_WA'Z__999": 345753, "A'close',_'PEO_WA'Z__999": 142.0, "A'timestamp',_''Z__999": datetime.datetime(2024, 2, 13, 0, 0), "A'high',_'PEO_WA'Z__999": 143.30316181424297, "A'open',_'PEO_WA'Z__999": 142.359488185448, "A'low',_'PEO_WA'Z__999": 140.65189873417722, "A'symbol',_''Z__999": 'PEO'}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-02-26 22:42:58,411 - historical_importer - INFO - Imported 0 records for PEO
2025-02-26 22:42:59,416 - historical_importer - INFO - Fetching 5 years of data for DNP.WA
2025-02-26 22:42:59,668 - historical_importer - ERROR - Error saving historical data: (psycopg2.errors.UndefinedColumn) column "('open', 'DNP.WA')" of relation "staging_stock_prices" does not exist
LINE 1: ...ck_prices ("('symbol', '')", "('timestamp', '')", "('open', ...
                                                             ^

[SQL: INSERT INTO staging_stock_prices ("('symbol', '')", "('timestamp', '')", "('open', 'DNP.WA')", "('high', 'DNP.WA')", "('low', 'DNP.WA')", "('close', 'DNP.WA')", "('volume', 'DNP.WA')") VALUES (%(A'symbol',_''Z__0)s, %(A'timestamp',_''Z__0)s, %(A'open ... 201070 characters truncated ... A'Z__999)s, %(A'low',_'DNP_WA'Z__999)s, %(A'close',_'DNP_WA'Z__999)s, %(A'volume',_'DNP_WA'Z__999)s)]
[parameters: {"A'low',_'DNP_WA'Z__0": 136.39999389648438, "A'timestamp',_''Z__0": datetime.datetime(2020, 2, 28, 0, 0), "A'close',_'DNP_WA'Z__0": 141.8000030517578, "A'symbol',_''Z__0": 'DNP', "A'open',_'DNP_WA'Z__0": 139.39999389648438, "A'volume',_'DNP_WA'Z__0": 567867, "A'high',_'DNP_WA'Z__0": 145.6999969482422, "A'low',_'DNP_WA'Z__1": 146.60000610351562, "A'timestamp',_''Z__1": datetime.datetime(2020, 3, 2, 0, 0), "A'close',_'DNP_WA'Z__1": 151.8000030517578, "A'symbol',_''Z__1": 'DNP', "A'open',_'DNP_WA'Z__1": 146.60000610351562, "A'volume',_'DNP_WA'Z__1": 375327, "A'high',_'DNP_WA'Z__1": 154.6999969482422, "A'low',_'DNP_WA'Z__2": 153.0, "A'timestamp',_''Z__2": datetime.datetime(2020, 3, 3, 0, 0), "A'close',_'DNP_WA'Z__2": 155.0, "A'symbol',_''Z__2": 'DNP', "A'open',_'DNP_WA'Z__2": 153.0, "A'volume',_'DNP_WA'Z__2": 343482, "A'high',_'DNP_WA'Z__2": 161.10000610351562, "A'low',_'DNP_WA'Z__3": 152.1999969482422, "A'timestamp',_''Z__3": datetime.datetime(2020, 3, 4, 0, 0), "A'close',_'DNP_WA'Z__3": 154.6999969482422, "A'symbol',_''Z__3": 'DNP', "A'open',_'DNP_WA'Z__3": 152.1999969482422, "A'volume',_'DNP_WA'Z__3": 134702, "A'high',_'DNP_WA'Z__3": 158.0, "A'low',_'DNP_WA'Z__4": 155.1999969482422, "A'timestamp',_''Z__4": datetime.datetime(2020, 3, 5, 0, 0), "A'close',_'DNP_WA'Z__4": 157.89999389648438, "A'symbol',_''Z__4": 'DNP', "A'open',_'DNP_WA'Z__4": 157.39999389648438, "A'volume',_'DNP_WA'Z__4": 133927, "A'high',_'DNP_WA'Z__4": 159.1999969482422, "A'low',_'DNP_WA'Z__5": 153.1999969482422, "A'timestamp',_''Z__5": datetime.datetime(2020, 3, 6, 0, 0), "A'close',_'DNP_WA'Z__5": 156.5, "A'symbol',_''Z__5": 'DNP', "A'open',_'DNP_WA'Z__5": 156.0, "A'volume',_'DNP_WA'Z__5": 137724, "A'high',_'DNP_WA'Z__5": 157.1999969482422, "A'low',_'DNP_WA'Z__6": 144.6999969482422, "A'timestamp',_''Z__6": datetime.datetime(2020, 3, 9, 0, 0), "A'close',_'DNP_WA'Z__6": 145.60000610351562, "A'symbol',_''Z__6": 'DNP', "A'open',_'DNP_WA'Z__6": 145.0, "A'volume',_'DNP_WA'Z__6": 199497, "A'high',_'DNP_WA'Z__6": 152.0, "A'low',_'DNP_WA'Z__7": 146.0 ... 6900 parameters truncated ... "A'high',_'DNP_WA'Z__992": 465.0, "A'low',_'DNP_WA'Z__993": 456.20001220703125, "A'timestamp',_''Z__993": datetime.datetime(2024, 2, 5, 0, 0), "A'close',_'DNP_WA'Z__993": 459.0, "A'symbol',_''Z__993": 'DNP', "A'open',_'DNP_WA'Z__993": 464.0, "A'volume',_'DNP_WA'Z__993": 261980, "A'high',_'DNP_WA'Z__993": 472.20001220703125, "A'low',_'DNP_WA'Z__994": 444.5, "A'timestamp',_''Z__994": datetime.datetime(2024, 2, 6, 0, 0), "A'close',_'DNP_WA'Z__994": 450.0, "A'symbol',_''Z__994": 'DNP', "A'open',_'DNP_WA'Z__994": 460.0, "A'volume',_'DNP_WA'Z__994": 201094, "A'high',_'DNP_WA'Z__994": 461.8999938964844, "A'low',_'DNP_WA'Z__995": 445.5, "A'timestamp',_''Z__995": datetime.datetime(2024, 2, 7, 0, 0), "A'close',_'DNP_WA'Z__995": 452.5, "A'symbol',_''Z__995": 'DNP', "A'open',_'DNP_WA'Z__995": 446.29998779296875, "A'volume',_'DNP_WA'Z__995": 142706, "A'high',_'DNP_WA'Z__995": 454.79998779296875, "A'low',_'DNP_WA'Z__996": 438.0, "A'timestamp',_''Z__996": datetime.datetime(2024, 2, 8, 0, 0), "A'close',_'DNP_WA'Z__996": 440.6000061035156, "A'symbol',_''Z__996": 'DNP', "A'open',_'DNP_WA'Z__996": 452.5, "A'volume',_'DNP_WA'Z__996": 216039, "A'high',_'DNP_WA'Z__996": 456.0, "A'low',_'DNP_WA'Z__997": 435.6000061035156, "A'timestamp',_''Z__997": datetime.datetime(2024, 2, 9, 0, 0), "A'close',_'DNP_WA'Z__997": 437.3999938964844, "A'symbol',_''Z__997": 'DNP', "A'open',_'DNP_WA'Z__997": 440.0, "A'volume',_'DNP_WA'Z__997": 190226, "A'high',_'DNP_WA'Z__997": 443.3999938964844, "A'low',_'DNP_WA'Z__998": 436.1000061035156, "A'timestamp',_''Z__998": datetime.datetime(2024, 2, 12, 0, 0), "A'close',_'DNP_WA'Z__998": 448.0, "A'symbol',_''Z__998": 'DNP', "A'open',_'DNP_WA'Z__998": 439.5, "A'volume',_'DNP_WA'Z__998": 113158, "A'high',_'DNP_WA'Z__998": 450.5, "A'low',_'DNP_WA'Z__999": 428.70001220703125, "A'timestamp',_''Z__999": datetime.datetime(2024, 2, 13, 0, 0), "A'close',_'DNP_WA'Z__999": 431.3999938964844, "A'symbol',_''Z__999": 'DNP', "A'open',_'DNP_WA'Z__999": 448.0, "A'volume',_'DNP_WA'Z__999": 136161, "A'high',_'DNP_WA'Z__999": 452.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-02-26 22:42:59,669 - historical_importer - INFO - Imported 0 records for DNP
2025-02-26 22:43:00,672 - historical_importer - INFO - Fetching 5 years of data for SPL.WA
2025-02-26 22:43:01,008 - historical_importer - ERROR - Error saving historical data: (psycopg2.errors.UndefinedColumn) column "('open', 'SPL.WA')" of relation "staging_stock_prices" does not exist
LINE 1: ...ck_prices ("('symbol', '')", "('timestamp', '')", "('open', ...
                                                             ^

[SQL: INSERT INTO staging_stock_prices ("('symbol', '')", "('timestamp', '')", "('open', 'SPL.WA')", "('high', 'SPL.WA')", "('low', 'SPL.WA')", "('close', 'SPL.WA')", "('volume', 'SPL.WA')") VALUES (%(A'symbol',_''Z__0)s, %(A'timestamp',_''Z__0)s, %(A'open ... 201070 characters truncated ... A'Z__999)s, %(A'low',_'SPL_WA'Z__999)s, %(A'close',_'SPL_WA'Z__999)s, %(A'volume',_'SPL_WA'Z__999)s)]
[parameters: {"A'high',_'SPL_WA'Z__0": 227.75777439247904, "A'volume',_'SPL_WA'Z__0": 155782, "A'open',_'SPL_WA'Z__0": 221.3736602243684, "A'close',_'SPL_WA'Z__0": 216.36988830566406, "A'timestamp',_''Z__0": datetime.datetime(2020, 2, 28, 0, 0), "A'symbol',_''Z__0": 'SPL', "A'low',_'SPL_WA'Z__0": 213.2640952074214, "A'high',_'SPL_WA'Z__1": 225.8597834164241, "A'volume',_'SPL_WA'Z__1": 108224, "A'open',_'SPL_WA'Z__1": 224.6519822972952, "A'close',_'SPL_WA'Z__1": 224.30690002441406, "A'timestamp',_''Z__1": datetime.datetime(2020, 3, 2, 0, 0), "A'symbol',_''Z__1": 'SPL', "A'low',_'SPL_WA'Z__1": 217.4051492544321, "A'high',_'SPL_WA'Z__2": 240.6985545633419, "A'volume',_'SPL_WA'Z__2": 112138, "A'open',_'SPL_WA'Z__2": 224.30689672569497, "A'close',_'SPL_WA'Z__2": 234.8320770263672, "A'timestamp',_''Z__2": datetime.datetime(2020, 3, 3, 0, 0), "A'symbol',_''Z__2": 'SPL', "A'low',_'SPL_WA'Z__2": 222.58145905857424, "A'high',_'SPL_WA'Z__3": 238.45548395566254, "A'volume',_'SPL_WA'Z__3": 53365, "A'open',_'SPL_WA'Z__3": 231.20865090920108, "A'close',_'SPL_WA'Z__3": 236.3849639892578, "A'timestamp',_''Z__3": datetime.datetime(2020, 3, 4, 0, 0), "A'symbol',_''Z__3": 'SPL', "A'low',_'SPL_WA'Z__3": 231.20865090920108, "A'high',_'SPL_WA'Z__4": 238.45547628874732, "A'volume',_'SPL_WA'Z__4": 58814, "A'open',_'SPL_WA'Z__4": 232.93408111316418, "A'close',_'SPL_WA'Z__4": 230.17337036132812, "A'timestamp',_''Z__4": datetime.datetime(2020, 3, 5, 0, 0), "A'symbol',_''Z__4": 'SPL', "A'low',_'SPL_WA'Z__4": 228.79304131349906, "A'high',_'SPL_WA'Z__5": 227.24013058963888, "A'volume',_'SPL_WA'Z__5": 74158, "A'open',_'SPL_WA'Z__5": 225.51469295975843, "A'close',_'SPL_WA'Z__5": 217.5776824951172, "A'timestamp',_''Z__5": datetime.datetime(2020, 3, 6, 0, 0), "A'symbol',_''Z__5": 'SPL', "A'low',_'SPL_WA'Z__5": 213.9542661051771, "A'high',_'SPL_WA'Z__6": 208.77796976189865, "A'volume',_'SPL_WA'Z__6": 121099, "A'open',_'SPL_WA'Z__6": 207.57016859087776, "A'close',_'SPL_WA'Z__6": 196.6999053955078, "A'timestamp',_''Z__6": datetime.datetime(2020, 3, 9, 0, 0), "A'symbol',_''Z__6": 'SPL', "A'low',_'SPL_WA'Z__6": 192.21376983508603, "A'high',_'SPL_WA'Z__7": 200.49585841701565 ... 6900 parameters truncated ... "A'low',_'SPL_WA'Z__992": 444.16087352903594, "A'high',_'SPL_WA'Z__993": 465.5783966615432, "A'volume',_'SPL_WA'Z__993": 61453, "A'open',_'SPL_WA'Z__993": 458.13281353296765, "A'close',_'SPL_WA'Z__993": 452.4337463378906, "A'timestamp',_''Z__993": datetime.datetime(2024, 2, 5, 0, 0), "A'symbol',_''Z__993": 'SPL', "A'low',_'SPL_WA'Z__993": 448.7569179338508, "A'high',_'SPL_WA'Z__994": 457.76514817573934, "A'volume',_'SPL_WA'Z__994": 65473, "A'open',_'SPL_WA'Z__994": 457.76514817573934, "A'close',_'SPL_WA'Z__994": 441.58709716796875, "A'timestamp',_''Z__994": datetime.datetime(2024, 2, 6, 0, 0), "A'symbol',_''Z__994": 'SPL', "A'low',_'SPL_WA'Z__994": 440.48406544933283, "A'high',_'SPL_WA'Z__995": 455.00752207744534, "A'volume',_'SPL_WA'Z__995": 58510, "A'open',_'SPL_WA'Z__995": 441.77094522740555, "A'close',_'SPL_WA'Z__995": 454.82366943359375, "A'timestamp',_''Z__995": datetime.datetime(2024, 2, 7, 0, 0), "A'symbol',_''Z__995": 'SPL', "A'low',_'SPL_WA'Z__995": 441.77094522740555, "A'high',_'SPL_WA'Z__996": 455.19136075799855, "A'volume',_'SPL_WA'Z__996": 45744, "A'open',_'SPL_WA'Z__996": 455.0075081197868, "A'close',_'SPL_WA'Z__996": 437.1748962402344, "A'timestamp',_''Z__996": datetime.datetime(2024, 2, 8, 0, 0), "A'symbol',_''Z__996": 'SPL', "A'low',_'SPL_WA'Z__996": 434.7849522033518, "A'high',_'SPL_WA'Z__997": 445.26392048046273, "A'volume',_'SPL_WA'Z__997": 24750, "A'open',_'SPL_WA'Z__997": 442.873976373296, "A'close',_'SPL_WA'Z__997": 438.0941162109375, "A'timestamp',_''Z__997": datetime.datetime(2024, 2, 9, 0, 0), "A'symbol',_''Z__997": 'SPL', "A'low',_'SPL_WA'Z__997": 435.70417210377076, "A'high',_'SPL_WA'Z__998": 449.676110608676, "A'volume',_'SPL_WA'Z__998": 29617, "A'open',_'SPL_WA'Z__998": 433.86573775773195, "A'close',_'SPL_WA'Z__998": 445.8154296875, "A'timestamp',_''Z__998": datetime.datetime(2024, 2, 12, 0, 0), "A'symbol',_''Z__998": 'SPL', "A'low',_'SPL_WA'Z__998": 433.1303833213049, "A'high',_'SPL_WA'Z__999": 447.6538514229013, "A'volume',_'SPL_WA'Z__999": 22458, "A'open',_'SPL_WA'Z__999": 439.56484027711696, "A'close',_'SPL_WA'Z__999": 437.1748962402344, "A'timestamp',_''Z__999": datetime.datetime(2024, 2, 13, 0, 0), "A'symbol',_''Z__999": 'SPL', "A'low',_'SPL_WA'Z__999": 434.41727497890236}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-02-26 22:43:01,008 - historical_importer - INFO - Imported 0 records for SPL
2025-02-26 22:43:02,017 - historical_importer - INFO - Fetching 5 years of data for KGH.WA
2025-02-26 22:43:02,384 - historical_importer - ERROR - Error saving historical data: (psycopg2.errors.UndefinedColumn) column "('open', 'KGH.WA')" of relation "staging_stock_prices" does not exist
LINE 1: ...ck_prices ("('symbol', '')", "('timestamp', '')", "('open', ...
                                                             ^

[SQL: INSERT INTO staging_stock_prices ("('symbol', '')", "('timestamp', '')", "('open', 'KGH.WA')", "('high', 'KGH.WA')", "('low', 'KGH.WA')", "('close', 'KGH.WA')", "('volume', 'KGH.WA')") VALUES (%(A'symbol',_''Z__0)s, %(A'timestamp',_''Z__0)s, %(A'open ... 201070 characters truncated ... A'Z__999)s, %(A'low',_'KGH_WA'Z__999)s, %(A'close',_'KGH_WA'Z__999)s, %(A'volume',_'KGH_WA'Z__999)s)]
[parameters: {"A'close',_'KGH_WA'Z__0": 66.01476287841797, "A'high',_'KGH_WA'Z__0": 70.18864689001592, "A'volume',_'KGH_WA'Z__0": 1779132, "A'timestamp',_''Z__0": datetime.datetime(2020, 2, 28, 0, 0), "A'open',_'KGH_WA'Z__0": 69.06563139575901, "A'symbol',_''Z__0": 'KGH', "A'low',_'KGH_WA'Z__0": 65.50940376401485, "A'close',_'KGH_WA'Z__1": 68.31694030761719, "A'high',_'KGH_WA'Z__1": 70.67527537939478, "A'volume',_'KGH_WA'Z__1": 1182780, "A'timestamp',_''Z__1": datetime.datetime(2020, 3, 2, 0, 0), "A'open',_'KGH_WA'Z__1": 69.2527888049818, "A'symbol',_''Z__1": 'KGH', "A'low',_'KGH_WA'Z__1": 66.1644859076956, "A'close',_'KGH_WA'Z__2": 72.82772827148438, "A'high',_'KGH_WA'Z__2": 73.91331593313078, "A'volume',_'KGH_WA'Z__2": 1200095, "A'timestamp',_''Z__2": datetime.datetime(2020, 3, 3, 0, 0), "A'open',_'KGH_WA'Z__2": 70.18863584915445, "A'symbol',_''Z__2": 'KGH', "A'low',_'KGH_WA'Z__2": 69.60840722241683, "A'close',_'KGH_WA'Z__3": 70.7501449584961, "A'high',_'KGH_WA'Z__3": 73.74486443343298, "A'volume',_'KGH_WA'Z__3": 584674, "A'timestamp',_''Z__3": datetime.datetime(2020, 3, 4, 0, 0), "A'open',_'KGH_WA'Z__3": 72.30365689098741, "A'symbol',_''Z__3": 'KGH', "A'low',_'KGH_WA'Z__3": 70.7501449584961, "A'close',_'KGH_WA'Z__4": 68.42925262451172, "A'high',_'KGH_WA'Z__4": 72.37852774330915, "A'volume',_'KGH_WA'Z__4": 619956, "A'timestamp',_''Z__4": datetime.datetime(2020, 3, 5, 0, 0), "A'open',_'KGH_WA'Z__4": 72.19136087813783, "A'symbol',_''Z__4": 'KGH', "A'low',_'KGH_WA'Z__4": 68.33566205196782, "A'close',_'KGH_WA'Z__5": 65.47196197509766, "A'high',_'KGH_WA'Z__5": 67.2126408034029, "A'volume',_'KGH_WA'Z__5": 950443, "A'timestamp',_''Z__5": datetime.datetime(2020, 3, 6, 0, 0), "A'open',_'KGH_WA'Z__5": 67.11905737886171, "A'symbol',_''Z__5": 'KGH', "A'low',_'KGH_WA'Z__5": 64.62969687431163, "A'close',_'KGH_WA'Z__6": 58.20977783203125, "A'high',_'KGH_WA'Z__6": 61.485244035575406, "A'volume',_'KGH_WA'Z__6": 1347285, "A'timestamp',_''Z__6": datetime.datetime(2020, 3, 9, 0, 0), "A'open',_'KGH_WA'Z__6": 58.9397385248803, "A'symbol',_''Z__6": 'KGH', "A'low',_'KGH_WA'Z__6": 57.03060671437491, "A'close',_'KGH_WA'Z__7": 58.20977783203125 ... 6900 parameters truncated ... "A'low',_'KGH_WA'Z__992": 108.58842508095361, "A'close',_'KGH_WA'Z__993": 107.0693588256836, "A'high',_'KGH_WA'Z__993": 109.81347353013821, "A'volume',_'KGH_WA'Z__993": 607400, "A'timestamp',_''Z__993": datetime.datetime(2024, 2, 5, 0, 0), "A'open',_'KGH_WA'Z__993": 109.76446854440789, "A'symbol',_''Z__993": 'KGH', "A'low',_'KGH_WA'Z__993": 107.02035383995329, "A'close',_'KGH_WA'Z__994": 108.98043060302734, "A'high',_'KGH_WA'Z__994": 109.61745801424102, "A'volume',_'KGH_WA'Z__994": 305863, "A'timestamp',_''Z__994": datetime.datetime(2024, 2, 6, 0, 0), "A'open',_'KGH_WA'Z__994": 108.04939571694561, "A'symbol',_''Z__994": 'KGH', "A'low',_'KGH_WA'Z__994": 107.06935584649713, "A'close',_'KGH_WA'Z__995": 108.63742065429688, "A'high',_'KGH_WA'Z__995": 109.71546304128054, "A'volume',_'KGH_WA'Z__995": 300607, "A'timestamp',_''Z__995": datetime.datetime(2024, 2, 7, 0, 0), "A'open',_'KGH_WA'Z__995": 109.27444808023164, "A'symbol',_''Z__995": 'KGH', "A'low',_'KGH_WA'Z__995": 108.09840319936053, "A'close',_'KGH_WA'Z__996": 107.55937957763672, "A'high',_'KGH_WA'Z__996": 109.12744193027116, "A'volume',_'KGH_WA'Z__996": 408178, "A'timestamp',_''Z__996": datetime.datetime(2024, 2, 8, 0, 0), "A'open',_'KGH_WA'Z__996": 108.78442945893099, "A'symbol',_''Z__996": 'KGH', "A'low',_'KGH_WA'Z__996": 107.21636710629654, "A'close',_'KGH_WA'Z__997": 106.04031372070312, "A'high',_'KGH_WA'Z__997": 107.65738104398164, "A'volume',_'KGH_WA'Z__997": 439207, "A'timestamp',_''Z__997": datetime.datetime(2024, 2, 9, 0, 0), "A'open',_'KGH_WA'Z__997": 106.92235112222878, "A'symbol',_''Z__997": 'KGH', "A'low',_'KGH_WA'Z__997": 105.84430873241344, "A'close',_'KGH_WA'Z__998": 108.93143463134766, "A'high',_'KGH_WA'Z__998": 109.37244958842201, "A'volume',_'KGH_WA'Z__998": 356015, "A'timestamp',_''Z__998": datetime.datetime(2024, 2, 12, 0, 0), "A'open',_'KGH_WA'Z__998": 106.82434738475823, "A'symbol',_''Z__998": 'KGH', "A'low',_'KGH_WA'Z__998": 106.38333242768387, "A'close',_'KGH_WA'Z__999": 107.11836242675781, "A'high',_'KGH_WA'Z__999": 109.61745964736754, "A'volume',_'KGH_WA'Z__999": 598979, "A'timestamp',_''Z__999": datetime.datetime(2024, 2, 13, 0, 0), "A'open',_'KGH_WA'Z__999": 109.56846213938164, "A'symbol',_''Z__999": 'KGH', "A'low',_'KGH_WA'Z__999": 107.02035245656411}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-02-26 22:43:02,384 - historical_importer - INFO - Imported 0 records for KGH
2025-02-26 22:43:03,388 - historical_importer - INFO - Fetching 5 years of data for LPP.WA
2025-02-26 22:43:03,760 - historical_importer - ERROR - Error saving historical data: (psycopg2.errors.UndefinedColumn) column "('open', 'LPP.WA')" of relation "staging_stock_prices" does not exist
LINE 1: ...ck_prices ("('symbol', '')", "('timestamp', '')", "('open', ...
                                                             ^

[SQL: INSERT INTO staging_stock_prices ("('symbol', '')", "('timestamp', '')", "('open', 'LPP.WA')", "('high', 'LPP.WA')", "('low', 'LPP.WA')", "('close', 'LPP.WA')", "('volume', 'LPP.WA')") VALUES (%(A'symbol',_''Z__0)s, %(A'timestamp',_''Z__0)s, %(A'open ... 201070 characters truncated ... A'Z__999)s, %(A'low',_'LPP_WA'Z__999)s, %(A'close',_'LPP_WA'Z__999)s, %(A'volume',_'LPP_WA'Z__999)s)]
[parameters: {"A'open',_'LPP_WA'Z__0": 5900.471042798913, "A'low',_'LPP_WA'Z__0": 5813.699409816576, "A'volume',_'LPP_WA'Z__0": 6505, "A'high',_'LPP_WA'Z__0": 6082.691472061821, "A'timestamp',_''Z__0": datetime.datetime(2020, 2, 28, 0, 0), "A'close',_'LPP_WA'Z__0": 5987.24267578125, "A'symbol',_''Z__0": 'LPP', "A'open',_'LPP_WA'Z__1": 6108.722378447024, "A'low',_'LPP_WA'Z__1": 5891.7933167124, "A'volume',_'LPP_WA'Z__1": 4047, "A'high',_'LPP_WA'Z__1": 6139.092447089872, "A'timestamp',_''Z__1": datetime.datetime(2020, 3, 2, 0, 0), "A'close',_'LPP_WA'Z__1": 5978.56494140625, "A'symbol',_''Z__1": 'LPP', "A'open',_'LPP_WA'Z__2": 5987.242204725661, "A'low',_'LPP_WA'Z__2": 5987.242204725661, "A'volume',_'LPP_WA'Z__2": 4153, "A'high',_'LPP_WA'Z__2": 6555.596356043822, "A'timestamp',_''Z__2": datetime.datetime(2020, 3, 3, 0, 0), "A'close',_'LPP_WA'Z__2": 6395.06884765625, "A'symbol',_''Z__2": 'LPP', "A'open',_'LPP_WA'Z__3": 6316.974071557971, "A'low',_'LPP_WA'Z__3": 6169.462314392469, "A'volume',_'LPP_WA'Z__3": 2643, "A'high',_'LPP_WA'Z__3": 6364.6984635821045, "A'timestamp',_''Z__3": datetime.datetime(2020, 3, 4, 0, 0), "A'close',_'LPP_WA'Z__3": 6286.60400390625, "A'symbol',_''Z__3": 'LPP', "A'open',_'LPP_WA'Z__4": 6264.911187752726, "A'low',_'LPP_WA'Z__4": 6160.785240033843, "A'volume',_'LPP_WA'Z__4": 3178, "A'high',_'LPP_WA'Z__4": 6334.32848623198, "A'timestamp',_''Z__4": datetime.datetime(2020, 3, 5, 0, 0), "A'close',_'LPP_WA'Z__4": 6169.46240234375, "A'symbol',_''Z__4": 'LPP', "A'open',_'LPP_WA'Z__5": 6160.785722641984, "A'low',_'LPP_WA'Z__5": 5852.746436509884, "A'volume',_'LPP_WA'Z__5": 4827, "A'high',_'LPP_WA'Z__5": 6169.46288563162, "A'timestamp',_''Z__5": datetime.datetime(2020, 3, 6, 0, 0), "A'close',_'LPP_WA'Z__5": 5939.51806640625, "A'symbol',_''Z__5": 'LPP', "A'open',_'LPP_WA'Z__6": 5527.3525847404235, "A'low',_'LPP_WA'Z__6": 5254.0219624180945, "A'volume',_'LPP_WA'Z__6": 5345, "A'high',_'LPP_WA'Z__6": 5687.880093088457, "A'timestamp',_''Z__6": datetime.datetime(2020, 3, 9, 0, 0), "A'close',_'LPP_WA'Z__6": 5379.8408203125, "A'symbol',_''Z__6": 'LPP', "A'open',_'LPP_WA'Z__7": 5340.794087439403 ... 6900 parameters truncated ... "A'symbol',_''Z__992": 'LPP', "A'open',_'LPP_WA'Z__993": 15389.378280345078, "A'low',_'LPP_WA'Z__993": 14793.41235068774, "A'volume',_'LPP_WA'Z__993": 5257, "A'high',_'LPP_WA'Z__993": 15495.114171090734, "A'timestamp',_''Z__993": datetime.datetime(2024, 2, 5, 0, 0), "A'close',_'LPP_WA'Z__993": 14937.59765625, "A'symbol',_''Z__993": 'LPP', "A'open',_'LPP_WA'Z__994": 14899.149101760786, "A'low',_'LPP_WA'Z__994": 14658.840245280773, "A'volume',_'LPP_WA'Z__994": 6434, "A'high',_'LPP_WA'Z__994": 15312.480334906408, "A'timestamp',_''Z__994": datetime.datetime(2024, 2, 6, 0, 0), "A'close',_'LPP_WA'Z__994": 15149.0703125, "A'symbol',_''Z__994": 'LPP', "A'open',_'LPP_WA'Z__995": 15235.581132908774, "A'low',_'LPP_WA'Z__995": 15187.519362773413, "A'volume',_'LPP_WA'Z__995": 10858, "A'high',_'LPP_WA'Z__995": 15745.035896343577, "A'timestamp',_''Z__995": datetime.datetime(2024, 2, 7, 0, 0), "A'close',_'LPP_WA'Z__995": 15600.8505859375, "A'symbol',_''Z__995": 'LPP', "A'open',_'LPP_WA'Z__996": 15668.136675104748, "A'low',_'LPP_WA'Z__996": 15322.091938722067, "A'volume',_'LPP_WA'Z__996": 10542, "A'high',_'LPP_WA'Z__996": 15831.546689507682, "A'timestamp',_''Z__996": datetime.datetime(2024, 2, 8, 0, 0), "A'close',_'LPP_WA'Z__996": 15485.501953125, "A'symbol',_''Z__996": 'LPP', "A'open',_'LPP_WA'Z__997": 15562.401030924075, "A'low',_'LPP_WA'Z__997": 15293.255120568378, "A'volume',_'LPP_WA'Z__997": 1941, "A'high',_'LPP_WA'Z__997": 15687.361632160648, "A'timestamp',_''Z__997": datetime.datetime(2024, 2, 9, 0, 0), "A'close',_'LPP_WA'Z__997": 15437.4404296875, "A'symbol',_''Z__997": 'LPP', "A'open',_'LPP_WA'Z__998": 15523.95116888857, "A'low',_'LPP_WA'Z__998": 15331.704095589641, "A'volume',_'LPP_WA'Z__998": 2151, "A'high',_'LPP_WA'Z__998": 15831.546486166859, "A'timestamp',_''Z__998": datetime.datetime(2024, 2, 12, 0, 0), "A'close',_'LPP_WA'Z__998": 15716.1982421875, "A'symbol',_''Z__998": 'LPP', "A'open',_'LPP_WA'Z__999": 15716.19899597168, "A'low',_'LPP_WA'Z__999": 15120.233040161133, "A'volume',_'LPP_WA'Z__999": 7321, "A'high',_'LPP_WA'Z__999": 15725.811350097656, "A'timestamp',_''Z__999": datetime.datetime(2024, 2, 13, 0, 0), "A'close',_'LPP_WA'Z__999": 15379.7666015625, "A'symbol',_''Z__999": 'LPP'}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-02-26 22:43:03,761 - historical_importer - INFO - Imported 0 records for LPP
2025-02-26 22:43:04,765 - historical_importer - INFO - Fetching 5 years of data for ALE.WA
2025-02-26 22:43:05,011 - historical_importer - ERROR - Error saving historical data: (psycopg2.errors.UndefinedColumn) column "('open', 'ALE.WA')" of relation "staging_stock_prices" does not exist
LINE 1: ...ck_prices ("('symbol', '')", "('timestamp', '')", "('open', ...
                                                             ^

[SQL: INSERT INTO staging_stock_prices ("('symbol', '')", "('timestamp', '')", "('open', 'ALE.WA')", "('high', 'ALE.WA')", "('low', 'ALE.WA')", "('close', 'ALE.WA')", "('volume', 'ALE.WA')") VALUES (%(A'symbol',_''Z__0)s, %(A'timestamp',_''Z__0)s, %(A'open ... 201070 characters truncated ... A'Z__999)s, %(A'low',_'ALE_WA'Z__999)s, %(A'close',_'ALE_WA'Z__999)s, %(A'volume',_'ALE_WA'Z__999)s)]
[parameters: {"A'open',_'ALE_WA'Z__0": 72.0, "A'high',_'ALE_WA'Z__0": 80.0, "A'close',_'ALE_WA'Z__0": 80.0, "A'volume',_'ALE_WA'Z__0": 18452974, "A'timestamp',_''Z__0": datetime.datetime(2020, 10, 13, 0, 0), "A'symbol',_''Z__0": 'ALE', "A'low',_'ALE_WA'Z__0": 71.08000183105469, "A'open',_'ALE_WA'Z__1": 84.0, "A'high',_'ALE_WA'Z__1": 90.30000305175781, "A'close',_'ALE_WA'Z__1": 75.95999908447266, "A'volume',_'ALE_WA'Z__1": 16731591, "A'timestamp',_''Z__1": datetime.datetime(2020, 10, 14, 0, 0), "A'symbol',_''Z__1": 'ALE', "A'low',_'ALE_WA'Z__1": 71.25, "A'open',_'ALE_WA'Z__2": 76.0, "A'high',_'ALE_WA'Z__2": 80.0, "A'close',_'ALE_WA'Z__2": 79.22000122070312, "A'volume',_'ALE_WA'Z__2": 6235974, "A'timestamp',_''Z__2": datetime.datetime(2020, 10, 15, 0, 0), "A'symbol',_''Z__2": 'ALE', "A'low',_'ALE_WA'Z__2": 71.5199966430664, "A'open',_'ALE_WA'Z__3": 80.0, "A'high',_'ALE_WA'Z__3": 85.44000244140625, "A'close',_'ALE_WA'Z__3": 81.44999694824219, "A'volume',_'ALE_WA'Z__3": 15480831, "A'timestamp',_''Z__3": datetime.datetime(2020, 10, 16, 0, 0), "A'symbol',_''Z__3": 'ALE', "A'low',_'ALE_WA'Z__3": 79.25, "A'open',_'ALE_WA'Z__4": 81.44999694824219, "A'high',_'ALE_WA'Z__4": 83.62000274658203, "A'close',_'ALE_WA'Z__4": 83.4000015258789, "A'volume',_'ALE_WA'Z__4": 3205087, "A'timestamp',_''Z__4": datetime.datetime(2020, 10, 19, 0, 0), "A'symbol',_''Z__4": 'ALE', "A'low',_'ALE_WA'Z__4": 79.80000305175781, "A'open',_'ALE_WA'Z__5": 83.44999694824219, "A'high',_'ALE_WA'Z__5": 85.5999984741211, "A'close',_'ALE_WA'Z__5": 85.0, "A'volume',_'ALE_WA'Z__5": 3048042, "A'timestamp',_''Z__5": datetime.datetime(2020, 10, 20, 0, 0), "A'symbol',_''Z__5": 'ALE', "A'low',_'ALE_WA'Z__5": 83.33000183105469, "A'open',_'ALE_WA'Z__6": 85.98999786376953, "A'high',_'ALE_WA'Z__6": 85.98999786376953, "A'close',_'ALE_WA'Z__6": 84.16999816894531, "A'volume',_'ALE_WA'Z__6": 2734889, "A'timestamp',_''Z__6": datetime.datetime(2020, 10, 21, 0, 0), "A'symbol',_''Z__6": 'ALE', "A'low',_'ALE_WA'Z__6": 82.12000274658203, "A'open',_'ALE_WA'Z__7": 83.83999633789062 ... 6900 parameters truncated ... "A'low',_'ALE_WA'Z__992": 36.0099983215332, "A'open',_'ALE_WA'Z__993": 36.279998779296875, "A'high',_'ALE_WA'Z__993": 36.880001068115234, "A'close',_'ALE_WA'Z__993": 36.10499954223633, "A'volume',_'ALE_WA'Z__993": 4032561, "A'timestamp',_''Z__993": datetime.datetime(2024, 9, 26, 0, 0), "A'symbol',_''Z__993": 'ALE', "A'low',_'ALE_WA'Z__993": 35.94499969482422, "A'open',_'ALE_WA'Z__994": 36.10499954223633, "A'high',_'ALE_WA'Z__994": 36.45500183105469, "A'close',_'ALE_WA'Z__994": 36.06999969482422, "A'volume',_'ALE_WA'Z__994": 3079810, "A'timestamp',_''Z__994": datetime.datetime(2024, 9, 27, 0, 0), "A'symbol',_''Z__994": 'ALE', "A'low',_'ALE_WA'Z__994": 35.91999816894531, "A'open',_'ALE_WA'Z__995": 35.915000915527344, "A'high',_'ALE_WA'Z__995": 36.0, "A'close',_'ALE_WA'Z__995": 34.810001373291016, "A'volume',_'ALE_WA'Z__995": 4852435, "A'timestamp',_''Z__995": datetime.datetime(2024, 9, 30, 0, 0), "A'symbol',_''Z__995": 'ALE', "A'low',_'ALE_WA'Z__995": 34.47999954223633, "A'open',_'ALE_WA'Z__996": 34.91999816894531, "A'high',_'ALE_WA'Z__996": 35.54999923706055, "A'close',_'ALE_WA'Z__996": 34.70500183105469, "A'volume',_'ALE_WA'Z__996": 3184525, "A'timestamp',_''Z__996": datetime.datetime(2024, 10, 1, 0, 0), "A'symbol',_''Z__996": 'ALE', "A'low',_'ALE_WA'Z__996": 34.650001525878906, "A'open',_'ALE_WA'Z__997": 34.9900016784668, "A'high',_'ALE_WA'Z__997": 35.154998779296875, "A'close',_'ALE_WA'Z__997": 34.71500015258789, "A'volume',_'ALE_WA'Z__997": 1550632, "A'timestamp',_''Z__997": datetime.datetime(2024, 10, 2, 0, 0), "A'symbol',_''Z__997": 'ALE', "A'low',_'ALE_WA'Z__997": 34.439998626708984, "A'open',_'ALE_WA'Z__998": 34.43000030517578, "A'high',_'ALE_WA'Z__998": 34.709999084472656, "A'close',_'ALE_WA'Z__998": 34.45500183105469, "A'volume',_'ALE_WA'Z__998": 1994119, "A'timestamp',_''Z__998": datetime.datetime(2024, 10, 3, 0, 0), "A'symbol',_''Z__998": 'ALE', "A'low',_'ALE_WA'Z__998": 33.880001068115234, "A'open',_'ALE_WA'Z__999": 34.45500183105469, "A'high',_'ALE_WA'Z__999": 34.58000183105469, "A'close',_'ALE_WA'Z__999": 34.099998474121094, "A'volume',_'ALE_WA'Z__999": 1732103, "A'timestamp',_''Z__999": datetime.datetime(2024, 10, 4, 0, 0), "A'symbol',_''Z__999": 'ALE', "A'low',_'ALE_WA'Z__999": 34.08000183105469}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-02-26 22:43:05,012 - historical_importer - INFO - Imported 0 records for ALE
2025-02-26 22:43:06,017 - historical_importer - INFO - Fetching 5 years of data for CPS.WA
2025-02-26 22:43:06,307 - historical_importer - ERROR - Error saving historical data: (psycopg2.errors.UndefinedColumn) column "('open', 'CPS.WA')" of relation "staging_stock_prices" does not exist
LINE 1: ...ck_prices ("('symbol', '')", "('timestamp', '')", "('open', ...
                                                             ^

[SQL: INSERT INTO staging_stock_prices ("('symbol', '')", "('timestamp', '')", "('open', 'CPS.WA')", "('high', 'CPS.WA')", "('low', 'CPS.WA')", "('close', 'CPS.WA')", "('volume', 'CPS.WA')") VALUES (%(A'symbol',_''Z__0)s, %(A'timestamp',_''Z__0)s, %(A'open ... 201070 characters truncated ... A'Z__999)s, %(A'low',_'CPS_WA'Z__999)s, %(A'close',_'CPS_WA'Z__999)s, %(A'volume',_'CPS_WA'Z__999)s)]
[parameters: {"A'volume',_'CPS_WA'Z__0": 1302422, "A'open',_'CPS_WA'Z__0": 22.4611460095378, "A'close',_'CPS_WA'Z__0": 21.93879508972168, "A'high',_'CPS_WA'Z__0": 22.931263829988, "A'timestamp',_''Z__0": datetime.datetime(2020, 2, 28, 0, 0), "A'symbol',_''Z__0": 'CPS', "A'low',_'CPS_WA'Z__0": 21.72985272917954, "A'volume',_'CPS_WA'Z__1": 778331, "A'open',_'CPS_WA'Z__1": 21.86914798921284, "A'close',_'CPS_WA'Z__1": 21.956205368041992, "A'high',_'CPS_WA'Z__1": 22.37408842478199, "A'timestamp',_''Z__1": datetime.datetime(2020, 3, 2, 0, 0), "A'symbol',_''Z__1": 'CPS', "A'low',_'CPS_WA'Z__1": 21.799501089841687, "A'volume',_'CPS_WA'Z__2": 750446, "A'open',_'CPS_WA'Z__2": 21.95620476115267, "A'close',_'CPS_WA'Z__2": 22.84420394897461, "A'high',_'CPS_WA'Z__2": 22.879028227954144, "A'timestamp',_''Z__2": datetime.datetime(2020, 3, 3, 0, 0), "A'symbol',_''Z__2": 'CPS', "A'low',_'CPS_WA'Z__2": 21.95620476115267, "A'volume',_'CPS_WA'Z__3": 396941, "A'open',_'CPS_WA'Z__3": 22.63526320979023, "A'close',_'CPS_WA'Z__3": 23.10538101196289, "A'high',_'CPS_WA'Z__3": 23.244674806566714, "A'timestamp',_''Z__3": datetime.datetime(2020, 3, 4, 0, 0), "A'symbol',_''Z__3": 'CPS', "A'low',_'CPS_WA'Z__3": 22.54820417303459, "A'volume',_'CPS_WA'Z__4": 672328, "A'open',_'CPS_WA'Z__4": 23.34914272344449, "A'close',_'CPS_WA'Z__4": 22.40890884399414, "A'high',_'CPS_WA'Z__4": 23.366554861705936, "A'timestamp',_''Z__4": datetime.datetime(2020, 3, 5, 0, 0), "A'symbol',_''Z__4": 'CPS', "A'low',_'CPS_WA'Z__4": 21.95620321227396, "A'volume',_'CPS_WA'Z__5": 621666, "A'open',_'CPS_WA'Z__5": 22.095498895045925, "A'close',_'CPS_WA'Z__5": 22.32185173034668, "A'high',_'CPS_WA'Z__5": 22.56561670540435, "A'timestamp',_''Z__5": datetime.datetime(2020, 3, 6, 0, 0), "A'symbol',_''Z__5": 'CPS', "A'low',_'CPS_WA'Z__5": 21.66020536420133, "A'volume',_'CPS_WA'Z__6": 639131, "A'open',_'CPS_WA'Z__6": 21.764677669213516, "A'close',_'CPS_WA'Z__6": 20.85926628112793, "A'high',_'CPS_WA'Z__6": 21.764677669213516, "A'timestamp',_''Z__6": datetime.datetime(2020, 3, 9, 0, 0), "A'symbol',_''Z__6": 'CPS', "A'low',_'CPS_WA'Z__6": 20.632915094619662, "A'volume',_'CPS_WA'Z__7": 1198408 ... 6900 parameters truncated ... "A'low',_'CPS_WA'Z__992": 10.84000015258789, "A'volume',_'CPS_WA'Z__993": 1985503, "A'open',_'CPS_WA'Z__993": 11.020000457763672, "A'close',_'CPS_WA'Z__993": 11.130000114440918, "A'high',_'CPS_WA'Z__993": 11.350000381469727, "A'timestamp',_''Z__993": datetime.datetime(2024, 2, 5, 0, 0), "A'symbol',_''Z__993": 'CPS', "A'low',_'CPS_WA'Z__993": 11.005000114440918, "A'volume',_'CPS_WA'Z__994": 1092866, "A'open',_'CPS_WA'Z__994": 11.234999656677246, "A'close',_'CPS_WA'Z__994": 11.039999961853027, "A'high',_'CPS_WA'Z__994": 11.239999771118164, "A'timestamp',_''Z__994": datetime.datetime(2024, 2, 6, 0, 0), "A'symbol',_''Z__994": 'CPS', "A'low',_'CPS_WA'Z__994": 10.920000076293945, "A'volume',_'CPS_WA'Z__995": 1051342, "A'open',_'CPS_WA'Z__995": 11.039999961853027, "A'close',_'CPS_WA'Z__995": 10.880000114440918, "A'high',_'CPS_WA'Z__995": 11.199999809265137, "A'timestamp',_''Z__995": datetime.datetime(2024, 2, 7, 0, 0), "A'symbol',_''Z__995": 'CPS', "A'low',_'CPS_WA'Z__995": 10.869999885559082, "A'volume',_'CPS_WA'Z__996": 609191, "A'open',_'CPS_WA'Z__996": 10.975000381469727, "A'close',_'CPS_WA'Z__996": 10.954999923706055, "A'high',_'CPS_WA'Z__996": 11.079999923706055, "A'timestamp',_''Z__996": datetime.datetime(2024, 2, 8, 0, 0), "A'symbol',_''Z__996": 'CPS', "A'low',_'CPS_WA'Z__996": 10.890000343322754, "A'volume',_'CPS_WA'Z__997": 1183334, "A'open',_'CPS_WA'Z__997": 10.960000038146973, "A'close',_'CPS_WA'Z__997": 10.800000190734863, "A'high',_'CPS_WA'Z__997": 10.984999656677246, "A'timestamp',_''Z__997": datetime.datetime(2024, 2, 9, 0, 0), "A'symbol',_''Z__997": 'CPS', "A'low',_'CPS_WA'Z__997": 10.75, "A'volume',_'CPS_WA'Z__998": 2560036, "A'open',_'CPS_WA'Z__998": 10.854999542236328, "A'close',_'CPS_WA'Z__998": 11.630000114440918, "A'high',_'CPS_WA'Z__998": 11.65999984741211, "A'timestamp',_''Z__998": datetime.datetime(2024, 2, 12, 0, 0), "A'symbol',_''Z__998": 'CPS', "A'low',_'CPS_WA'Z__998": 10.850000381469727, "A'volume',_'CPS_WA'Z__999": 4126027, "A'open',_'CPS_WA'Z__999": 11.694999694824219, "A'close',_'CPS_WA'Z__999": 10.675000190734863, "A'high',_'CPS_WA'Z__999": 11.699999809265137, "A'timestamp',_''Z__999": datetime.datetime(2024, 2, 13, 0, 0), "A'symbol',_''Z__999": 'CPS', "A'low',_'CPS_WA'Z__999": 10.640000343322754}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-02-26 22:43:06,307 - historical_importer - INFO - Imported 0 records for CPS
2025-02-26 22:43:07,313 - historical_importer - INFO - Fetching 5 years of data for CDR.WA
2025-02-26 22:43:07,607 - historical_importer - ERROR - Error saving historical data: (psycopg2.errors.UndefinedColumn) column "('open', 'CDR.WA')" of relation "staging_stock_prices" does not exist
LINE 1: ...ck_prices ("('symbol', '')", "('timestamp', '')", "('open', ...
                                                             ^

[SQL: INSERT INTO staging_stock_prices ("('symbol', '')", "('timestamp', '')", "('open', 'CDR.WA')", "('high', 'CDR.WA')", "('low', 'CDR.WA')", "('close', 'CDR.WA')", "('volume', 'CDR.WA')") VALUES (%(A'symbol',_''Z__0)s, %(A'timestamp',_''Z__0)s, %(A'open ... 201070 characters truncated ... A'Z__999)s, %(A'low',_'CDR_WA'Z__999)s, %(A'close',_'CDR_WA'Z__999)s, %(A'volume',_'CDR_WA'Z__999)s)]
[parameters: {"A'volume',_'CDR_WA'Z__0": 1106623, "A'low',_'CDR_WA'Z__0": 247.92706717294263, "A'timestamp',_''Z__0": datetime.datetime(2020, 2, 28, 0, 0), "A'close',_'CDR_WA'Z__0": 263.9437561035156, "A'symbol',_''Z__0": 'CDR', "A'high',_'CDR_WA'Z__0": 271.0517567167162, "A'open',_'CDR_WA'Z__0": 261.5744225657821, "A'volume',_'CDR_WA'Z__1": 677207, "A'low',_'CDR_WA'Z__1": 257.783481641541, "A'timestamp',_''Z__1": datetime.datetime(2020, 3, 2, 0, 0), "A'close',_'CDR_WA'Z__1": 269.5353698730469, "A'symbol',_''Z__1": 'CDR', "A'high',_'CDR_WA'Z__1": 282.42454973962947, "A'open',_'CDR_WA'Z__1": 272.85243673240495, "A'volume',_'CDR_WA'Z__2": 745525, "A'low',_'CDR_WA'Z__2": 275.03224601667205, "A'timestamp',_''Z__2": datetime.datetime(2020, 3, 3, 0, 0), "A'close',_'CDR_WA'Z__2": 289.8168640136719, "A'symbol',_''Z__2": 'CDR', "A'high',_'CDR_WA'Z__2": 290.8593765448778, "A'open',_'CDR_WA'Z__2": 279.58135479689844, "A'volume',_'CDR_WA'Z__3": 412457, "A'low',_'CDR_WA'Z__3": 277.212044821195, "A'timestamp',_''Z__3": datetime.datetime(2020, 3, 4, 0, 0), "A'close',_'CDR_WA'Z__3": 280.1500244140625, "A'symbol',_''Z__3": 'CDR', "A'high',_'CDR_WA'Z__3": 288.4900675268502, "A'open',_'CDR_WA'Z__3": 284.60435444741455, "A'volume',_'CDR_WA'Z__4": 303548, "A'low',_'CDR_WA'Z__4": 278.8231833523116, "A'timestamp',_''Z__4": datetime.datetime(2020, 3, 5, 0, 0), "A'close',_'CDR_WA'Z__4": 282.04547119140625, "A'symbol',_''Z__4": 'CDR', "A'high',_'CDR_WA'Z__4": 289.5325594146778, "A'open',_'CDR_WA'Z__4": 287.16322586791284, "A'volume',_'CDR_WA'Z__5": 363928, "A'low',_'CDR_WA'Z__5": 268.2085650514625, "A'timestamp',_''Z__5": datetime.datetime(2020, 3, 6, 0, 0), "A'close',_'CDR_WA'Z__5": 277.8754577636719, "A'symbol',_''Z__5": 'CDR', "A'high',_'CDR_WA'Z__5": 279.4865872673538, "A'open',_'CDR_WA'Z__5": 279.2022788027421, "A'volume',_'CDR_WA'Z__6": 706198, "A'low',_'CDR_WA'Z__6": 245.93682980007594, "A'timestamp',_''Z__6": datetime.datetime(2020, 3, 9, 0, 0), "A'close',_'CDR_WA'Z__6": 255.88803100585938, "A'symbol',_''Z__6": 'CDR', "A'high',_'CDR_WA'Z__6": 269.15629928023725, "A'open',_'CDR_WA'Z__6": 252.09709721317998, "A'volume',_'CDR_WA'Z__7": 454369 ... 6900 parameters truncated ... "A'open',_'CDR_WA'Z__992": 104.28986993407864, "A'volume',_'CDR_WA'Z__993": 491632, "A'low',_'CDR_WA'Z__993": 103.69420560146328, "A'timestamp',_''Z__993": datetime.datetime(2024, 2, 5, 0, 0), "A'close',_'CDR_WA'Z__993": 108.1616439819336, "A'symbol',_''Z__993": 'CDR', "A'high',_'CDR_WA'Z__993": 108.90621704534531, "A'open',_'CDR_WA'Z__993": 103.69420560146328, "A'volume',_'CDR_WA'Z__994": 240257, "A'low',_'CDR_WA'Z__994": 106.32503153237624, "A'timestamp',_''Z__994": datetime.datetime(2024, 2, 6, 0, 0), "A'close',_'CDR_WA'Z__994": 107.56598663330078, "A'symbol',_''Z__994": 'CDR', "A'high',_'CDR_WA'Z__994": 108.6580256072766, "A'open',_'CDR_WA'Z__994": 108.6580256072766, "A'volume',_'CDR_WA'Z__995": 278601, "A'low',_'CDR_WA'Z__995": 106.57322696164046, "A'timestamp',_''Z__995": datetime.datetime(2024, 2, 7, 0, 0), "A'close',_'CDR_WA'Z__995": 107.516357421875, "A'symbol',_''Z__995": 'CDR', "A'high',_'CDR_WA'Z__995": 108.55875520526371, "A'open',_'CDR_WA'Z__995": 107.56599108345209, "A'volume',_'CDR_WA'Z__996": 493498, "A'low',_'CDR_WA'Z__996": 107.21852749911221, "A'timestamp',_''Z__996": datetime.datetime(2024, 2, 8, 0, 0), "A'close',_'CDR_WA'Z__996": 109.20405578613281, "A'symbol',_''Z__996": 'CDR', "A'high',_'CDR_WA'Z__996": 110.34573606600752, "A'open',_'CDR_WA'Z__996": 108.21129164262251, "A'volume',_'CDR_WA'Z__997": 212739, "A'low',_'CDR_WA'Z__997": 108.21128490396637, "A'timestamp',_''Z__997": datetime.datetime(2024, 2, 9, 0, 0), "A'close',_'CDR_WA'Z__997": 110.3953628540039, "A'symbol',_''Z__997": 'CDR', "A'high',_'CDR_WA'Z__997": 110.64355387442585, "A'open',_'CDR_WA'Z__997": 108.21128490396637, "A'volume',_'CDR_WA'Z__998": 304140, "A'low',_'CDR_WA'Z__998": 110.19681394864688, "A'timestamp',_''Z__998": datetime.datetime(2024, 2, 12, 0, 0), "A'close',_'CDR_WA'Z__998": 112.5298080444336, "A'symbol',_''Z__998": 'CDR', "A'high',_'CDR_WA'Z__998": 113.47293847409303, "A'open',_'CDR_WA'Z__998": 110.29608884277184, "A'volume',_'CDR_WA'Z__999": 320700, "A'low',_'CDR_WA'Z__999": 107.96309385202046, "A'timestamp',_''Z__999": datetime.datetime(2024, 2, 13, 0, 0), "A'close',_'CDR_WA'Z__999": 108.50911712646484, "A'symbol',_''Z__999": 'CDR', "A'high',_'CDR_WA'Z__999": 112.4801734520564, "A'open',_'CDR_WA'Z__999": 112.38089098456553}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-02-26 22:43:07,607 - historical_importer - INFO - Imported 0 records for CDR
2025-02-26 22:43:08,610 - historical_importer - INFO - Fetching 5 years of data for MBK.WA
2025-02-26 22:43:08,943 - historical_importer - ERROR - Error saving historical data: (psycopg2.errors.UndefinedColumn) column "('open', 'MBK.WA')" of relation "staging_stock_prices" does not exist
LINE 1: ...ck_prices ("('symbol', '')", "('timestamp', '')", "('open', ...
                                                             ^

[SQL: INSERT INTO staging_stock_prices ("('symbol', '')", "('timestamp', '')", "('open', 'MBK.WA')", "('high', 'MBK.WA')", "('low', 'MBK.WA')", "('close', 'MBK.WA')", "('volume', 'MBK.WA')") VALUES (%(A'symbol',_''Z__0)s, %(A'timestamp',_''Z__0)s, %(A'open ... 201070 characters truncated ... A'Z__999)s, %(A'low',_'MBK_WA'Z__999)s, %(A'close',_'MBK_WA'Z__999)s, %(A'volume',_'MBK_WA'Z__999)s)]
[parameters: {"A'open',_'MBK_WA'Z__0": 319.00027199559565, "A'timestamp',_''Z__0": datetime.datetime(2020, 2, 28, 0, 0), "A'close',_'MBK_WA'Z__0": 296.1435546875, "A'low',_'MBK_WA'Z__0": 296.1435546875, "A'symbol',_''Z__0": 'MBK', "A'high',_'MBK_WA'Z__0": 324.76412770752137, "A'volume',_'MBK_WA'Z__0": 42576, "A'open',_'MBK_WA'Z__1": 302.10617773281945, "A'timestamp',_''Z__1": datetime.datetime(2020, 3, 2, 0, 0), "A'close',_'MBK_WA'Z__1": 294.9510192871094, "A'low',_'MBK_WA'Z__1": 286.4046187842701, "A'symbol',_''Z__1": 'MBK', "A'high',_'MBK_WA'Z__1": 305.08748869728805, "A'volume',_'MBK_WA'Z__1": 40944, "A'open',_'MBK_WA'Z__2": 303.09994543966786, "A'timestamp',_''Z__2": datetime.datetime(2020, 3, 3, 0, 0), "A'close',_'MBK_WA'Z__2": 328.3417053222656, "A'low',_'MBK_WA'Z__2": 296.34231944281794, "A'symbol',_''Z__2": 'MBK', "A'high',_'MBK_WA'Z__2": 333.31055688685035, "A'volume',_'MBK_WA'Z__2": 25817, "A'open',_'MBK_WA'Z__3": 328.9379554185536, "A'timestamp',_''Z__3": datetime.datetime(2020, 3, 4, 0, 0), "A'close',_'MBK_WA'Z__3": 315.22393798828125, "A'low',_'MBK_WA'Z__3": 312.04386103149795, "A'symbol',_''Z__3": 'MBK', "A'high',_'MBK_WA'Z__3": 328.9379554185536, "A'volume',_'MBK_WA'Z__3": 29914, "A'open',_'MBK_WA'Z__4": 322.97536307724556, "A'timestamp',_''Z__4": datetime.datetime(2020, 3, 5, 0, 0), "A'close',_'MBK_WA'Z__4": 307.2738037109375, "A'low',_'MBK_WA'Z__4": 304.09372646657584, "A'symbol',_''Z__4": 'MBK', "A'high',_'MBK_WA'Z__4": 322.97536307724556, "A'volume',_'MBK_WA'Z__4": 13766, "A'open',_'MBK_WA'Z__5": 298.7273546905127, "A'timestamp',_''Z__5": datetime.datetime(2020, 3, 6, 0, 0), "A'close',_'MBK_WA'Z__5": 299.91986083984375, "A'low',_'MBK_WA'Z__5": 293.1622350112474, "A'symbol',_''Z__5": 'MBK', "A'high',_'MBK_WA'Z__5": 303.0999378929846, "A'volume',_'MBK_WA'Z__5": 21850, "A'open',_'MBK_WA'Z__6": 294.75227488413464, "A'timestamp',_''Z__6": datetime.datetime(2020, 3, 9, 0, 0), "A'close',_'MBK_WA'Z__6": 261.9578552246094, "A'low',_'MBK_WA'Z__6": 261.9578552246094, "A'symbol',_''Z__6": 'MBK', "A'high',_'MBK_WA'Z__6": 294.75227488413464, "A'volume',_'MBK_WA'Z__6": 28741, "A'open',_'MBK_WA'Z__7": 261.95785936294004 ... 6900 parameters truncated ... "A'volume',_'MBK_WA'Z__992": 24474, "A'open',_'MBK_WA'Z__993": 558.7999877929688, "A'timestamp',_''Z__993": datetime.datetime(2024, 2, 5, 0, 0), "A'close',_'MBK_WA'Z__993": 555.0, "A'low',_'MBK_WA'Z__993": 555.0, "A'symbol',_''Z__993": 'MBK', "A'high',_'MBK_WA'Z__993": 572.0, "A'volume',_'MBK_WA'Z__993": 34884, "A'open',_'MBK_WA'Z__994": 558.4000244140625, "A'timestamp',_''Z__994": datetime.datetime(2024, 2, 6, 0, 0), "A'close',_'MBK_WA'Z__994": 554.7999877929688, "A'low',_'MBK_WA'Z__994": 546.0, "A'symbol',_''Z__994": 'MBK', "A'high',_'MBK_WA'Z__994": 568.5999755859375, "A'volume',_'MBK_WA'Z__994": 24318, "A'open',_'MBK_WA'Z__995": 554.5999755859375, "A'timestamp',_''Z__995": datetime.datetime(2024, 2, 7, 0, 0), "A'close',_'MBK_WA'Z__995": 563.0, "A'low',_'MBK_WA'Z__995": 552.2000122070312, "A'symbol',_''Z__995": 'MBK', "A'high',_'MBK_WA'Z__995": 568.0, "A'volume',_'MBK_WA'Z__995": 28087, "A'open',_'MBK_WA'Z__996": 560.0, "A'timestamp',_''Z__996": datetime.datetime(2024, 2, 8, 0, 0), "A'close',_'MBK_WA'Z__996": 551.5999755859375, "A'low',_'MBK_WA'Z__996": 529.5999755859375, "A'symbol',_''Z__996": 'MBK', "A'high',_'MBK_WA'Z__996": 569.5999755859375, "A'volume',_'MBK_WA'Z__996": 60505, "A'open',_'MBK_WA'Z__997": 554.0, "A'timestamp',_''Z__997": datetime.datetime(2024, 2, 9, 0, 0), "A'close',_'MBK_WA'Z__997": 546.4000244140625, "A'low',_'MBK_WA'Z__997": 538.7999877929688, "A'symbol',_''Z__997": 'MBK', "A'high',_'MBK_WA'Z__997": 554.0, "A'volume',_'MBK_WA'Z__997": 20595, "A'open',_'MBK_WA'Z__998": 554.0, "A'timestamp',_''Z__998": datetime.datetime(2024, 2, 12, 0, 0), "A'close',_'MBK_WA'Z__998": 564.7999877929688, "A'low',_'MBK_WA'Z__998": 544.7999877929688, "A'symbol',_''Z__998": 'MBK', "A'high',_'MBK_WA'Z__998": 569.5999755859375, "A'volume',_'MBK_WA'Z__998": 25995, "A'open',_'MBK_WA'Z__999": 562.0, "A'timestamp',_''Z__999": datetime.datetime(2024, 2, 13, 0, 0), "A'close',_'MBK_WA'Z__999": 570.5999755859375, "A'low',_'MBK_WA'Z__999": 562.0, "A'symbol',_''Z__999": 'MBK', "A'high',_'MBK_WA'Z__999": 578.2000122070312, "A'volume',_'MBK_WA'Z__999": 39929}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-02-26 22:43:08,944 - historical_importer - INFO - Imported 0 records for MBK
2025-02-26 22:43:09,949 - historical_importer - INFO - Fetching 5 years of data for OPL.WA
2025-02-26 22:43:10,265 - historical_importer - ERROR - Error saving historical data: (psycopg2.errors.UndefinedColumn) column "('open', 'OPL.WA')" of relation "staging_stock_prices" does not exist
LINE 1: ...ck_prices ("('symbol', '')", "('timestamp', '')", "('open', ...
                                                             ^

[SQL: INSERT INTO staging_stock_prices ("('symbol', '')", "('timestamp', '')", "('open', 'OPL.WA')", "('high', 'OPL.WA')", "('low', 'OPL.WA')", "('close', 'OPL.WA')", "('volume', 'OPL.WA')") VALUES (%(A'symbol',_''Z__0)s, %(A'timestamp',_''Z__0)s, %(A'open ... 201070 characters truncated ... A'Z__999)s, %(A'low',_'OPL_WA'Z__999)s, %(A'close',_'OPL_WA'Z__999)s, %(A'volume',_'OPL_WA'Z__999)s)]
[parameters: {"A'close',_'OPL_WA'Z__0": 5.292688369750977, "A'low',_'OPL_WA'Z__0": 5.258375998556135, "A'high',_'OPL_WA'Z__0": 5.597210970881995, "A'timestamp',_''Z__0": datetime.datetime(2020, 2, 28, 0, 0), "A'open',_'OPL_WA'Z__0": 5.541453265431445, "A'symbol',_''Z__0": 'OPL', "A'volume',_'OPL_WA'Z__0": 5059188, "A'close',_'OPL_WA'Z__1": 5.489984512329102, "A'low',_'OPL_WA'Z__1": 5.241219625543932, "A'high',_'OPL_WA'Z__1": 5.532874770271126, "A'timestamp',_''Z__1": datetime.datetime(2020, 3, 2, 0, 0), "A'open',_'OPL_WA'Z__1": 5.4556721423611965, "A'symbol',_''Z__1": 'OPL', "A'volume',_'OPL_WA'Z__1": 3360145, "A'close',_'OPL_WA'Z__2": 5.640101432800293, "A'low',_'OPL_WA'Z__2": 5.49856279428233, "A'high',_'OPL_WA'Z__2": 5.918889970059723, "A'timestamp',_''Z__2": datetime.datetime(2020, 3, 3, 0, 0), "A'open',_'OPL_WA'Z__2": 5.918889970059723, "A'symbol',_''Z__2": 'OPL', "A'volume',_'OPL_WA'Z__2": 3545645, "A'close',_'OPL_WA'Z__3": 5.738749980926514, "A'low',_'OPL_WA'Z__3": 5.575766002537287, "A'high',_'OPL_WA'Z__3": 5.747327869770285, "A'timestamp',_''Z__3": datetime.datetime(2020, 3, 4, 0, 0), "A'open',_'OPL_WA'Z__3": 5.652969047310014, "A'symbol',_''Z__3": 'OPL', "A'volume',_'OPL_WA'Z__3": 3740050, "A'close',_'OPL_WA'Z__4": 5.682991981506348, "A'low',_'OPL_WA'Z__4": 5.605788940677468, "A'high',_'OPL_WA'Z__4": 5.807374431155246, "A'timestamp',_''Z__4": datetime.datetime(2020, 3, 5, 0, 0), "A'open',_'OPL_WA'Z__4": 5.807374431155246, "A'symbol',_''Z__4": 'OPL', "A'volume',_'OPL_WA'Z__4": 2253064, "A'close',_'OPL_WA'Z__5": 5.661546230316162, "A'low',_'OPL_WA'Z__5": 5.468539051482736, "A'high',_'OPL_WA'Z__5": 5.717303932474388, "A'timestamp',_''Z__5": datetime.datetime(2020, 3, 6, 0, 0), "A'open',_'OPL_WA'Z__5": 5.468539051482736, "A'symbol',_''Z__5": 'OPL', "A'volume',_'OPL_WA'Z__5": 4067621, "A'close',_'OPL_WA'Z__6": 5.382758140563965, "A'low',_'OPL_WA'Z__6": 4.971009300584485, "A'high',_'OPL_WA'Z__6": 5.550030838375947, "A'timestamp',_''Z__6": datetime.datetime(2020, 3, 9, 0, 0), "A'open',_'OPL_WA'Z__6": 5.339867474489469, "A'symbol',_''Z__6": 'OPL', "A'volume',_'OPL_WA'Z__6": 4944503, "A'close',_'OPL_WA'Z__7": 5.224063873291016 ... 6900 parameters truncated ... "A'volume',_'OPL_WA'Z__992": 2449232, "A'close',_'OPL_WA'Z__993": 8.229509353637695, "A'low',_'OPL_WA'Z__993": 8.203126796746416, "A'high',_'OPL_WA'Z__993": 8.438686367376786, "A'timestamp',_''Z__993": datetime.datetime(2024, 2, 5, 0, 0), "A'open',_'OPL_WA'Z__993": 8.384036015026176, "A'symbol',_''Z__993": 'OPL', "A'volume',_'OPL_WA'Z__993": 2091145, "A'close',_'OPL_WA'Z__994": 8.357653617858887, "A'low',_'OPL_WA'Z__994": 8.269083347005928, "A'high',_'OPL_WA'Z__994": 8.380267495223146, "A'timestamp',_''Z__994": datetime.datetime(2024, 2, 6, 0, 0), "A'open',_'OPL_WA'Z__994": 8.333155400479017, "A'symbol',_''Z__994": 'OPL', "A'volume',_'OPL_WA'Z__994": 1816361, "A'close',_'OPL_WA'Z__995": 8.240816116333008, "A'low',_'OPL_WA'Z__995": 8.216317899943856, "A'high',_'OPL_WA'Z__995": 8.410418392529232, "A'timestamp',_''Z__995": datetime.datetime(2024, 2, 7, 0, 0), "A'open',_'OPL_WA'Z__995": 8.38592017614008, "A'symbol',_''Z__995": 'OPL', "A'volume',_'OPL_WA'Z__995": 1208495, "A'close',_'OPL_WA'Z__996": 8.231393814086914, "A'low',_'OPL_WA'Z__996": 8.122094006374503, "A'high',_'OPL_WA'Z__996": 8.327502343160626, "A'timestamp',_''Z__996": datetime.datetime(2024, 2, 8, 0, 0), "A'open',_'OPL_WA'Z__996": 8.197472998192346, "A'symbol',_''Z__996": 'OPL', "A'volume',_'OPL_WA'Z__996": 934987, "A'close',_'OPL_WA'Z__997": 8.180512428283691, "A'low',_'OPL_WA'Z__997": 8.156014212844, "A'high',_'OPL_WA'Z__997": 8.244584476682487, "A'timestamp',_''Z__997": datetime.datetime(2024, 2, 9, 0, 0), "A'open',_'OPL_WA'Z__997": 8.244584476682487, "A'symbol',_''Z__997": 'OPL', "A'volume',_'OPL_WA'Z__997": 672406, "A'close',_'OPL_WA'Z__998": 8.270967483520508, "A'low',_'OPL_WA'Z__998": 8.14282337972722, "A'high',_'OPL_WA'Z__998": 8.286043101862933, "A'timestamp',_''Z__998": datetime.datetime(2024, 2, 12, 0, 0), "A'open',_'OPL_WA'Z__998": 8.188050234754499, "A'symbol',_''Z__998": 'OPL', "A'volume',_'OPL_WA'Z__998": 1841551, "A'close',_'OPL_WA'Z__999": 7.897840976715088, "A'low',_'OPL_WA'Z__999": 7.741429082276557, "A'high',_'OPL_WA'Z__999": 8.259660299098567, "A'timestamp',_''Z__999": datetime.datetime(2024, 2, 13, 0, 0), "A'open',_'OPL_WA'Z__999": 8.25212293944608, "A'symbol',_''Z__999": 'OPL', "A'volume',_'OPL_WA'Z__999": 4696570}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-02-26 22:43:10,266 - historical_importer - INFO - Imported 0 records for OPL
2025-02-26 22:43:11,269 - historical_importer - INFO - Fetching 5 years of data for MIL.WA
2025-02-26 22:43:11,609 - historical_importer - ERROR - Error saving historical data: (psycopg2.errors.UndefinedColumn) column "('open', 'MIL.WA')" of relation "staging_stock_prices" does not exist
LINE 1: ...ck_prices ("('symbol', '')", "('timestamp', '')", "('open', ...
                                                             ^

[SQL: INSERT INTO staging_stock_prices ("('symbol', '')", "('timestamp', '')", "('open', 'MIL.WA')", "('high', 'MIL.WA')", "('low', 'MIL.WA')", "('close', 'MIL.WA')", "('volume', 'MIL.WA')") VALUES (%(A'symbol',_''Z__0)s, %(A'timestamp',_''Z__0)s, %(A'open ... 201070 characters truncated ... A'Z__999)s, %(A'low',_'MIL_WA'Z__999)s, %(A'close',_'MIL_WA'Z__999)s, %(A'volume',_'MIL_WA'Z__999)s)]
[parameters: {"A'volume',_'MIL_WA'Z__0": 1943994, "A'close',_'MIL_WA'Z__0": 4.826000213623047, "A'timestamp',_''Z__0": datetime.datetime(2020, 2, 28, 0, 0), "A'high',_'MIL_WA'Z__0": 5.079999923706055, "A'symbol',_''Z__0": 'MIL', "A'low',_'MIL_WA'Z__0": 4.826000213623047, "A'open',_'MIL_WA'Z__0": 5.010000228881836, "A'volume',_'MIL_WA'Z__1": 1309207, "A'close',_'MIL_WA'Z__1": 4.763999938964844, "A'timestamp',_''Z__1": datetime.datetime(2020, 3, 2, 0, 0), "A'high',_'MIL_WA'Z__1": 5.199999809265137, "A'symbol',_''Z__1": 'MIL', "A'low',_'MIL_WA'Z__1": 4.763999938964844, "A'open',_'MIL_WA'Z__1": 5.09499979019165, "A'volume',_'MIL_WA'Z__2": 1489053, "A'close',_'MIL_WA'Z__2": 5.059999942779541, "A'timestamp',_''Z__2": datetime.datetime(2020, 3, 3, 0, 0), "A'high',_'MIL_WA'Z__2": 5.114999771118164, "A'symbol',_''Z__2": 'MIL', "A'low',_'MIL_WA'Z__2": 4.791999816894531, "A'open',_'MIL_WA'Z__2": 4.849999904632568, "A'volume',_'MIL_WA'Z__3": 609610, "A'close',_'MIL_WA'Z__3": 5.079999923706055, "A'timestamp',_''Z__3": datetime.datetime(2020, 3, 4, 0, 0), "A'high',_'MIL_WA'Z__3": 5.110000133514404, "A'symbol',_''Z__3": 'MIL', "A'low',_'MIL_WA'Z__3": 4.900000095367432, "A'open',_'MIL_WA'Z__3": 4.900000095367432, "A'volume',_'MIL_WA'Z__4": 1045203, "A'close',_'MIL_WA'Z__4": 5.03000020980835, "A'timestamp',_''Z__4": datetime.datetime(2020, 3, 5, 0, 0), "A'high',_'MIL_WA'Z__4": 5.199999809265137, "A'symbol',_''Z__4": 'MIL', "A'low',_'MIL_WA'Z__4": 4.966000080108643, "A'open',_'MIL_WA'Z__4": 5.199999809265137, "A'volume',_'MIL_WA'Z__5": 1498868, "A'close',_'MIL_WA'Z__5": 4.866000175476074, "A'timestamp',_''Z__5": datetime.datetime(2020, 3, 6, 0, 0), "A'high',_'MIL_WA'Z__5": 5.005000114440918, "A'symbol',_''Z__5": 'MIL', "A'low',_'MIL_WA'Z__5": 4.71999979019165, "A'open',_'MIL_WA'Z__5": 4.98199987411499, "A'volume',_'MIL_WA'Z__6": 1413151, "A'close',_'MIL_WA'Z__6": 4.269999980926514, "A'timestamp',_''Z__6": datetime.datetime(2020, 3, 9, 0, 0), "A'high',_'MIL_WA'Z__6": 4.6539998054504395, "A'symbol',_''Z__6": 'MIL', "A'low',_'MIL_WA'Z__6": 4.263999938964844, "A'open',_'MIL_WA'Z__6": 4.5, "A'volume',_'MIL_WA'Z__7": 1108626 ... 6900 parameters truncated ... "A'open',_'MIL_WA'Z__992": 8.454999923706055, "A'volume',_'MIL_WA'Z__993": 670815, "A'close',_'MIL_WA'Z__993": 8.449999809265137, "A'timestamp',_''Z__993": datetime.datetime(2024, 2, 5, 0, 0), "A'high',_'MIL_WA'Z__993": 8.774999618530273, "A'symbol',_''Z__993": 'MIL', "A'low',_'MIL_WA'Z__993": 8.34000015258789, "A'open',_'MIL_WA'Z__993": 8.600000381469727, "A'volume',_'MIL_WA'Z__994": 801007, "A'close',_'MIL_WA'Z__994": 8.520000457763672, "A'timestamp',_''Z__994": datetime.datetime(2024, 2, 6, 0, 0), "A'high',_'MIL_WA'Z__994": 8.699999809265137, "A'symbol',_''Z__994": 'MIL', "A'low',_'MIL_WA'Z__994": 8.40999984741211, "A'open',_'MIL_WA'Z__994": 8.5, "A'volume',_'MIL_WA'Z__995": 629351, "A'close',_'MIL_WA'Z__995": 8.484999656677246, "A'timestamp',_''Z__995": datetime.datetime(2024, 2, 7, 0, 0), "A'high',_'MIL_WA'Z__995": 8.680000305175781, "A'symbol',_''Z__995": 'MIL', "A'low',_'MIL_WA'Z__995": 8.430000305175781, "A'open',_'MIL_WA'Z__995": 8.680000305175781, "A'volume',_'MIL_WA'Z__996": 705325, "A'close',_'MIL_WA'Z__996": 8.640000343322754, "A'timestamp',_''Z__996": datetime.datetime(2024, 2, 8, 0, 0), "A'high',_'MIL_WA'Z__996": 8.654999732971191, "A'symbol',_''Z__996": 'MIL', "A'low',_'MIL_WA'Z__996": 8.319999694824219, "A'open',_'MIL_WA'Z__996": 8.430000305175781, "A'volume',_'MIL_WA'Z__997": 341224, "A'close',_'MIL_WA'Z__997": 8.399999618530273, "A'timestamp',_''Z__997": datetime.datetime(2024, 2, 9, 0, 0), "A'high',_'MIL_WA'Z__997": 8.640000343322754, "A'symbol',_''Z__997": 'MIL', "A'low',_'MIL_WA'Z__997": 8.399999618530273, "A'open',_'MIL_WA'Z__997": 8.640000343322754, "A'volume',_'MIL_WA'Z__998": 256020, "A'close',_'MIL_WA'Z__998": 8.399999618530273, "A'timestamp',_''Z__998": datetime.datetime(2024, 2, 12, 0, 0), "A'high',_'MIL_WA'Z__998": 8.449999809265137, "A'symbol',_''Z__998": 'MIL', "A'low',_'MIL_WA'Z__998": 8.229999542236328, "A'open',_'MIL_WA'Z__998": 8.420000076293945, "A'volume',_'MIL_WA'Z__999": 514305, "A'close',_'MIL_WA'Z__999": 8.5, "A'timestamp',_''Z__999": datetime.datetime(2024, 2, 13, 0, 0), "A'high',_'MIL_WA'Z__999": 8.604999542236328, "A'symbol',_''Z__999": 'MIL', "A'low',_'MIL_WA'Z__999": 8.255000114440918, "A'open',_'MIL_WA'Z__999": 8.40999984741211}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-02-26 22:43:11,610 - historical_importer - INFO - Imported 0 records for MIL
2025-02-26 22:43:12,620 - historical_importer - INFO - Fetching 5 years of data for KRU.WA
2025-02-26 22:43:12,934 - historical_importer - ERROR - Error saving historical data: (psycopg2.errors.UndefinedColumn) column "('open', 'KRU.WA')" of relation "staging_stock_prices" does not exist
LINE 1: ...ck_prices ("('symbol', '')", "('timestamp', '')", "('open', ...
                                                             ^

[SQL: INSERT INTO staging_stock_prices ("('symbol', '')", "('timestamp', '')", "('open', 'KRU.WA')", "('high', 'KRU.WA')", "('low', 'KRU.WA')", "('close', 'KRU.WA')", "('volume', 'KRU.WA')") VALUES (%(A'symbol',_''Z__0)s, %(A'timestamp',_''Z__0)s, %(A'open ... 201070 characters truncated ... A'Z__999)s, %(A'low',_'KRU_WA'Z__999)s, %(A'close',_'KRU_WA'Z__999)s, %(A'volume',_'KRU_WA'Z__999)s)]
[parameters: {"A'high',_'KRU_WA'Z__0": 124.66268339494844, "A'close',_'KRU_WA'Z__0": 117.59022521972656, "A'open',_'KRU_WA'Z__0": 123.81058031364608, "A'timestamp',_''Z__0": datetime.datetime(2020, 2, 28, 0, 0), "A'volume',_'KRU_WA'Z__0": 101228, "A'symbol',_''Z__0": 'KRU', "A'low',_'KRU_WA'Z__0": 117.59022521972658, "A'high',_'KRU_WA'Z__1": 123.46971824728891, "A'close',_'KRU_WA'Z__1": 114.18180084228516, "A'open',_'KRU_WA'Z__1": 117.5902128077265, "A'timestamp',_''Z__1": datetime.datetime(2020, 3, 2, 0, 0), "A'volume',_'KRU_WA'Z__1": 57070, "A'symbol',_''Z__1": 'KRU', "A'low',_'KRU_WA'Z__1": 113.41491335088477, "A'high',_'KRU_WA'Z__2": 120.65779248483983, "A'close',_'KRU_WA'Z__2": 116.73811340332031, "A'open',_'KRU_WA'Z__2": 114.43743785636765, "A'timestamp',_''Z__2": datetime.datetime(2020, 3, 3, 0, 0), "A'volume',_'KRU_WA'Z__2": 60557, "A'symbol',_''Z__2": 'KRU', "A'low',_'KRU_WA'Z__2": 113.84096834449996, "A'high',_'KRU_WA'Z__3": 118.18668730414142, "A'close',_'KRU_WA'Z__3": 114.26702117919922, "A'open',_'KRU_WA'Z__3": 116.73811475792233, "A'timestamp',_''Z__3": datetime.datetime(2020, 3, 4, 0, 0), "A'volume',_'KRU_WA'Z__3": 22854, "A'symbol',_''Z__3": 'KRU', "A'low',_'KRU_WA'Z__3": 114.18180567563206, "A'high',_'KRU_WA'Z__4": 120.0613116563098, "A'close',_'KRU_WA'Z__4": 115.80079650878906, "A'open',_'KRU_WA'Z__4": 116.82333054584235, "A'timestamp',_''Z__4": datetime.datetime(2020, 3, 5, 0, 0), "A'volume',_'KRU_WA'Z__4": 23992, "A'symbol',_''Z__4": 'KRU', "A'low',_'KRU_WA'Z__4": 114.43743946281867, "A'high',_'KRU_WA'Z__5": 114.94869511326333, "A'close',_'KRU_WA'Z__5": 110.00650787353516, "A'open',_'KRU_WA'Z__5": 114.94869511326333, "A'timestamp',_''Z__5": datetime.datetime(2020, 3, 6, 0, 0), "A'volume',_'KRU_WA'Z__5": 77492, "A'symbol',_''Z__5": 'KRU', "A'low',_'KRU_WA'Z__5": 106.59808920603822, "A'high',_'KRU_WA'Z__6": 108.21708070537142, "A'close',_'KRU_WA'Z__6": 106.42766571044922, "A'open',_'KRU_WA'Z__6": 108.21708070537142, "A'timestamp',_''Z__6": datetime.datetime(2020, 3, 9, 0, 0), "A'volume',_'KRU_WA'Z__6": 45436, "A'symbol',_''Z__6": 'KRU', "A'low',_'KRU_WA'Z__6": 102.42277772073483, "A'high',_'KRU_WA'Z__7": 107.53539071458711 ... 6900 parameters truncated ... "A'low',_'KRU_WA'Z__992": 435.4992534977347, "A'high',_'KRU_WA'Z__993": 443.00451166187395, "A'close',_'KRU_WA'Z__993": 427.9939270019531, "A'open',_'KRU_WA'Z__993": 437.8085479546567, "A'timestamp',_''Z__993": datetime.datetime(2024, 2, 5, 0, 0), "A'volume',_'KRU_WA'Z__993": 20233, "A'symbol',_''Z__993": 'KRU', "A'low',_'KRU_WA'Z__993": 426.6468296503813, "A'high',_'KRU_WA'Z__994": 437.8085738781617, "A'close',_'KRU_WA'Z__994": 432.61260986328125, "A'open',_'KRU_WA'Z__994": 427.41664584840083, "A'timestamp',_''Z__994": datetime.datetime(2024, 2, 6, 0, 0), "A'volume',_'KRU_WA'Z__994": 21169, "A'symbol',_''Z__994": 'KRU', "A'low',_'KRU_WA'Z__994": 426.45442920251475, "A'high',_'KRU_WA'Z__995": 440.69521743741126, "A'close',_'KRU_WA'Z__995": 437.2312316894531, "A'open',_'KRU_WA'Z__995": 433.18993945393635, "A'timestamp',_''Z__995": datetime.datetime(2024, 2, 7, 0, 0), "A'volume',_'KRU_WA'Z__995": 16461, "A'symbol',_''Z__995": 'KRU', "A'low',_'KRU_WA'Z__995": 433.18993945393635, "A'high',_'KRU_WA'Z__996": 441.6574287806804, "A'close',_'KRU_WA'Z__996": 435.3067932128906, "A'open',_'KRU_WA'Z__996": 437.42368152366083, "A'timestamp',_''Z__996": datetime.datetime(2024, 2, 8, 0, 0), "A'volume',_'KRU_WA'Z__996": 20657, "A'symbol',_''Z__996": 'KRU', "A'low',_'KRU_WA'Z__996": 433.574815041912, "A'high',_'KRU_WA'Z__997": 433.95967964504075, "A'close',_'KRU_WA'Z__997": 420.4886474609375, "A'open',_'KRU_WA'Z__997": 433.95967964504075, "A'timestamp',_''Z__997": datetime.datetime(2024, 2, 9, 0, 0), "A'volume',_'KRU_WA'Z__997": 30896, "A'symbol',_''Z__997": 'KRU', "A'low',_'KRU_WA'Z__997": 418.94909505270743, "A'high',_'KRU_WA'Z__998": 432.99748543614055, "A'close',_'KRU_WA'Z__998": 430.68817138671875, "A'open',_'KRU_WA'Z__998": 420.4886691902076, "A'timestamp',_''Z__998": datetime.datetime(2024, 2, 12, 0, 0), "A'volume',_'KRU_WA'Z__998": 28842, "A'symbol',_''Z__998": 'KRU', "A'low',_'KRU_WA'Z__998": 420.4886691902076, "A'high',_'KRU_WA'Z__999": 431.4579295083369, "A'close',_'KRU_WA'Z__999": 418.1793518066406, "A'open',_'KRU_WA'Z__999": 428.3788539218311, "A'timestamp',_''Z__999": datetime.datetime(2024, 2, 13, 0, 0), "A'volume',_'KRU_WA'Z__999": 45526, "A'symbol',_''Z__999": 'KRU', "A'low',_'KRU_WA'Z__999": 410.8664995713425}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-02-26 22:43:12,934 - historical_importer - INFO - Imported 0 records for KRU
2025-02-26 22:43:13,942 - historical_importer - INFO - Fetching 5 years of data for BDX.WA
2025-02-26 22:43:14,253 - historical_importer - ERROR - Error saving historical data: (psycopg2.errors.UndefinedColumn) column "('open', 'BDX.WA')" of relation "staging_stock_prices" does not exist
LINE 1: ...ck_prices ("('symbol', '')", "('timestamp', '')", "('open', ...
                                                             ^

[SQL: INSERT INTO staging_stock_prices ("('symbol', '')", "('timestamp', '')", "('open', 'BDX.WA')", "('high', 'BDX.WA')", "('low', 'BDX.WA')", "('close', 'BDX.WA')", "('volume', 'BDX.WA')") VALUES (%(A'symbol',_''Z__0)s, %(A'timestamp',_''Z__0)s, %(A'open ... 201070 characters truncated ... A'Z__999)s, %(A'low',_'BDX_WA'Z__999)s, %(A'close',_'BDX_WA'Z__999)s, %(A'volume',_'BDX_WA'Z__999)s)]
[parameters: {"A'volume',_'BDX_WA'Z__0": 23405, "A'low',_'BDX_WA'Z__0": 122.5795398789332, "A'close',_'BDX_WA'Z__0": 124.5820083618164, "A'timestamp',_''Z__0": datetime.datetime(2020, 2, 28, 0, 0), "A'symbol',_''Z__0": 'BDX', "A'high',_'BDX_WA'Z__0": 128.72997645223688, "A'open',_'BDX_WA'Z__0": 123.00864416547078, "A'volume',_'BDX_WA'Z__1": 50027, "A'low',_'BDX_WA'Z__1": 123.00861674777711, "A'close',_'BDX_WA'Z__1": 129.4451141357422, "A'timestamp',_''Z__1": datetime.datetime(2020, 3, 2, 0, 0), "A'symbol',_''Z__1": 'BDX', "A'high',_'BDX_WA'Z__1": 132.16274854873092, "A'open',_'BDX_WA'Z__1": 123.00861674777711, "A'volume',_'BDX_WA'Z__2": 45246, "A'low',_'BDX_WA'Z__2": 131.0184974212187, "A'close',_'BDX_WA'Z__2": 134.59432983398438, "A'timestamp',_''Z__2": datetime.datetime(2020, 3, 3, 0, 0), "A'symbol',_''Z__2": 'BDX', "A'high',_'BDX_WA'Z__2": 137.02590242220973, "A'open',_'BDX_WA'Z__2": 132.30579927232924, "A'volume',_'BDX_WA'Z__3": 24445, "A'low',_'BDX_WA'Z__3": 134.59435078058098, "A'close',_'BDX_WA'Z__3": 135.88165283203125, "A'timestamp',_''Z__3": datetime.datetime(2020, 3, 4, 0, 0), "A'symbol',_''Z__3": 'BDX', "A'high',_'BDX_WA'Z__3": 137.0259237472262, "A'open',_'BDX_WA'Z__3": 134.59435078058098, "A'volume',_'BDX_WA'Z__4": 21711, "A'low',_'BDX_WA'Z__4": 132.87793556667833, "A'close',_'BDX_WA'Z__4": 134.1652374267578, "A'timestamp',_''Z__4": datetime.datetime(2020, 3, 5, 0, 0), "A'symbol',_''Z__4": 'BDX', "A'high',_'BDX_WA'Z__4": 135.88163263181406, "A'open',_'BDX_WA'Z__4": 135.88163263181406, "A'volume',_'BDX_WA'Z__5": 72663, "A'low',_'BDX_WA'Z__5": 130.0172707932888, "A'close',_'BDX_WA'Z__5": 132.30580139160156, "A'timestamp',_''Z__5": datetime.datetime(2020, 3, 6, 0, 0), "A'symbol',_''Z__5": 'BDX', "A'high',_'BDX_WA'Z__5": 134.16523864105395, "A'open',_'BDX_WA'Z__5": 134.16523864105395, "A'volume',_'BDX_WA'Z__6": 38820, "A'low',_'BDX_WA'Z__6": 121.57829400638762, "A'close',_'BDX_WA'Z__6": 125.29715728759766, "A'timestamp',_''Z__6": datetime.datetime(2020, 3, 9, 0, 0), "A'symbol',_''Z__6": 'BDX', "A'high',_'BDX_WA'Z__6": 127.87176081982126, "A'open',_'BDX_WA'Z__6": 127.29962548904116, "A'volume',_'BDX_WA'Z__7": 38815 ... 6900 parameters truncated ... "A'open',_'BDX_WA'Z__992": 656.1971775831374, "A'volume',_'BDX_WA'Z__993": 21695, "A'low',_'BDX_WA'Z__993": 645.6903941434973, "A'close',_'BDX_WA'Z__993": 649.5110473632812, "A'timestamp',_''Z__993": datetime.datetime(2024, 2, 5, 0, 0), "A'symbol',_''Z__993": 'BDX', "A'high',_'BDX_WA'Z__993": 652.3765372781193, "A'open',_'BDX_WA'Z__993": 648.5558840583353, "A'volume',_'BDX_WA'Z__994": 24755, "A'low',_'BDX_WA'Z__994": 644.7352559942948, "A'close',_'BDX_WA'Z__994": 653.3317260742188, "A'timestamp',_''Z__994": datetime.datetime(2024, 2, 6, 0, 0), "A'symbol',_''Z__994": 'BDX', "A'high',_'BDX_WA'Z__994": 659.0627061275013, "A'open',_'BDX_WA'Z__994": 649.5110727053636, "A'volume',_'BDX_WA'Z__995": 27291, "A'low',_'BDX_WA'Z__995": 652.3765512880107, "A'close',_'BDX_WA'Z__995": 656.1972045898438, "A'timestamp',_''Z__995": datetime.datetime(2024, 2, 7, 0, 0), "A'symbol',_''Z__995": 'BDX', "A'high',_'BDX_WA'Z__995": 658.1075312407603, "A'open',_'BDX_WA'Z__995": 656.1972045898438, "A'volume',_'BDX_WA'Z__996": 19556, "A'low',_'BDX_WA'Z__996": 651.4213640079942, "A'close',_'BDX_WA'Z__996": 657.15234375, "A'timestamp',_''Z__996": datetime.datetime(2024, 2, 8, 0, 0), "A'symbol',_''Z__996": 'BDX', "A'high',_'BDX_WA'Z__996": 659.0626703306687, "A'open',_'BDX_WA'Z__996": 655.2420171693315, "A'volume',_'BDX_WA'Z__997": 17829, "A'low',_'BDX_WA'Z__997": 644.7352209756541, "A'close',_'BDX_WA'Z__997": 657.15234375, "A'timestamp',_''Z__997": datetime.datetime(2024, 2, 9, 0, 0), "A'symbol',_''Z__997": 'BDX', "A'high',_'BDX_WA'Z__997": 658.1075070403343, "A'open',_'BDX_WA'Z__997": 652.3765272983285, "A'volume',_'BDX_WA'Z__998": 11486, "A'low',_'BDX_WA'Z__998": 641.8697170980176, "A'close',_'BDX_WA'Z__998": 650.4661865234375, "A'timestamp',_''Z__998": datetime.datetime(2024, 2, 12, 0, 0), "A'symbol',_''Z__998": 'BDX', "A'high',_'BDX_WA'Z__998": 657.1523294098752, "A'open',_'BDX_WA'Z__998": 657.1523294098752, "A'volume',_'BDX_WA'Z__999": 33079, "A'low',_'BDX_WA'Z__999": 626.5871002838776, "A'close',_'BDX_WA'Z__999": 636.1387329101562, "A'timestamp',_''Z__999": datetime.datetime(2024, 2, 13, 0, 0), "A'symbol',_''Z__999": 'BDX', "A'high',_'BDX_WA'Z__999": 644.735202273807, "A'open',_'BDX_WA'Z__999": 644.735202273807}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-02-26 22:43:14,253 - historical_importer - INFO - Imported 0 records for BDX
2025-02-26 22:43:15,254 - historical_importer - INFO - Fetching 5 years of data for PLY.WA
2025-02-26 22:43:15,425 - yfinance - ERROR - 
1 Failed download:
2025-02-26 22:43:15,426 - yfinance - ERROR - ['PLY.WA']: ValueError('Length mismatch: Expected axis has 2 elements, new values have 1 elements')
2025-02-26 22:43:15,428 - historical_importer - WARNING - No data retrieved for PLY
2025-02-26 22:43:15,429 - historical_importer - INFO - Imported 0 records for PLY
2025-02-26 22:43:16,433 - historical_importer - INFO - Fetching 5 years of data for JSW.WA
2025-02-26 22:43:16,735 - historical_importer - ERROR - Error saving historical data: (psycopg2.errors.UndefinedColumn) column "('open', 'JSW.WA')" of relation "staging_stock_prices" does not exist
LINE 1: ...ck_prices ("('symbol', '')", "('timestamp', '')", "('open', ...
                                                             ^

[SQL: INSERT INTO staging_stock_prices ("('symbol', '')", "('timestamp', '')", "('open', 'JSW.WA')", "('high', 'JSW.WA')", "('low', 'JSW.WA')", "('close', 'JSW.WA')", "('volume', 'JSW.WA')") VALUES (%(A'symbol',_''Z__0)s, %(A'timestamp',_''Z__0)s, %(A'open ... 201070 characters truncated ... A'Z__999)s, %(A'low',_'JSW_WA'Z__999)s, %(A'close',_'JSW_WA'Z__999)s, %(A'volume',_'JSW_WA'Z__999)s)]
[parameters: {"A'low',_'JSW_WA'Z__0": 12.109999656677246, "A'close',_'JSW_WA'Z__0": 13.529999732971191, "A'volume',_'JSW_WA'Z__0": 3443956, "A'high',_'JSW_WA'Z__0": 14.979999542236328, "A'timestamp',_''Z__0": datetime.datetime(2020, 2, 28, 0, 0), "A'open',_'JSW_WA'Z__0": 12.4399995803833, "A'symbol',_''Z__0": 'JSW', "A'low',_'JSW_WA'Z__1": 13.5600004196167, "A'close',_'JSW_WA'Z__1": 14.1899995803833, "A'volume',_'JSW_WA'Z__1": 1733034, "A'high',_'JSW_WA'Z__1": 14.729999542236328, "A'timestamp',_''Z__1": datetime.datetime(2020, 3, 2, 0, 0), "A'open',_'JSW_WA'Z__1": 14.5, "A'symbol',_''Z__1": 'JSW', "A'low',_'JSW_WA'Z__2": 14.25, "A'close',_'JSW_WA'Z__2": 15.149999618530273, "A'volume',_'JSW_WA'Z__2": 2306907, "A'high',_'JSW_WA'Z__2": 15.350000381469727, "A'timestamp',_''Z__2": datetime.datetime(2020, 3, 3, 0, 0), "A'open',_'JSW_WA'Z__2": 14.550000190734863, "A'symbol',_''Z__2": 'JSW', "A'low',_'JSW_WA'Z__3": 14.529999732971191, "A'close',_'JSW_WA'Z__3": 14.539999961853027, "A'volume',_'JSW_WA'Z__3": 933222, "A'high',_'JSW_WA'Z__3": 15.199999809265137, "A'timestamp',_''Z__3": datetime.datetime(2020, 3, 4, 0, 0), "A'open',_'JSW_WA'Z__3": 15.199999809265137, "A'symbol',_''Z__3": 'JSW', "A'low',_'JSW_WA'Z__4": 13.800000190734863, "A'close',_'JSW_WA'Z__4": 14.149999618530273, "A'volume',_'JSW_WA'Z__4": 856891, "A'high',_'JSW_WA'Z__4": 14.869999885559082, "A'timestamp',_''Z__4": datetime.datetime(2020, 3, 5, 0, 0), "A'open',_'JSW_WA'Z__4": 14.859999656677246, "A'symbol',_''Z__4": 'JSW', "A'low',_'JSW_WA'Z__5": 13.260000228881836, "A'close',_'JSW_WA'Z__5": 13.850000381469727, "A'volume',_'JSW_WA'Z__5": 1091974, "A'high',_'JSW_WA'Z__5": 13.949999809265137, "A'timestamp',_''Z__5": datetime.datetime(2020, 3, 6, 0, 0), "A'open',_'JSW_WA'Z__5": 13.800000190734863, "A'symbol',_''Z__5": 'JSW', "A'low',_'JSW_WA'Z__6": 12.15999984741211, "A'close',_'JSW_WA'Z__6": 12.5, "A'volume',_'JSW_WA'Z__6": 1436022, "A'high',_'JSW_WA'Z__6": 13.210000038146973, "A'timestamp',_''Z__6": datetime.datetime(2020, 3, 9, 0, 0), "A'open',_'JSW_WA'Z__6": 12.800000190734863, "A'symbol',_''Z__6": 'JSW', "A'low',_'JSW_WA'Z__7": 11.920000076293945 ... 6900 parameters truncated ... "A'symbol',_''Z__992": 'JSW', "A'low',_'JSW_WA'Z__993": 42.91999816894531, "A'close',_'JSW_WA'Z__993": 42.91999816894531, "A'volume',_'JSW_WA'Z__993": 275773, "A'high',_'JSW_WA'Z__993": 43.90999984741211, "A'timestamp',_''Z__993": datetime.datetime(2024, 2, 5, 0, 0), "A'open',_'JSW_WA'Z__993": 43.29999923706055, "A'symbol',_''Z__993": 'JSW', "A'low',_'JSW_WA'Z__994": 42.189998626708984, "A'close',_'JSW_WA'Z__994": 43.540000915527344, "A'volume',_'JSW_WA'Z__994": 252014, "A'high',_'JSW_WA'Z__994": 43.81999969482422, "A'timestamp',_''Z__994": datetime.datetime(2024, 2, 6, 0, 0), "A'open',_'JSW_WA'Z__994": 43.5, "A'symbol',_''Z__994": 'JSW', "A'low',_'JSW_WA'Z__995": 43.22999954223633, "A'close',_'JSW_WA'Z__995": 43.349998474121094, "A'volume',_'JSW_WA'Z__995": 135225, "A'high',_'JSW_WA'Z__995": 43.83000183105469, "A'timestamp',_''Z__995": datetime.datetime(2024, 2, 7, 0, 0), "A'open',_'JSW_WA'Z__995": 43.5, "A'symbol',_''Z__995": 'JSW', "A'low',_'JSW_WA'Z__996": 43.189998626708984, "A'close',_'JSW_WA'Z__996": 43.34000015258789, "A'volume',_'JSW_WA'Z__996": 125642, "A'high',_'JSW_WA'Z__996": 43.689998626708984, "A'timestamp',_''Z__996": datetime.datetime(2024, 2, 8, 0, 0), "A'open',_'JSW_WA'Z__996": 43.38999938964844, "A'symbol',_''Z__996": 'JSW', "A'low',_'JSW_WA'Z__997": 42.810001373291016, "A'close',_'JSW_WA'Z__997": 42.810001373291016, "A'volume',_'JSW_WA'Z__997": 139284, "A'high',_'JSW_WA'Z__997": 43.5, "A'timestamp',_''Z__997": datetime.datetime(2024, 2, 9, 0, 0), "A'open',_'JSW_WA'Z__997": 43.5, "A'symbol',_''Z__997": 'JSW', "A'low',_'JSW_WA'Z__998": 42.810001373291016, "A'close',_'JSW_WA'Z__998": 44.220001220703125, "A'volume',_'JSW_WA'Z__998": 382648, "A'high',_'JSW_WA'Z__998": 44.220001220703125, "A'timestamp',_''Z__998": datetime.datetime(2024, 2, 12, 0, 0), "A'open',_'JSW_WA'Z__998": 42.810001373291016, "A'symbol',_''Z__998": 'JSW', "A'low',_'JSW_WA'Z__999": 41.900001525878906, "A'close',_'JSW_WA'Z__999": 42.189998626708984, "A'volume',_'JSW_WA'Z__999": 478927, "A'high',_'JSW_WA'Z__999": 44.720001220703125, "A'timestamp',_''Z__999": datetime.datetime(2024, 2, 13, 0, 0), "A'open',_'JSW_WA'Z__999": 44.400001525878906, "A'symbol',_''Z__999": 'JSW'}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-02-26 22:43:16,736 - historical_importer - INFO - Imported 0 records for JSW
2025-02-26 22:43:17,743 - historical_importer - INFO - Fetching 5 years of data for WPL.WA
2025-02-26 22:43:18,028 - historical_importer - ERROR - Error saving historical data: (psycopg2.errors.UndefinedColumn) column "('open', 'WPL.WA')" of relation "staging_stock_prices" does not exist
LINE 1: ...ck_prices ("('symbol', '')", "('timestamp', '')", "('open', ...
                                                             ^

[SQL: INSERT INTO staging_stock_prices ("('symbol', '')", "('timestamp', '')", "('open', 'WPL.WA')", "('high', 'WPL.WA')", "('low', 'WPL.WA')", "('close', 'WPL.WA')", "('volume', 'WPL.WA')") VALUES (%(A'symbol',_''Z__0)s, %(A'timestamp',_''Z__0)s, %(A'open ... 201070 characters truncated ... A'Z__999)s, %(A'low',_'WPL_WA'Z__999)s, %(A'close',_'WPL_WA'Z__999)s, %(A'volume',_'WPL_WA'Z__999)s)]
[parameters: {"A'open',_'WPL_WA'Z__0": 70.06621137847135, "A'close',_'WPL_WA'Z__0": 70.2530517578125, "A'low',_'WPL_WA'Z__0": 66.32934677161954, "A'high',_'WPL_WA'Z__0": 72.8688598336102, "A'volume',_'WPL_WA'Z__0": 30098, "A'timestamp',_''Z__0": datetime.datetime(2020, 2, 28, 0, 0), "A'symbol',_''Z__0": 'WPL', "A'open',_'WPL_WA'Z__1": 70.06621024977993, "A'close',_'WPL_WA'Z__1": 66.329345703125, "A'low',_'WPL_WA'Z__1": 66.329345703125, "A'high',_'WPL_WA'Z__1": 73.80307479643486, "A'volume',_'WPL_WA'Z__1": 37082, "A'timestamp',_''Z__1": datetime.datetime(2020, 3, 2, 0, 0), "A'symbol',_''Z__1": 'WPL', "A'open',_'WPL_WA'Z__2": 69.1319952267584, "A'close',_'WPL_WA'Z__2": 70.2530517578125, "A'low',_'WPL_WA'Z__2": 68.7583073405725, "A'high',_'WPL_WA'Z__2": 71.93464368189726, "A'volume',_'WPL_WA'Z__2": 15937, "A'timestamp',_''Z__2": datetime.datetime(2020, 3, 3, 0, 0), "A'symbol',_''Z__2": 'WPL', "A'open',_'WPL_WA'Z__3": 73.42939427950216, "A'close',_'WPL_WA'Z__3": 72.86886596679688, "A'low',_'WPL_WA'Z__3": 71.56096181881507, "A'high',_'WPL_WA'Z__3": 74.17677011477869, "A'volume',_'WPL_WA'Z__3": 4955, "A'timestamp',_''Z__3": datetime.datetime(2020, 3, 4, 0, 0), "A'symbol',_''Z__3": 'WPL', "A'open',_'WPL_WA'Z__4": 74.73727841920491, "A'close',_'WPL_WA'Z__4": 73.80306243896484, "A'low',_'WPL_WA'Z__4": 72.68200611367769, "A'high',_'WPL_WA'Z__4": 77.53992635992509, "A'volume',_'WPL_WA'Z__4": 6153, "A'timestamp',_''Z__4": datetime.datetime(2020, 3, 5, 0, 0), "A'symbol',_''Z__4": 'WPL', "A'open',_'WPL_WA'Z__5": 71.00043292135643, "A'close',_'WPL_WA'Z__5": 68.57147216796875, "A'low',_'WPL_WA'Z__5": 67.45040842428695, "A'high',_'WPL_WA'Z__5": 73.24255328121588, "A'volume',_'WPL_WA'Z__5": 80482, "A'timestamp',_''Z__5": datetime.datetime(2020, 3, 6, 0, 0), "A'symbol',_''Z__5": 'WPL', "A'open',_'WPL_WA'Z__6": 62.40563473157983, "A'close',_'WPL_WA'Z__6": 63.713531494140625, "A'low',_'WPL_WA'Z__6": 62.21878724585486, "A'high',_'WPL_WA'Z__6": 68.01093100827852, "A'volume',_'WPL_WA'Z__6": 36728, "A'timestamp',_''Z__6": datetime.datetime(2020, 3, 9, 0, 0), "A'symbol',_''Z__6": 'WPL', "A'open',_'WPL_WA'Z__7": 63.526698318026355 ... 6900 parameters truncated ... "A'symbol',_''Z__992": 'WPL', "A'open',_'WPL_WA'Z__993": 117.62376429670948, "A'close',_'WPL_WA'Z__993": 115.66336822509766, "A'low',_'WPL_WA'Z__993": 114.68317018929174, "A'high',_'WPL_WA'Z__993": 117.62376429670948, "A'volume',_'WPL_WA'Z__993": 1024, "A'timestamp',_''Z__993": datetime.datetime(2024, 2, 5, 0, 0), "A'symbol',_''Z__993": 'WPL', "A'open',_'WPL_WA'Z__994": 115.6633670684522, "A'close',_'WPL_WA'Z__994": 119.38812255859375, "A'low',_'WPL_WA'Z__994": 111.93861157831066, "A'high',_'WPL_WA'Z__994": 119.38812255859375, "A'volume',_'WPL_WA'Z__994": 9227, "A'timestamp',_''Z__994": datetime.datetime(2024, 2, 6, 0, 0), "A'symbol',_''Z__994": 'WPL', "A'open',_'WPL_WA'Z__995": 118.60395744515836, "A'close',_'WPL_WA'Z__995": 118.40792083740234, "A'low',_'WPL_WA'Z__995": 115.2712827650855, "A'high',_'WPL_WA'Z__995": 118.60395744515836, "A'volume',_'WPL_WA'Z__995": 2021, "A'timestamp',_''Z__995": datetime.datetime(2024, 2, 7, 0, 0), "A'symbol',_''Z__995": 'WPL', "A'open',_'WPL_WA'Z__996": 118.60396426128386, "A'close',_'WPL_WA'Z__996": 118.21188354492188, "A'low',_'WPL_WA'Z__996": 114.68317205429926, "A'high',_'WPL_WA'Z__996": 118.60396426128386, "A'volume',_'WPL_WA'Z__996": 13196, "A'timestamp',_''Z__996": datetime.datetime(2024, 2, 8, 0, 0), "A'symbol',_''Z__996": 'WPL', "A'open',_'WPL_WA'Z__997": 118.21187762549185, "A'close',_'WPL_WA'Z__997": 116.64356231689453, "A'low',_'WPL_WA'Z__997": 115.66336431423156, "A'high',_'WPL_WA'Z__997": 118.21187762549185, "A'volume',_'WPL_WA'Z__997": 8765, "A'timestamp',_''Z__997": datetime.datetime(2024, 2, 9, 0, 0), "A'symbol',_''Z__997": 'WPL', "A'open',_'WPL_WA'Z__998": 115.85940458618764, "A'close',_'WPL_WA'Z__998": 117.62376403808594, "A'low',_'WPL_WA'Z__998": 115.46733135538136, "A'high',_'WPL_WA'Z__998": 117.62376403808594, "A'volume',_'WPL_WA'Z__998": 9046, "A'timestamp',_''Z__998": datetime.datetime(2024, 2, 12, 0, 0), "A'symbol',_''Z__998": 'WPL', "A'open',_'WPL_WA'Z__999": 118.21187852650606, "A'close',_'WPL_WA'Z__999": 114.87920379638672, "A'low',_'WPL_WA'Z__999": 114.87920379638672, "A'high',_'WPL_WA'Z__999": 118.21187852650606, "A'volume',_'WPL_WA'Z__999": 7850, "A'timestamp',_''Z__999": datetime.datetime(2024, 2, 13, 0, 0), "A'symbol',_''Z__999": 'WPL'}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-02-26 22:43:18,029 - historical_importer - INFO - Imported 0 records for WPL
2025-02-26 22:43:19,032 - historical_importer - INFO - Fetching 5 years of data for TEN.WA
2025-02-26 22:43:19,382 - historical_importer - ERROR - Error saving historical data: (psycopg2.errors.UndefinedColumn) column "('open', 'TEN.WA')" of relation "staging_stock_prices" does not exist
LINE 1: ...ck_prices ("('symbol', '')", "('timestamp', '')", "('open', ...
                                                             ^

[SQL: INSERT INTO staging_stock_prices ("('symbol', '')", "('timestamp', '')", "('open', 'TEN.WA')", "('high', 'TEN.WA')", "('low', 'TEN.WA')", "('close', 'TEN.WA')", "('volume', 'TEN.WA')") VALUES (%(A'symbol',_''Z__0)s, %(A'timestamp',_''Z__0)s, %(A'open ... 201070 characters truncated ... A'Z__999)s, %(A'low',_'TEN_WA'Z__999)s, %(A'close',_'TEN_WA'Z__999)s, %(A'volume',_'TEN_WA'Z__999)s)]
[parameters: {"A'high',_'TEN_WA'Z__0": 214.53089778131175, "A'low',_'TEN_WA'Z__0": 190.60245149031928, "A'volume',_'TEN_WA'Z__0": 86080, "A'close',_'TEN_WA'Z__0": 208.75506591796875, "A'timestamp',_''Z__0": datetime.datetime(2020, 2, 28, 0, 0), "A'open',_'TEN_WA'Z__0": 202.97923405462572, "A'symbol',_''Z__0": 'TEN', "A'high',_'TEN_WA'Z__1": 232.6835233161091, "A'low',_'TEN_WA'Z__1": 211.64299195241838, "A'volume',_'TEN_WA'Z__1": 44397, "A'close',_'TEN_WA'Z__1": 222.36953735351562, "A'timestamp',_''Z__1": datetime.datetime(2020, 3, 2, 0, 0), "A'open',_'TEN_WA'Z__1": 231.03328556209414, "A'symbol',_''Z__1": 'TEN', "A'high',_'TEN_WA'Z__2": 251.66123962402344, "A'low',_'TEN_WA'Z__2": 228.55791270771965, "A'volume',_'TEN_WA'Z__2": 90175, "A'close',_'TEN_WA'Z__2": 251.66123962402344, "A'timestamp',_''Z__2": datetime.datetime(2020, 3, 3, 0, 0), "A'open',_'TEN_WA'Z__2": 231.03326916303791, "A'symbol',_''Z__2": 'TEN', "A'high',_'TEN_WA'Z__3": 256.6119600449991, "A'low',_'TEN_WA'Z__3": 237.6342266654654, "A'volume',_'TEN_WA'Z__3": 42199, "A'close',_'TEN_WA'Z__3": 250.42356872558594, "A'timestamp',_''Z__3": datetime.datetime(2020, 3, 4, 0, 0), "A'open',_'TEN_WA'Z__3": 246.71053393393802, "A'symbol',_''Z__3": 'TEN', "A'high',_'TEN_WA'Z__4": 261.5626731005296, "A'low',_'TEN_WA'Z__4": 241.3472614571133, "A'volume',_'TEN_WA'Z__4": 42406, "A'close',_'TEN_WA'Z__4": 250.42356872558594, "A'timestamp',_''Z__4": datetime.datetime(2020, 3, 5, 0, 0), "A'open',_'TEN_WA'Z__4": 258.26219773017596, "A'symbol',_''Z__4": 'TEN', "A'high',_'TEN_WA'Z__5": 247.53564432711903, "A'low',_'TEN_WA'Z__5": 236.39654033239867, "A'volume',_'TEN_WA'Z__5": 30737, "A'close',_'TEN_WA'Z__5": 246.7105255126953, "A'timestamp',_''Z__5": datetime.datetime(2020, 3, 6, 0, 0), "A'open',_'TEN_WA'Z__5": 240.9346938117292, "A'symbol',_''Z__5": 'TEN', "A'high',_'TEN_WA'Z__6": 233.5086281764486, "A'low',_'TEN_WA'Z__6": 208.7550633520901, "A'volume',_'TEN_WA'Z__6": 81180, "A'close',_'TEN_WA'Z__6": 230.62071228027344, "A'timestamp',_''Z__6": datetime.datetime(2020, 3, 9, 0, 0), "A'open',_'TEN_WA'Z__6": 222.78208341922658, "A'symbol',_''Z__6": 'TEN', "A'high',_'TEN_WA'Z__7": 242.58494233737025 ... 6900 parameters truncated ... "A'symbol',_''Z__992": 'TEN', "A'high',_'TEN_WA'Z__993": 103.5, "A'low',_'TEN_WA'Z__993": 101.5, "A'volume',_'TEN_WA'Z__993": 18885, "A'close',_'TEN_WA'Z__993": 101.69999694824219, "A'timestamp',_''Z__993": datetime.datetime(2024, 2, 5, 0, 0), "A'open',_'TEN_WA'Z__993": 103.0, "A'symbol',_''Z__993": 'TEN', "A'high',_'TEN_WA'Z__994": 102.69999694824219, "A'low',_'TEN_WA'Z__994": 97.0, "A'volume',_'TEN_WA'Z__994": 54079, "A'close',_'TEN_WA'Z__994": 98.9000015258789, "A'timestamp',_''Z__994": datetime.datetime(2024, 2, 6, 0, 0), "A'open',_'TEN_WA'Z__994": 101.5, "A'symbol',_''Z__994": 'TEN', "A'high',_'TEN_WA'Z__995": 101.4000015258789, "A'low',_'TEN_WA'Z__995": 97.80000305175781, "A'volume',_'TEN_WA'Z__995": 23424, "A'close',_'TEN_WA'Z__995": 100.0, "A'timestamp',_''Z__995": datetime.datetime(2024, 2, 7, 0, 0), "A'open',_'TEN_WA'Z__995": 97.80000305175781, "A'symbol',_''Z__995": 'TEN', "A'high',_'TEN_WA'Z__996": 104.19999694824219, "A'low',_'TEN_WA'Z__996": 99.9000015258789, "A'volume',_'TEN_WA'Z__996": 41299, "A'close',_'TEN_WA'Z__996": 103.30000305175781, "A'timestamp',_''Z__996": datetime.datetime(2024, 2, 8, 0, 0), "A'open',_'TEN_WA'Z__996": 101.0, "A'symbol',_''Z__996": 'TEN', "A'high',_'TEN_WA'Z__997": 104.80000305175781, "A'low',_'TEN_WA'Z__997": 102.69999694824219, "A'volume',_'TEN_WA'Z__997": 23892, "A'close',_'TEN_WA'Z__997": 103.30000305175781, "A'timestamp',_''Z__997": datetime.datetime(2024, 2, 9, 0, 0), "A'open',_'TEN_WA'Z__997": 103.5, "A'symbol',_''Z__997": 'TEN', "A'high',_'TEN_WA'Z__998": 111.5999984741211, "A'low',_'TEN_WA'Z__998": 105.19999694824219, "A'volume',_'TEN_WA'Z__998": 172085, "A'close',_'TEN_WA'Z__998": 106.30000305175781, "A'timestamp',_''Z__998": datetime.datetime(2024, 2, 12, 0, 0), "A'open',_'TEN_WA'Z__998": 109.0, "A'symbol',_''Z__998": 'TEN', "A'high',_'TEN_WA'Z__999": 108.69999694824219, "A'low',_'TEN_WA'Z__999": 105.80000305175781, "A'volume',_'TEN_WA'Z__999": 28198, "A'close',_'TEN_WA'Z__999": 106.4000015258789, "A'timestamp',_''Z__999": datetime.datetime(2024, 2, 13, 0, 0), "A'open',_'TEN_WA'Z__999": 107.0, "A'symbol',_''Z__999": 'TEN'}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-02-26 22:43:19,382 - historical_importer - INFO - Imported 0 records for TEN
2025-02-26 22:43:20,390 - historical_importer - INFO - Fetching 5 years of data for CCC.WA
2025-02-26 22:43:20,736 - historical_importer - ERROR - Error saving historical data: (psycopg2.errors.UndefinedColumn) column "('open', 'CCC.WA')" of relation "staging_stock_prices" does not exist
LINE 1: ...ck_prices ("('symbol', '')", "('timestamp', '')", "('open', ...
                                                             ^

[SQL: INSERT INTO staging_stock_prices ("('symbol', '')", "('timestamp', '')", "('open', 'CCC.WA')", "('high', 'CCC.WA')", "('low', 'CCC.WA')", "('close', 'CCC.WA')", "('volume', 'CCC.WA')") VALUES (%(A'symbol',_''Z__0)s, %(A'timestamp',_''Z__0)s, %(A'open ... 201070 characters truncated ... A'Z__999)s, %(A'low',_'CCC_WA'Z__999)s, %(A'close',_'CCC_WA'Z__999)s, %(A'volume',_'CCC_WA'Z__999)s)]
[parameters: {"A'close',_'CCC_WA'Z__0": 71.94999694824219, "A'volume',_'CCC_WA'Z__0": 537781, "A'open',_'CCC_WA'Z__0": 75.0, "A'high',_'CCC_WA'Z__0": 77.4000015258789, "A'low',_'CCC_WA'Z__0": 67.55000305175781, "A'timestamp',_''Z__0": datetime.datetime(2020, 2, 28, 0, 0), "A'symbol',_''Z__0": 'CCC', "A'close',_'CCC_WA'Z__1": 71.75, "A'volume',_'CCC_WA'Z__1": 356232, "A'open',_'CCC_WA'Z__1": 74.94999694824219, "A'high',_'CCC_WA'Z__1": 76.1500015258789, "A'low',_'CCC_WA'Z__1": 71.0, "A'timestamp',_''Z__1": datetime.datetime(2020, 3, 2, 0, 0), "A'symbol',_''Z__1": 'CCC', "A'close',_'CCC_WA'Z__2": 78.19999694824219, "A'volume',_'CCC_WA'Z__2": 311972, "A'open',_'CCC_WA'Z__2": 72.8499984741211, "A'high',_'CCC_WA'Z__2": 78.5999984741211, "A'low',_'CCC_WA'Z__2": 72.80000305175781, "A'timestamp',_''Z__2": datetime.datetime(2020, 3, 3, 0, 0), "A'symbol',_''Z__2": 'CCC', "A'close',_'CCC_WA'Z__3": 76.69999694824219, "A'volume',_'CCC_WA'Z__3": 195028, "A'open',_'CCC_WA'Z__3": 77.5999984741211, "A'high',_'CCC_WA'Z__3": 80.55000305175781, "A'low',_'CCC_WA'Z__3": 76.0, "A'timestamp',_''Z__3": datetime.datetime(2020, 3, 4, 0, 0), "A'symbol',_''Z__3": 'CCC', "A'close',_'CCC_WA'Z__4": 74.4000015258789, "A'volume',_'CCC_WA'Z__4": 174558, "A'open',_'CCC_WA'Z__4": 78.5, "A'high',_'CCC_WA'Z__4": 79.30000305175781, "A'low',_'CCC_WA'Z__4": 73.0999984741211, "A'timestamp',_''Z__4": datetime.datetime(2020, 3, 5, 0, 0), "A'symbol',_''Z__4": 'CCC', "A'close',_'CCC_WA'Z__5": 72.30000305175781, "A'volume',_'CCC_WA'Z__5": 261544, "A'open',_'CCC_WA'Z__5": 72.9000015258789, "A'high',_'CCC_WA'Z__5": 74.55000305175781, "A'low',_'CCC_WA'Z__5": 70.0, "A'timestamp',_''Z__5": datetime.datetime(2020, 3, 6, 0, 0), "A'symbol',_''Z__5": 'CCC', "A'close',_'CCC_WA'Z__6": 64.0, "A'volume',_'CCC_WA'Z__6": 310454, "A'open',_'CCC_WA'Z__6": 68.3499984741211, "A'high',_'CCC_WA'Z__6": 70.30000305175781, "A'low',_'CCC_WA'Z__6": 63.0, "A'timestamp',_''Z__6": datetime.datetime(2020, 3, 9, 0, 0), "A'symbol',_''Z__6": 'CCC', "A'close',_'CCC_WA'Z__7": 63.0 ... 6900 parameters truncated ... "A'symbol',_''Z__992": 'CCC', "A'close',_'CCC_WA'Z__993": 57.0, "A'volume',_'CCC_WA'Z__993": 232283, "A'open',_'CCC_WA'Z__993": 59.20000076293945, "A'high',_'CCC_WA'Z__993": 60.439998626708984, "A'low',_'CCC_WA'Z__993": 57.0, "A'timestamp',_''Z__993": datetime.datetime(2024, 2, 5, 0, 0), "A'symbol',_''Z__993": 'CCC', "A'close',_'CCC_WA'Z__994": 57.20000076293945, "A'volume',_'CCC_WA'Z__994": 207584, "A'open',_'CCC_WA'Z__994": 57.02000045776367, "A'high',_'CCC_WA'Z__994": 57.599998474121094, "A'low',_'CCC_WA'Z__994": 56.18000030517578, "A'timestamp',_''Z__994": datetime.datetime(2024, 2, 6, 0, 0), "A'symbol',_''Z__994": 'CCC', "A'close',_'CCC_WA'Z__995": 58.459999084472656, "A'volume',_'CCC_WA'Z__995": 177977, "A'open',_'CCC_WA'Z__995": 57.119998931884766, "A'high',_'CCC_WA'Z__995": 58.599998474121094, "A'low',_'CCC_WA'Z__995": 57.0, "A'timestamp',_''Z__995": datetime.datetime(2024, 2, 7, 0, 0), "A'symbol',_''Z__995": 'CCC', "A'close',_'CCC_WA'Z__996": 59.41999816894531, "A'volume',_'CCC_WA'Z__996": 197604, "A'open',_'CCC_WA'Z__996": 58.779998779296875, "A'high',_'CCC_WA'Z__996": 59.779998779296875, "A'low',_'CCC_WA'Z__996": 58.619998931884766, "A'timestamp',_''Z__996": datetime.datetime(2024, 2, 8, 0, 0), "A'symbol',_''Z__996": 'CCC', "A'close',_'CCC_WA'Z__997": 64.26000213623047, "A'volume',_'CCC_WA'Z__997": 755300, "A'open',_'CCC_WA'Z__997": 61.20000076293945, "A'high',_'CCC_WA'Z__997": 64.30000305175781, "A'low',_'CCC_WA'Z__997": 60.599998474121094, "A'timestamp',_''Z__997": datetime.datetime(2024, 2, 9, 0, 0), "A'symbol',_''Z__997": 'CCC', "A'close',_'CCC_WA'Z__998": 63.97999954223633, "A'volume',_'CCC_WA'Z__998": 408553, "A'open',_'CCC_WA'Z__998": 64.9000015258789, "A'high',_'CCC_WA'Z__998": 65.0, "A'low',_'CCC_WA'Z__998": 62.880001068115234, "A'timestamp',_''Z__998": datetime.datetime(2024, 2, 12, 0, 0), "A'symbol',_''Z__998": 'CCC', "A'close',_'CCC_WA'Z__999": 63.0, "A'volume',_'CCC_WA'Z__999": 371294, "A'open',_'CCC_WA'Z__999": 63.959999084472656, "A'high',_'CCC_WA'Z__999": 64.9000015258789, "A'low',_'CCC_WA'Z__999": 62.20000076293945, "A'timestamp',_''Z__999": datetime.datetime(2024, 2, 13, 0, 0), "A'symbol',_''Z__999": 'CCC'}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-02-26 22:43:20,736 - historical_importer - INFO - Imported 0 records for CCC
2025-02-26 22:43:21,745 - historical_importer - INFO - Fetching 5 years of data for EAT.WA
2025-02-26 22:43:22,137 - historical_importer - ERROR - Error saving historical data: (psycopg2.errors.UndefinedColumn) column "('open', 'EAT.WA')" of relation "staging_stock_prices" does not exist
LINE 1: ...ck_prices ("('symbol', '')", "('timestamp', '')", "('open', ...
                                                             ^

[SQL: INSERT INTO staging_stock_prices ("('symbol', '')", "('timestamp', '')", "('open', 'EAT.WA')", "('high', 'EAT.WA')", "('low', 'EAT.WA')", "('close', 'EAT.WA')", "('volume', 'EAT.WA')") VALUES (%(A'symbol',_''Z__0)s, %(A'timestamp',_''Z__0)s, %(A'open ... 201070 characters truncated ... A'Z__999)s, %(A'low',_'EAT_WA'Z__999)s, %(A'close',_'EAT_WA'Z__999)s, %(A'volume',_'EAT_WA'Z__999)s)]
[parameters: {"A'volume',_'EAT_WA'Z__0": 291058, "A'low',_'EAT_WA'Z__0": 36.815565673025205, "A'close',_'EAT_WA'Z__0": 39.9042854309082, "A'high',_'EAT_WA'Z__0": 39.9042854309082, "A'timestamp',_''Z__0": datetime.datetime(2020, 2, 28, 0, 0), "A'symbol',_''Z__0": 'EAT', "A'open',_'EAT_WA'Z__0": 37.46319849925576, "A'volume',_'EAT_WA'Z__1": 333066, "A'low',_'EAT_WA'Z__1": 37.96138002567821, "A'close',_'EAT_WA'Z__1": 38.75847244262695, "A'high',_'EAT_WA'Z__1": 40.20319389650531, "A'timestamp',_''Z__1": datetime.datetime(2020, 3, 2, 0, 0), "A'symbol',_''Z__1": 'EAT', "A'open',_'EAT_WA'Z__1": 39.80465148884927, "A'volume',_'EAT_WA'Z__2": 224667, "A'low',_'EAT_WA'Z__2": 38.26029135051783, "A'close',_'EAT_WA'Z__2": 39.406105041503906, "A'high',_'EAT_WA'Z__2": 40.10355900169708, "A'timestamp',_''Z__2": datetime.datetime(2020, 3, 3, 0, 0), "A'symbol',_''Z__2": 'EAT', "A'open',_'EAT_WA'Z__2": 38.26029135051783, "A'volume',_'EAT_WA'Z__3": 235434, "A'low',_'EAT_WA'Z__3": 38.55919933838977, "A'close',_'EAT_WA'Z__3": 38.75847244262695, "A'high',_'EAT_WA'Z__3": 40.85083053507158, "A'timestamp',_''Z__3": datetime.datetime(2020, 3, 4, 0, 0), "A'symbol',_''Z__3": 'EAT', "A'open',_'EAT_WA'Z__3": 40.85083053507158, "A'volume',_'EAT_WA'Z__4": 147012, "A'low',_'EAT_WA'Z__4": 38.85810756959511, "A'close',_'EAT_WA'Z__4": 39.05738067626953, "A'high',_'EAT_WA'Z__4": 40.053742408823254, "A'timestamp',_''Z__4": datetime.datetime(2020, 3, 5, 0, 0), "A'symbol',_''Z__4": 'EAT', "A'open',_'EAT_WA'Z__4": 39.705013521938426, "A'volume',_'EAT_WA'Z__5": 296178, "A'low',_'EAT_WA'Z__5": 35.91883829339647, "A'close',_'EAT_WA'Z__5": 36.56647491455078, "A'high',_'EAT_WA'Z__5": 38.35992520283119, "A'timestamp',_''Z__5": datetime.datetime(2020, 3, 6, 0, 0), "A'symbol',_''Z__5": 'EAT', "A'open',_'EAT_WA'Z__5": 38.26029055380048, "A'volume',_'EAT_WA'Z__6": 565436, "A'low',_'EAT_WA'Z__6": 32.48139096118627, "A'close',_'EAT_WA'Z__6": 35.07193374633789, "A'high',_'EAT_WA'Z__6": 35.07193374633789, "A'timestamp',_''Z__6": datetime.datetime(2020, 3, 9, 0, 0), "A'symbol',_''Z__6": 'EAT', "A'open',_'EAT_WA'Z__6": 34.872660639661866, "A'volume',_'EAT_WA'Z__7": 257103 ... 6900 parameters truncated ... "A'open',_'EAT_WA'Z__992": 26.802130941686585, "A'volume',_'EAT_WA'Z__993": 24744, "A'low',_'EAT_WA'Z__993": 25.95522190227622, "A'close',_'EAT_WA'Z__993": 26.40358543395996, "A'high',_'EAT_WA'Z__993": 26.75231241411296, "A'timestamp',_''Z__993": datetime.datetime(2024, 2, 5, 0, 0), "A'symbol',_''Z__993": 'EAT', "A'open',_'EAT_WA'Z__993": 26.75231241411296, "A'volume',_'EAT_WA'Z__994": 37835, "A'low',_'EAT_WA'Z__994": 26.00504251977098, "A'close',_'EAT_WA'Z__994": 26.90176773071289, "A'high',_'EAT_WA'Z__994": 26.90176773071289, "A'timestamp',_''Z__994": datetime.datetime(2024, 2, 6, 0, 0), "A'symbol',_''Z__994": 'EAT', "A'open',_'EAT_WA'Z__994": 26.503223403673072, "A'volume',_'EAT_WA'Z__995": 32404, "A'low',_'EAT_WA'Z__995": 26.453403714176044, "A'close',_'EAT_WA'Z__995": 26.602859497070312, "A'high',_'EAT_WA'Z__995": 27.051221144525453, "A'timestamp',_''Z__995": datetime.datetime(2024, 2, 7, 0, 0), "A'symbol',_''Z__995": 'EAT', "A'open',_'EAT_WA'Z__995": 26.851949934681798, "A'volume',_'EAT_WA'Z__996": 30212, "A'low',_'EAT_WA'Z__996": 26.453404175037306, "A'close',_'EAT_WA'Z__996": 26.90176773071289, "A'high',_'EAT_WA'Z__996": 26.90176773071289, "A'timestamp',_''Z__996": datetime.datetime(2024, 2, 8, 0, 0), "A'symbol',_''Z__996": 'EAT', "A'open',_'EAT_WA'Z__996": 26.55304073189958, "A'volume',_'EAT_WA'Z__997": 23936, "A'low',_'EAT_WA'Z__997": 26.20431233089849, "A'close',_'EAT_WA'Z__997": 26.40358543395996, "A'high',_'EAT_WA'Z__997": 26.90176629120449, "A'timestamp',_''Z__997": datetime.datetime(2024, 2, 9, 0, 0), "A'symbol',_''Z__997": 'EAT', "A'open',_'EAT_WA'Z__997": 26.90176629120449, "A'volume',_'EAT_WA'Z__998": 75344, "A'low',_'EAT_WA'Z__998": 26.254131568083395, "A'close',_'EAT_WA'Z__998": 27.200674057006836, "A'high',_'EAT_WA'Z__998": 27.399947160153435, "A'timestamp',_''Z__998": datetime.datetime(2024, 2, 12, 0, 0), "A'symbol',_''Z__998": 'EAT', "A'open',_'EAT_WA'Z__998": 26.60285854838536, "A'volume',_'EAT_WA'Z__999": 74470, "A'low',_'EAT_WA'Z__999": 27.051221600426857, "A'close',_'EAT_WA'Z__999": 27.300312042236328, "A'high',_'EAT_WA'Z__999": 27.898129482660913, "A'timestamp',_''Z__999": datetime.datetime(2024, 2, 13, 0, 0), "A'symbol',_''Z__999": 'EAT', "A'open',_'EAT_WA'Z__999": 27.200675485430686}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-02-26 22:43:22,138 - historical_importer - INFO - Imported 0 records for EAT
2025-02-26 22:43:23,145 - historical_importer - INFO - Fetching 5 years of data for OPF.WA
2025-02-26 22:43:25,568 - yfinance - ERROR - 
1 Failed download:
2025-02-26 22:43:25,571 - yfinance - ERROR - ['OPF.WA']: YFTzMissingError('possibly delisted; no timezone found')
2025-02-26 22:43:25,579 - historical_importer - WARNING - No data retrieved for OPF
2025-02-26 22:43:25,580 - historical_importer - INFO - Imported 0 records for OPF
2025-02-26 22:43:26,584 - historical_importer - INFO - Fetching 5 years of data for MRC.WA
2025-02-26 22:43:26,969 - historical_importer - ERROR - Error saving historical data: (psycopg2.errors.UndefinedColumn) column "('open', 'MRC.WA')" of relation "staging_stock_prices" does not exist
LINE 1: ...ck_prices ("('symbol', '')", "('timestamp', '')", "('open', ...
                                                             ^

[SQL: INSERT INTO staging_stock_prices ("('symbol', '')", "('timestamp', '')", "('open', 'MRC.WA')", "('high', 'MRC.WA')", "('low', 'MRC.WA')", "('close', 'MRC.WA')", "('volume', 'MRC.WA')") VALUES (%(A'symbol',_''Z__0)s, %(A'timestamp',_''Z__0)s, %(A'open ... 201070 characters truncated ... A'Z__999)s, %(A'low',_'MRC_WA'Z__999)s, %(A'close',_'MRC_WA'Z__999)s, %(A'volume',_'MRC_WA'Z__999)s)]
[parameters: {"A'low',_'MRC_WA'Z__0": 17.841008837849653, "A'volume',_'MRC_WA'Z__0": 1058012, "A'high',_'MRC_WA'Z__0": 20.6580102332996, "A'close',_'MRC_WA'Z__0": 19.155609130859375, "A'timestamp',_''Z__0": datetime.datetime(2020, 2, 28, 0, 0), "A'symbol',_''Z__0": 'MRC', "A'open',_'MRC_WA'Z__0": 19.719009768149615, "A'low',_'MRC_WA'Z__1": 15.624967185955885, "A'volume',_'MRC_WA'Z__1": 427829, "A'high',_'MRC_WA'Z__1": 19.249509558958167, "A'close',_'MRC_WA'Z__1": 15.963007926940918, "A'timestamp',_''Z__1": datetime.datetime(2020, 3, 2, 0, 0), "A'symbol',_''Z__1": 'MRC', "A'open',_'MRC_WA'Z__1": 19.249509558958167, "A'low',_'MRC_WA'Z__2": 14.460605746711265, "A'volume',_'MRC_WA'Z__2": 420510, "A'high',_'MRC_WA'Z__2": 17.10858657806345, "A'close',_'MRC_WA'Z__2": 16.169586181640625, "A'timestamp',_''Z__2": datetime.datetime(2020, 3, 3, 0, 0), "A'symbol',_''Z__2": 'MRC', "A'open',_'MRC_WA'Z__2": 16.338606539556913, "A'low',_'MRC_WA'Z__3": 16.488848812616236, "A'volume',_'MRC_WA'Z__3": 518658, "A'high',_'MRC_WA'Z__3": 18.498311165586397, "A'close',_'MRC_WA'Z__3": 17.014690399169922, "A'timestamp',_''Z__3": datetime.datetime(2020, 3, 4, 0, 0), "A'symbol',_''Z__3": 'MRC', "A'open',_'MRC_WA'Z__3": 17.84101007789498, "A'low',_'MRC_WA'Z__4": 16.169586777662143, "A'volume',_'MRC_WA'Z__4": 125761, "A'high',_'MRC_WA'Z__4": 17.146148085619107, "A'close',_'MRC_WA'Z__4": 16.657867431640625, "A'timestamp',_''Z__4": datetime.datetime(2020, 3, 5, 0, 0), "A'symbol',_''Z__4": 'MRC', "A'open',_'MRC_WA'Z__4": 16.939568635551836, "A'low',_'MRC_WA'Z__5": 14.667186860680285, "A'volume',_'MRC_WA'Z__5": 316817, "A'high',_'MRC_WA'Z__5": 17.164928799536735, "A'close',_'MRC_WA'Z__5": 15.268147468566895, "A'timestamp',_''Z__5": datetime.datetime(2020, 3, 6, 0, 0), "A'symbol',_''Z__5": 'MRC', "A'open',_'MRC_WA'Z__5": 16.826888065819, "A'low',_'MRC_WA'Z__6": 11.023864868853941, "A'volume',_'MRC_WA'Z__6": 454792, "A'high',_'MRC_WA'Z__6": 15.024006928482569, "A'close',_'MRC_WA'Z__6": 11.549705505371094, "A'timestamp',_''Z__6": datetime.datetime(2020, 3, 9, 0, 0), "A'symbol',_''Z__6": 'MRC', "A'open',_'MRC_WA'Z__6": 15.024006928482569, "A'low',_'MRC_WA'Z__7": 11.831405041803846 ... 6900 parameters truncated ... "A'open',_'MRC_WA'Z__992": 44.5, "A'low',_'MRC_WA'Z__993": 44.439998626708984, "A'volume',_'MRC_WA'Z__993": 8404, "A'high',_'MRC_WA'Z__993": 45.099998474121094, "A'close',_'MRC_WA'Z__993": 44.900001525878906, "A'timestamp',_''Z__993": datetime.datetime(2024, 2, 5, 0, 0), "A'symbol',_''Z__993": 'MRC', "A'open',_'MRC_WA'Z__993": 44.97999954223633, "A'low',_'MRC_WA'Z__994": 44.5, "A'volume',_'MRC_WA'Z__994": 7740, "A'high',_'MRC_WA'Z__994": 45.779998779296875, "A'close',_'MRC_WA'Z__994": 45.599998474121094, "A'timestamp',_''Z__994": datetime.datetime(2024, 2, 6, 0, 0), "A'symbol',_''Z__994": 'MRC', "A'open',_'MRC_WA'Z__994": 44.880001068115234, "A'low',_'MRC_WA'Z__995": 45.18000030517578, "A'volume',_'MRC_WA'Z__995": 3406, "A'high',_'MRC_WA'Z__995": 45.70000076293945, "A'close',_'MRC_WA'Z__995": 45.560001373291016, "A'timestamp',_''Z__995": datetime.datetime(2024, 2, 7, 0, 0), "A'symbol',_''Z__995": 'MRC', "A'open',_'MRC_WA'Z__995": 45.70000076293945, "A'low',_'MRC_WA'Z__996": 44.91999816894531, "A'volume',_'MRC_WA'Z__996": 1858, "A'high',_'MRC_WA'Z__996": 45.540000915527344, "A'close',_'MRC_WA'Z__996": 45.0, "A'timestamp',_''Z__996": datetime.datetime(2024, 2, 8, 0, 0), "A'symbol',_''Z__996": 'MRC', "A'open',_'MRC_WA'Z__996": 45.540000915527344, "A'low',_'MRC_WA'Z__997": 44.65999984741211, "A'volume',_'MRC_WA'Z__997": 1299, "A'high',_'MRC_WA'Z__997": 45.31999969482422, "A'close',_'MRC_WA'Z__997": 44.86000061035156, "A'timestamp',_''Z__997": datetime.datetime(2024, 2, 9, 0, 0), "A'symbol',_''Z__997": 'MRC', "A'open',_'MRC_WA'Z__997": 44.7599983215332, "A'low',_'MRC_WA'Z__998": 43.279998779296875, "A'volume',_'MRC_WA'Z__998": 8229, "A'high',_'MRC_WA'Z__998": 45.15999984741211, "A'close',_'MRC_WA'Z__998": 43.58000183105469, "A'timestamp',_''Z__998": datetime.datetime(2024, 2, 12, 0, 0), "A'symbol',_''Z__998": 'MRC', "A'open',_'MRC_WA'Z__998": 44.41999816894531, "A'low',_'MRC_WA'Z__999": 43.20000076293945, "A'volume',_'MRC_WA'Z__999": 12455, "A'high',_'MRC_WA'Z__999": 45.459999084472656, "A'close',_'MRC_WA'Z__999": 45.380001068115234, "A'timestamp',_''Z__999": datetime.datetime(2024, 2, 13, 0, 0), "A'symbol',_''Z__999": 'MRC', "A'open',_'MRC_WA'Z__999": 43.29999923706055}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-02-26 22:43:26,969 - historical_importer - INFO - Imported 0 records for MRC
2025-02-26 22:43:27,979 - historical_importer - INFO - Completed historical data import. Processed 0 records for 24 symbols
2025-02-26 22:53:51,983 - historical_importer - INFO - Starting historical data import
2025-02-26 22:53:52,025 - historical_importer - INFO - Importing 5 years of historical data
2025-02-26 22:53:52,037 - historical_importer - INFO - Fetching 5 years of data for PKO.WA
2025-02-26 22:53:53,161 - historical_importer - ERROR - Missing columns in data: {'symbol', 'low', 'timestamp', 'volume', 'open', 'close', 'high'}
2025-02-26 22:53:53,162 - historical_importer - ERROR - Available columns: [('timestamp', ''), ('close', 'PKO.WA'), ('high', 'PKO.WA'), ('low', 'PKO.WA'), ('open', 'PKO.WA'), ('volume', 'PKO.WA'), ('symbol', '')]
2025-02-26 22:53:53,162 - historical_importer - INFO - Imported 0 records for PKO
2025-02-26 22:53:54,177 - historical_importer - INFO - Fetching 5 years of data for PKN.WA
2025-02-26 22:53:54,627 - historical_importer - ERROR - Missing columns in data: {'symbol', 'low', 'timestamp', 'volume', 'open', 'close', 'high'}
2025-02-26 22:53:54,630 - historical_importer - ERROR - Available columns: [('timestamp', ''), ('close', 'PKN.WA'), ('high', 'PKN.WA'), ('low', 'PKN.WA'), ('open', 'PKN.WA'), ('volume', 'PKN.WA'), ('symbol', '')]
2025-02-26 22:53:54,631 - historical_importer - INFO - Imported 0 records for PKN
2025-02-26 22:53:55,637 - historical_importer - INFO - Fetching 5 years of data for PZU.WA
2025-02-26 22:53:55,931 - historical_importer - ERROR - Missing columns in data: {'symbol', 'low', 'timestamp', 'volume', 'open', 'close', 'high'}
2025-02-26 22:53:55,931 - historical_importer - ERROR - Available columns: [('timestamp', ''), ('close', 'PZU.WA'), ('high', 'PZU.WA'), ('low', 'PZU.WA'), ('open', 'PZU.WA'), ('volume', 'PZU.WA'), ('symbol', '')]
2025-02-26 22:53:55,931 - historical_importer - INFO - Imported 0 records for PZU
2025-02-26 22:53:56,952 - historical_importer - INFO - Fetching 5 years of data for PEO.WA
2025-02-26 22:53:59,853 - historical_importer - ERROR - Missing columns in data: {'symbol', 'low', 'timestamp', 'volume', 'open', 'close', 'high'}
2025-02-26 22:53:59,855 - historical_importer - ERROR - Available columns: [('timestamp', ''), ('close', 'PEO.WA'), ('high', 'PEO.WA'), ('low', 'PEO.WA'), ('open', 'PEO.WA'), ('volume', 'PEO.WA'), ('symbol', '')]
2025-02-26 22:53:59,855 - historical_importer - INFO - Imported 0 records for PEO
2025-02-26 22:54:00,864 - historical_importer - INFO - Fetching 5 years of data for DNP.WA
2025-02-26 22:54:01,117 - historical_importer - ERROR - Missing columns in data: {'symbol', 'low', 'timestamp', 'volume', 'open', 'close', 'high'}
2025-02-26 22:54:01,118 - historical_importer - ERROR - Available columns: [('timestamp', ''), ('close', 'DNP.WA'), ('high', 'DNP.WA'), ('low', 'DNP.WA'), ('open', 'DNP.WA'), ('volume', 'DNP.WA'), ('symbol', '')]
2025-02-26 22:54:01,118 - historical_importer - INFO - Imported 0 records for DNP
2025-02-26 22:54:02,122 - historical_importer - INFO - Fetching 5 years of data for SPL.WA
2025-02-26 22:54:02,417 - historical_importer - ERROR - Missing columns in data: {'symbol', 'low', 'timestamp', 'volume', 'open', 'close', 'high'}
2025-02-26 22:54:02,417 - historical_importer - ERROR - Available columns: [('timestamp', ''), ('close', 'SPL.WA'), ('high', 'SPL.WA'), ('low', 'SPL.WA'), ('open', 'SPL.WA'), ('volume', 'SPL.WA'), ('symbol', '')]
2025-02-26 22:54:02,417 - historical_importer - INFO - Imported 0 records for SPL
2025-02-26 22:54:03,421 - historical_importer - INFO - Fetching 5 years of data for KGH.WA
2025-02-26 22:54:03,746 - historical_importer - ERROR - Missing columns in data: {'symbol', 'low', 'timestamp', 'volume', 'open', 'close', 'high'}
2025-02-26 22:54:03,746 - historical_importer - ERROR - Available columns: [('timestamp', ''), ('close', 'KGH.WA'), ('high', 'KGH.WA'), ('low', 'KGH.WA'), ('open', 'KGH.WA'), ('volume', 'KGH.WA'), ('symbol', '')]
2025-02-26 22:54:03,746 - historical_importer - INFO - Imported 0 records for KGH
2025-02-26 22:54:04,750 - historical_importer - INFO - Fetching 5 years of data for LPP.WA
2025-02-26 22:54:05,037 - historical_importer - ERROR - Missing columns in data: {'symbol', 'low', 'timestamp', 'volume', 'open', 'close', 'high'}
2025-02-26 22:54:05,037 - historical_importer - ERROR - Available columns: [('timestamp', ''), ('close', 'LPP.WA'), ('high', 'LPP.WA'), ('low', 'LPP.WA'), ('open', 'LPP.WA'), ('volume', 'LPP.WA'), ('symbol', '')]
2025-02-26 22:54:05,037 - historical_importer - INFO - Imported 0 records for LPP
2025-02-26 22:54:06,048 - historical_importer - INFO - Fetching 5 years of data for ALE.WA
2025-02-26 22:54:06,367 - historical_importer - ERROR - Missing columns in data: {'symbol', 'low', 'timestamp', 'volume', 'open', 'close', 'high'}
2025-02-26 22:54:06,368 - historical_importer - ERROR - Available columns: [('timestamp', ''), ('close', 'ALE.WA'), ('high', 'ALE.WA'), ('low', 'ALE.WA'), ('open', 'ALE.WA'), ('volume', 'ALE.WA'), ('symbol', '')]
2025-02-26 22:54:06,368 - historical_importer - INFO - Imported 0 records for ALE
2025-02-26 22:54:07,375 - historical_importer - INFO - Fetching 5 years of data for CPS.WA
2025-02-26 22:54:07,665 - historical_importer - ERROR - Missing columns in data: {'symbol', 'low', 'timestamp', 'volume', 'open', 'close', 'high'}
2025-02-26 22:54:07,665 - historical_importer - ERROR - Available columns: [('timestamp', ''), ('close', 'CPS.WA'), ('high', 'CPS.WA'), ('low', 'CPS.WA'), ('open', 'CPS.WA'), ('volume', 'CPS.WA'), ('symbol', '')]
2025-02-26 22:54:07,666 - historical_importer - INFO - Imported 0 records for CPS
2025-02-26 22:54:08,671 - historical_importer - INFO - Fetching 5 years of data for CDR.WA
2025-02-26 22:54:09,025 - historical_importer - ERROR - Missing columns in data: {'symbol', 'low', 'timestamp', 'volume', 'open', 'close', 'high'}
2025-02-26 22:54:09,026 - historical_importer - ERROR - Available columns: [('timestamp', ''), ('close', 'CDR.WA'), ('high', 'CDR.WA'), ('low', 'CDR.WA'), ('open', 'CDR.WA'), ('volume', 'CDR.WA'), ('symbol', '')]
2025-02-26 22:54:09,026 - historical_importer - INFO - Imported 0 records for CDR
2025-02-26 22:54:10,028 - historical_importer - INFO - Fetching 5 years of data for MBK.WA
2025-02-26 22:54:10,294 - historical_importer - ERROR - Missing columns in data: {'symbol', 'low', 'timestamp', 'volume', 'open', 'close', 'high'}
2025-02-26 22:54:10,294 - historical_importer - ERROR - Available columns: [('timestamp', ''), ('close', 'MBK.WA'), ('high', 'MBK.WA'), ('low', 'MBK.WA'), ('open', 'MBK.WA'), ('volume', 'MBK.WA'), ('symbol', '')]
2025-02-26 22:54:10,294 - historical_importer - INFO - Imported 0 records for MBK
2025-02-26 22:54:11,302 - historical_importer - INFO - Fetching 5 years of data for OPL.WA
2025-02-26 22:54:11,602 - historical_importer - ERROR - Missing columns in data: {'symbol', 'low', 'timestamp', 'volume', 'open', 'close', 'high'}
2025-02-26 22:54:11,603 - historical_importer - ERROR - Available columns: [('timestamp', ''), ('close', 'OPL.WA'), ('high', 'OPL.WA'), ('low', 'OPL.WA'), ('open', 'OPL.WA'), ('volume', 'OPL.WA'), ('symbol', '')]
2025-02-26 22:54:11,603 - historical_importer - INFO - Imported 0 records for OPL
2025-02-26 22:54:12,607 - historical_importer - INFO - Fetching 5 years of data for MIL.WA
2025-02-26 22:54:12,881 - historical_importer - ERROR - Missing columns in data: {'symbol', 'low', 'timestamp', 'volume', 'open', 'close', 'high'}
2025-02-26 22:54:12,882 - historical_importer - ERROR - Available columns: [('timestamp', ''), ('close', 'MIL.WA'), ('high', 'MIL.WA'), ('low', 'MIL.WA'), ('open', 'MIL.WA'), ('volume', 'MIL.WA'), ('symbol', '')]
2025-02-26 22:54:12,882 - historical_importer - INFO - Imported 0 records for MIL
2025-02-26 22:54:13,889 - historical_importer - INFO - Fetching 5 years of data for KRU.WA
2025-02-26 22:54:14,172 - historical_importer - ERROR - Missing columns in data: {'symbol', 'low', 'timestamp', 'volume', 'open', 'close', 'high'}
2025-02-26 22:54:14,172 - historical_importer - ERROR - Available columns: [('timestamp', ''), ('close', 'KRU.WA'), ('high', 'KRU.WA'), ('low', 'KRU.WA'), ('open', 'KRU.WA'), ('volume', 'KRU.WA'), ('symbol', '')]
2025-02-26 22:54:14,173 - historical_importer - INFO - Imported 0 records for KRU
2025-02-26 22:54:15,177 - historical_importer - INFO - Fetching 5 years of data for BDX.WA
2025-02-26 22:54:15,434 - historical_importer - ERROR - Missing columns in data: {'symbol', 'low', 'timestamp', 'volume', 'open', 'close', 'high'}
2025-02-26 22:54:15,435 - historical_importer - ERROR - Available columns: [('timestamp', ''), ('close', 'BDX.WA'), ('high', 'BDX.WA'), ('low', 'BDX.WA'), ('open', 'BDX.WA'), ('volume', 'BDX.WA'), ('symbol', '')]
2025-02-26 22:54:15,435 - historical_importer - INFO - Imported 0 records for BDX
2025-02-26 22:54:16,447 - historical_importer - INFO - Fetching 5 years of data for PLY.WA
2025-02-26 22:54:16,652 - yfinance - ERROR - 
1 Failed download:
2025-02-26 22:54:16,652 - yfinance - ERROR - ['PLY.WA']: ValueError('Length mismatch: Expected axis has 2 elements, new values have 1 elements')
2025-02-26 22:54:16,656 - historical_importer - WARNING - No data retrieved for PLY
2025-02-26 22:54:16,656 - historical_importer - INFO - Imported 0 records for PLY
2025-02-26 22:54:17,664 - historical_importer - INFO - Fetching 5 years of data for JSW.WA
2025-02-26 22:54:17,897 - historical_importer - ERROR - Missing columns in data: {'symbol', 'low', 'timestamp', 'volume', 'open', 'close', 'high'}
2025-02-26 22:54:17,898 - historical_importer - ERROR - Available columns: [('timestamp', ''), ('close', 'JSW.WA'), ('high', 'JSW.WA'), ('low', 'JSW.WA'), ('open', 'JSW.WA'), ('volume', 'JSW.WA'), ('symbol', '')]
2025-02-26 22:54:17,898 - historical_importer - INFO - Imported 0 records for JSW
2025-02-26 22:54:18,905 - historical_importer - INFO - Fetching 5 years of data for WPL.WA
2025-02-26 22:54:19,175 - historical_importer - ERROR - Missing columns in data: {'symbol', 'low', 'timestamp', 'volume', 'open', 'close', 'high'}
2025-02-26 22:54:19,175 - historical_importer - ERROR - Available columns: [('timestamp', ''), ('close', 'WPL.WA'), ('high', 'WPL.WA'), ('low', 'WPL.WA'), ('open', 'WPL.WA'), ('volume', 'WPL.WA'), ('symbol', '')]
2025-02-26 22:54:19,175 - historical_importer - INFO - Imported 0 records for WPL
2025-02-26 22:54:20,176 - historical_importer - INFO - Fetching 5 years of data for TEN.WA
2025-02-26 22:54:20,399 - historical_importer - ERROR - Missing columns in data: {'symbol', 'low', 'timestamp', 'volume', 'open', 'close', 'high'}
2025-02-26 22:54:20,399 - historical_importer - ERROR - Available columns: [('timestamp', ''), ('close', 'TEN.WA'), ('high', 'TEN.WA'), ('low', 'TEN.WA'), ('open', 'TEN.WA'), ('volume', 'TEN.WA'), ('symbol', '')]
2025-02-26 22:54:20,400 - historical_importer - INFO - Imported 0 records for TEN
2025-02-26 22:54:21,403 - historical_importer - INFO - Fetching 5 years of data for CCC.WA
2025-02-26 22:54:21,663 - historical_importer - ERROR - Missing columns in data: {'symbol', 'low', 'timestamp', 'volume', 'open', 'close', 'high'}
2025-02-26 22:54:21,664 - historical_importer - ERROR - Available columns: [('timestamp', ''), ('close', 'CCC.WA'), ('high', 'CCC.WA'), ('low', 'CCC.WA'), ('open', 'CCC.WA'), ('volume', 'CCC.WA'), ('symbol', '')]
2025-02-26 22:54:21,664 - historical_importer - INFO - Imported 0 records for CCC
2025-02-26 22:54:22,668 - historical_importer - INFO - Fetching 5 years of data for EAT.WA
2025-02-26 22:54:22,966 - historical_importer - ERROR - Missing columns in data: {'symbol', 'low', 'timestamp', 'volume', 'open', 'close', 'high'}
2025-02-26 22:54:22,967 - historical_importer - ERROR - Available columns: [('timestamp', ''), ('close', 'EAT.WA'), ('high', 'EAT.WA'), ('low', 'EAT.WA'), ('open', 'EAT.WA'), ('volume', 'EAT.WA'), ('symbol', '')]
2025-02-26 22:54:22,967 - historical_importer - INFO - Imported 0 records for EAT
2025-02-26 22:54:23,974 - historical_importer - INFO - Fetching 5 years of data for OPF.WA
2025-02-26 22:54:26,257 - yfinance - ERROR - 
1 Failed download:
2025-02-26 22:54:26,257 - yfinance - ERROR - ['OPF.WA']: YFTzMissingError('possibly delisted; no timezone found')
2025-02-26 22:54:26,262 - historical_importer - WARNING - No data retrieved for OPF
2025-02-26 22:54:26,262 - historical_importer - INFO - Imported 0 records for OPF
2025-02-26 22:54:27,269 - historical_importer - INFO - Fetching 5 years of data for MRC.WA
2025-02-26 22:54:27,570 - historical_importer - ERROR - Missing columns in data: {'symbol', 'low', 'timestamp', 'volume', 'open', 'close', 'high'}
2025-02-26 22:54:27,570 - historical_importer - ERROR - Available columns: [('timestamp', ''), ('close', 'MRC.WA'), ('high', 'MRC.WA'), ('low', 'MRC.WA'), ('open', 'MRC.WA'), ('volume', 'MRC.WA'), ('symbol', '')]
2025-02-26 22:54:27,570 - historical_importer - INFO - Imported 0 records for MRC
2025-02-26 22:54:28,579 - historical_importer - INFO - Completed historical data import. Processed 0 records for 24 symbols
2025-02-26 23:00:37,142 - historical_importer - INFO - Starting historical data import
2025-02-26 23:00:37,176 - historical_importer - INFO - Importing 5 years of historical data
2025-02-26 23:00:37,188 - historical_importer - INFO - Fetching 5 years of data for PKO.WA
2025-02-26 23:00:38,331 - historical_importer - ERROR - Error saving historical data: (psycopg2.errors.UndefinedColumn) column "symbol" of relation "staging_stock_prices" does not exist
LINE 1: INSERT INTO staging_stock_prices (symbol, timestamp, open, h...
                                          ^

[SQL: INSERT INTO staging_stock_prices (symbol, timestamp, open, high, low, close, volume) VALUES (%(symbol__0)s, %(timestamp__0)s, %(open__0)s, %(high__0)s, %(low__0)s, %(close__0)s, %(volume__0)s), (%(symbol__1)s, %(timestamp__1)s, %(open__1)s, %(high__1 ... 10570 characters truncated ... ol__99)s, %(timestamp__99)s, %(open__99)s, %(high__99)s, %(low__99)s, %(close__99)s, %(volume__99)s)]
[parameters: {'high__0': 27.646614637774515, 'close__0': 26.98261260986328, 'open__0': 27.249937482156174, 'low__0': 26.378974103619864, 'volume__0': 5575049, 'symbol__0': 'PKO', 'timestamp__0': datetime.datetime(2020, 2, 28, 0, 0), 'high__1': 28.06915898133804, 'close__1': 27.896690368652344, 'open__1': 27.879446467992434, 'low__1': 27.00848145423398, 'volume__1': 3913456, 'symbol__1': 'PKO', 'timestamp__1': datetime.datetime(2020, 3, 2, 0, 0), 'high__2': 29.129834957990848, 'close__2': 28.54344367980957, 'open__2': 28.1553934338774, 'low__2': 28.06915748734192, 'volume__2': 4036412, 'symbol__2': 'PKO', 'timestamp__2': datetime.datetime(2020, 3, 3, 0, 0), 'high__3': 28.767654730130143, 'close__3': 28.077783584594727, 'open__3': 28.45721189224793, 'low__3': 28.034663965227118, 'volume__3': 2754026, 'symbol__3': 'PKO', 'timestamp__3': datetime.datetime(2020, 3, 4, 0, 0), 'high__4': 28.508953723090908, 'close__4': 27.2844295501709, 'open__4': 28.241627212560626, 'low__4': 27.2844295501709, 'volume__4': 2759371, 'symbol__4': 'PKO', 'timestamp__4': datetime.datetime(2020, 3, 5, 0, 0), 'high__5': 27.344793113143254, 'close__5': 26.404844284057617, 'open__5': 27.01710472669297, 'low__5': 26.189259343166423, 'volume__5': 2964149, 'symbol__5': 'PKO', 'timestamp__5': datetime.datetime(2020, 3, 6, 0, 0), 'high__6': 25.40452949802477, 'close__6': 23.9040584564209, 'open__6': 25.007853982963084, 'low__6': 23.671227962476383, 'volume__6': 3523517, 'symbol__6': 'PKO', 'timestamp__6': datetime.datetime(2020, 3, 9, 0, 0), 'high__7': 24.800892186174934 ... 600 parameters truncated ... 'timestamp__92': datetime.datetime(2020, 7, 7, 0, 0), 'high__93': 20.135634885533957, 'close__93': 20.109764099121094, 'open__93': 19.945919074738278, 'low__93': 19.773452099667168, 'volume__93': 1671837, 'symbol__93': 'PKO', 'timestamp__93': datetime.datetime(2020, 7, 8, 0, 0), 'high__94': 20.29947775177153, 'close__94': 20.083892822265625, 'open__94': 20.135632744807946, 'low__94': 19.9804113323985, 'volume__94': 1839308, 'symbol__94': 'PKO', 'timestamp__94': datetime.datetime(2020, 7, 9, 0, 0), 'high__95': 20.3080997467041, 'close__95': 20.3080997467041, 'open__95': 19.842437153222704, 'low__95': 19.842437153222704, 'volume__95': 1670974, 'symbol__95': 'PKO', 'timestamp__95': datetime.datetime(2020, 7, 10, 0, 0), 'high__96': 20.566804127371885, 'close__96': 20.446075439453125, 'open__96': 20.523686151407112, 'low__96': 20.26498487474889, 'volume__96': 2225157, 'symbol__96': 'PKO', 'timestamp__96': datetime.datetime(2020, 7, 13, 0, 0), 'high__97': 20.44607421319586, 'close__97': 20.27360725402832, 'open__97': 20.264983659352566, 'low__97': 20.083893105509272, 'volume__97': 3154135, 'symbol__97': 'PKO', 'timestamp__97': datetime.datetime(2020, 7, 14, 0, 0), 'high__98': 20.834127645726525, 'close__98': 20.765140533447266, 'open__98': 20.437452161316404, 'low__98': 20.204620040580465, 'volume__98': 3341765, 'symbol__98': 'PKO', 'timestamp__98': datetime.datetime(2020, 7, 15, 0, 0), 'high__99': 20.704778404247502, 'close__99': 20.609920501708984, 'open__99': 20.627167692131007, 'low__99': 20.420206341414556, 'volume__99': 1764162, 'symbol__99': 'PKO', 'timestamp__99': datetime.datetime(2020, 7, 16, 0, 0)}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-02-26 23:00:38,332 - historical_importer - ERROR - Data columns: [('Date', ''), ('Close', 'PKO.WA'), ('High', 'PKO.WA'), ('Low', 'PKO.WA'), ('Open', 'PKO.WA'), ('Volume', 'PKO.WA'), ('symbol', '')]
2025-02-26 23:00:38,333 - historical_importer - ERROR - Data types: Price   Ticker
Date              datetime64[ns]
Close   PKO.WA           float64
High    PKO.WA           float64
Low     PKO.WA           float64
Open    PKO.WA           float64
Volume  PKO.WA             int64
symbol                    object
dtype: object
2025-02-26 23:00:38,333 - historical_importer - INFO - Imported 0 records for PKO
2025-02-26 23:00:39,346 - historical_importer - INFO - Fetching 5 years of data for PKN.WA
2025-02-26 23:00:39,754 - historical_importer - ERROR - Error saving historical data: (psycopg2.errors.UndefinedColumn) column "symbol" of relation "staging_stock_prices" does not exist
LINE 1: INSERT INTO staging_stock_prices (symbol, timestamp, open, h...
                                          ^

[SQL: INSERT INTO staging_stock_prices (symbol, timestamp, open, high, low, close, volume) VALUES (%(symbol__0)s, %(timestamp__0)s, %(open__0)s, %(high__0)s, %(low__0)s, %(close__0)s, %(volume__0)s), (%(symbol__1)s, %(timestamp__1)s, %(open__1)s, %(high__1 ... 10570 characters truncated ... ol__99)s, %(timestamp__99)s, %(open__99)s, %(high__99)s, %(low__99)s, %(close__99)s, %(volume__99)s)]
[parameters: {'high__0': 45.81168715400911, 'close__0': 44.953102111816406, 'open__0': 45.61237386583663, 'low__0': 42.193363014034006, 'volume__0': 3039912, 'symbol__0': 'PKN', 'timestamp__0': datetime.datetime(2020, 2, 28, 0, 0), 'high__1': 47.68217944213285, 'close__1': 46.424964904785156, 'open__1': 47.14556269649454, 'low__1': 45.658370389394996, 'volume__1': 2037669, 'symbol__1': 'PKN', 'timestamp__1': datetime.datetime(2020, 3, 2, 0, 0), 'high__2': 48.14213403424868, 'close__2': 47.728172302246094, 'open__2': 47.37553953394432, 'low__2': 46.470957789639094, 'volume__2': 1804094, 'symbol__2': 'PKN', 'timestamp__2': datetime.datetime(2020, 3, 3, 0, 0), 'high__3': 47.52885788715139, 'close__3': 45.25973892211914, 'open__3': 47.52885788715139, 'low__3': 45.25973892211914, 'volume__3': 1696461, 'symbol__3': 'PKN', 'timestamp__3': datetime.datetime(2020, 3, 4, 0, 0), 'high__4': 46.455627756167296, 'close__4': 43.588565826416016, 'open__4': 46.30231118828197, 'low__4': 43.358588050261936, 'volume__4': 1742634, 'symbol__4': 'PKN', 'timestamp__4': datetime.datetime(2020, 3, 5, 0, 0), 'high__5': 43.312589940052256, 'close__5': 41.65674591064453, 'open__5': 43.128605970417624, 'low__5': 41.0281386445757, 'volume__5': 1785479, 'symbol__5': 'PKN', 'timestamp__5': datetime.datetime(2020, 3, 6, 0, 0), 'high__6': 43.02128126686036, 'close__6': 41.58008575439453, 'open__6': 38.32972388245866, 'low__6': 37.77777492276698, 'volume__6': 3127163, 'symbol__6': 'PKN', 'timestamp__6': datetime.datetime(2020, 3, 9, 0, 0), 'high__7': 43.14393905461883 ... 600 parameters truncated ... 'timestamp__92': datetime.datetime(2020, 7, 7, 0, 0), 'high__93': 48.464109440206215, 'close__93': 47.344879150390625, 'open__93': 48.41811271344901, 'low__93': 46.93092030688062, 'volume__93': 1822974, 'symbol__93': 'PKN', 'timestamp__93': datetime.datetime(2020, 7, 8, 0, 0), 'high__94': 47.66684683256694, 'close__94': 46.915584564208984, 'open__94': 47.52885958691691, 'low__94': 46.65494231401737, 'volume__94': 1160444, 'symbol__94': 'PKN', 'timestamp__94': datetime.datetime(2020, 7, 9, 0, 0), 'high__95': 47.09956838703235, 'close__95': 47.08423614501953, 'open__95': 46.76226783572877, 'low__95': 45.995673281044695, 'volume__95': 853408, 'symbol__95': 'PKN', 'timestamp__95': datetime.datetime(2020, 7, 10, 0, 0), 'high__96': 48.393429098126205, 'close__96': 47.83234786987305, 'open__96': 47.86351690225165, 'low__96': 47.53621976683114, 'volume__96': 660364, 'symbol__96': 'PKN', 'timestamp__96': datetime.datetime(2020, 7, 13, 0, 0), 'high__97': 49.936413357873114, 'close__97': 45.588016510009766, 'open__97': 48.299918673878075, 'low__97': 45.588016510009766, 'volume__97': 3172279, 'symbol__97': 'PKN', 'timestamp__97': datetime.datetime(2020, 7, 14, 0, 0), 'high__98': 46.336124513134585, 'close__98': 44.824317932128906, 'open__98': 46.336124513134585, 'low__98': 44.69963288392974, 'volume__98': 3522263, 'symbol__98': 'PKN', 'timestamp__98': datetime.datetime(2020, 7, 15, 0, 0), 'high__99': 46.47639673109067, 'close__99': 46.27378463745117, 'open__99': 44.73080601246605, 'low__99': 44.21647980413767, 'volume__99': 1646698, 'symbol__99': 'PKN', 'timestamp__99': datetime.datetime(2020, 7, 16, 0, 0)}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-02-26 23:00:39,755 - historical_importer - ERROR - Data columns: [('Date', ''), ('Close', 'PKN.WA'), ('High', 'PKN.WA'), ('Low', 'PKN.WA'), ('Open', 'PKN.WA'), ('Volume', 'PKN.WA'), ('symbol', '')]
2025-02-26 23:00:39,756 - historical_importer - ERROR - Data types: Price   Ticker
Date              datetime64[ns]
Close   PKN.WA           float64
High    PKN.WA           float64
Low     PKN.WA           float64
Open    PKN.WA           float64
Volume  PKN.WA             int64
symbol                    object
dtype: object
2025-02-26 23:00:39,756 - historical_importer - INFO - Imported 0 records for PKN
2025-02-26 23:00:40,760 - historical_importer - INFO - Fetching 5 years of data for PZU.WA
2025-02-26 23:00:41,096 - historical_importer - ERROR - Error saving historical data: (psycopg2.errors.UndefinedColumn) column "symbol" of relation "staging_stock_prices" does not exist
LINE 1: INSERT INTO staging_stock_prices (symbol, timestamp, open, h...
                                          ^

[SQL: INSERT INTO staging_stock_prices (symbol, timestamp, open, high, low, close, volume) VALUES (%(symbol__0)s, %(timestamp__0)s, %(open__0)s, %(high__0)s, %(low__0)s, %(close__0)s, %(volume__0)s), (%(symbol__1)s, %(timestamp__1)s, %(open__1)s, %(high__1 ... 10570 characters truncated ... ol__99)s, %(timestamp__99)s, %(open__99)s, %(high__99)s, %(low__99)s, %(close__99)s, %(volume__99)s)]
[parameters: {'high__0': 26.078997753054264, 'close__0': 25.24359703063965, 'open__0': 26.078997753054264, 'low__0': 24.93122999677175, 'volume__0': 3567606, 'symbol__0': 'PZU', 'timestamp__0': datetime.datetime(2020, 2, 28, 0, 0), 'high__1': 26.093523095326702, 'close__1': 25.388883590698242, 'open__1': 25.85380117717029, 'low__1': 24.698770335910552, 'volume__1': 2421089, 'symbol__1': 'PZU', 'timestamp__1': datetime.datetime(2020, 3, 2, 0, 0), 'high__2': 26.58023562085308, 'close__2': 26.376834869384766, 'open__2': 25.628605530103997, 'low__2': 25.54869730027647, 'volume__2': 2335620, 'symbol__2': 'PZU', 'timestamp__2': datetime.datetime(2020, 3, 3, 0, 0), 'high__3': 26.979772949000868, 'close__3': 26.58749771118164, 'open__3': 26.304188740910185, 'low__3': 26.158901307888918, 'volume__3': 2231654, 'symbol__3': 'PZU', 'timestamp__3': datetime.datetime(2020, 3, 4, 0, 0), 'high__4': 27.342990903756547, 'close__4': 26.006351470947266, 'open__4': 26.878073322105905, 'low__4': 26.006351470947266, 'volume__4': 1854994, 'symbol__4': 'PZU', 'timestamp__4': datetime.datetime(2020, 3, 5, 0, 0), 'high__5': 26.04994019637437, 'close__5': 25.279918670654297, 'open__5': 25.635872775588094, 'low__5': 24.953022609210514, 'volume__5': 2346680, 'symbol__5': 'PZU', 'timestamp__5': datetime.datetime(2020, 3, 6, 0, 0), 'high__6': 24.081300626854443, 'close__6': 22.88268280029297, 'open__6': 23.97233436221168, 'low__6': 22.613901472038364, 'volume__6': 2706524, 'symbol__6': 'PZU', 'timestamp__6': datetime.datetime(2020, 3, 9, 0, 0), 'high__7': 23.34760135860645 ... 600 parameters truncated ... 'timestamp__92': datetime.datetime(2020, 7, 7, 0, 0), 'high__93': 21.037538006323235, 'close__93': 20.89225196838379, 'open__93': 20.993952333497756, 'low__93': 20.797814727437768, 'volume__93': 1673632, 'symbol__93': 'PZU', 'timestamp__93': datetime.datetime(2020, 7, 8, 0, 0), 'high__94': 21.131978825945765, 'close__94': 20.943105697631836, 'open__94': 20.92131216474661, 'low__94': 20.80508276048631, 'volume__94': 1450553, 'symbol__94': 'PZU', 'timestamp__94': datetime.datetime(2020, 7, 9, 0, 0), 'high__95': 20.99395558385447, 'close__95': 20.884990692138672, 'open__95': 20.841405012565108, 'low__95': 20.57262365313996, 'volume__95': 1871238, 'symbol__95': 'PZU', 'timestamp__95': datetime.datetime(2020, 7, 10, 0, 0), 'high__96': 21.204620138002372, 'close__96': 20.906782150268555, 'open__96': 21.182826607596127, 'low__96': 20.906782150268555, 'volume__96': 1824536, 'symbol__96': 'PZU', 'timestamp__96': datetime.datetime(2020, 7, 13, 0, 0), 'high__97': 21.066597657180022, 'close__97': 20.834138870239258, 'open__97': 20.877724546399733, 'low__97': 20.74696613235464, 'volume__97': 1626649, 'symbol__97': 'PZU', 'timestamp__97': datetime.datetime(2020, 7, 14, 0, 0), 'high__98': 21.270000457763672, 'close__98': 21.270000457763672, 'open__98': 21.044804788461153, 'low__98': 20.884989713801954, 'volume__98': 2018034, 'symbol__98': 'PZU', 'timestamp__98': datetime.datetime(2020, 7, 15, 0, 0), 'high__99': 21.364434843991667, 'close__99': 21.197355270385742, 'open__99': 21.16829723033413, 'low__99': 21.10291802578162, 'volume__99': 1454592, 'symbol__99': 'PZU', 'timestamp__99': datetime.datetime(2020, 7, 16, 0, 0)}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-02-26 23:00:41,096 - historical_importer - ERROR - Data columns: [('Date', ''), ('Close', 'PZU.WA'), ('High', 'PZU.WA'), ('Low', 'PZU.WA'), ('Open', 'PZU.WA'), ('Volume', 'PZU.WA'), ('symbol', '')]
2025-02-26 23:00:41,097 - historical_importer - ERROR - Data types: Price   Ticker
Date              datetime64[ns]
Close   PZU.WA           float64
High    PZU.WA           float64
Low     PZU.WA           float64
Open    PZU.WA           float64
Volume  PZU.WA             int64
symbol                    object
dtype: object
2025-02-26 23:00:41,098 - historical_importer - INFO - Imported 0 records for PZU
2025-02-26 23:00:42,101 - historical_importer - INFO - Fetching 5 years of data for PEO.WA
2025-02-26 23:00:42,442 - historical_importer - ERROR - Error saving historical data: (psycopg2.errors.UndefinedColumn) column "symbol" of relation "staging_stock_prices" does not exist
LINE 1: INSERT INTO staging_stock_prices (symbol, timestamp, open, h...
                                          ^

[SQL: INSERT INTO staging_stock_prices (symbol, timestamp, open, high, low, close, volume) VALUES (%(symbol__0)s, %(timestamp__0)s, %(open__0)s, %(high__0)s, %(low__0)s, %(close__0)s, %(volume__0)s), (%(symbol__1)s, %(timestamp__1)s, %(open__1)s, %(high__1 ... 10570 characters truncated ... ol__99)s, %(timestamp__99)s, %(open__99)s, %(high__99)s, %(low__99)s, %(close__99)s, %(volume__99)s)]
[parameters: {'high__0': 72.46051459069695, 'close__0': 68.96674346923828, 'open__0': 71.66149316759018, 'low__0': 68.93540847547385, 'volume__0': 1628582, 'symbol__0': 'PEO', 'timestamp__0': datetime.datetime(2020, 2, 28, 0, 0), 'high__1': 72.63285377107478, 'close__1': 69.92243957519531, 'open__1': 70.42378752029794, 'low__1': 68.27739125679365, 'volume__1': 756361, 'symbol__1': 'PEO', 'timestamp__1': datetime.datetime(2020, 3, 2, 0, 0), 'high__2': 74.63823755675764, 'close__2': 74.2465591430664, 'open__2': 70.6587834392854, 'low__2': 70.51777897129502, 'volume__2': 998119, 'symbol__2': 'PEO', 'timestamp__2': datetime.datetime(2020, 3, 3, 0, 0), 'high__3': 75.10824790003021, 'close__3': 73.74520874023438, 'open__3': 73.94888318184832, 'low__3': 73.16552638114344, 'volume__3': 527940, 'symbol__3': 'PEO', 'timestamp__3': datetime.datetime(2020, 3, 4, 0, 0), 'high__4': 74.99858784125176, 'close__4': 72.77385711669922, 'open__4': 74.6695793780217, 'low__4': 72.58585313435901, 'volume__4': 515614, 'symbol__4': 'PEO', 'timestamp__4': datetime.datetime(2020, 3, 5, 0, 0), 'high__5': 72.38217352587247, 'close__5': 70.2514419555664, 'open__5': 71.99049510417028, 'low__5': 69.57775459211557, 'volume__5': 940230, 'symbol__5': 'PEO', 'timestamp__5': datetime.datetime(2020, 3, 6, 0, 0), 'high__6': 67.36869404608748, 'close__6': 64.47027587890625, 'open__6': 66.58533713857483, 'low__6': 63.09156604825311, 'volume__6': 833133, 'symbol__6': 'PEO', 'timestamp__6': datetime.datetime(2020, 3, 9, 0, 0), 'high__7': 65.78631535081286 ... 600 parameters truncated ... 'timestamp__92': datetime.datetime(2020, 7, 7, 0, 0), 'high__93': 43.131632143735445, 'close__93': 42.69295120239258, 'open__93': 42.849623180605704, 'low__93': 42.53627922417945, 'volume__93': 543075, 'symbol__93': 'PEO', 'timestamp__93': datetime.datetime(2020, 7, 8, 0, 0), 'high__94': 43.38230551450529, 'close__94': 43.08462905883789, 'open__94': 43.06896156240598, 'low__94': 42.614616118958324, 'volume__94': 406571, 'symbol__94': 'PEO', 'timestamp__94': datetime.datetime(2020, 7, 9, 0, 0), 'high__95': 43.63297653198242, 'close__95': 43.63297653198242, 'open__95': 42.69294772748488, 'low__95': 42.28560181259364, 'volume__95': 551367, 'symbol__95': 'PEO', 'timestamp__95': datetime.datetime(2020, 7, 10, 0, 0), 'high__96': 44.228328975364136, 'close__96': 43.75831604003906, 'open__96': 43.86798552573029, 'low__96': 43.695646054918726, 'volume__96': 532016, 'symbol__96': 'PEO', 'timestamp__96': datetime.datetime(2020, 7, 13, 0, 0), 'high__97': 43.85231845438486, 'close__97': 43.08462905883789, 'open__97': 43.476307504827325, 'low__97': 42.59894862252642, 'volume__97': 823747, 'symbol__97': 'PEO', 'timestamp__97': datetime.datetime(2020, 7, 14, 0, 0), 'high__98': 44.6043405759923, 'close__98': 44.40066909790039, 'open__98': 43.16296376803063, 'low__98': 43.10029677025981, 'volume__98': 1090942, 'symbol__98': 'PEO', 'timestamp__98': datetime.datetime(2020, 7, 15, 0, 0), 'high__99': 44.25966116137409, 'close__99': 44.102989196777344, 'open__99': 44.25966116137409, 'low__99': 43.57030631010989, 'volume__99': 555936, 'symbol__99': 'PEO', 'timestamp__99': datetime.datetime(2020, 7, 16, 0, 0)}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-02-26 23:00:42,443 - historical_importer - ERROR - Data columns: [('Date', ''), ('Close', 'PEO.WA'), ('High', 'PEO.WA'), ('Low', 'PEO.WA'), ('Open', 'PEO.WA'), ('Volume', 'PEO.WA'), ('symbol', '')]
2025-02-26 23:00:42,444 - historical_importer - ERROR - Data types: Price   Ticker
Date              datetime64[ns]
Close   PEO.WA           float64
High    PEO.WA           float64
Low     PEO.WA           float64
Open    PEO.WA           float64
Volume  PEO.WA             int64
symbol                    object
dtype: object
2025-02-26 23:00:42,444 - historical_importer - INFO - Imported 0 records for PEO
2025-02-26 23:00:43,452 - historical_importer - INFO - Fetching 5 years of data for KGH.WA
2025-02-26 23:00:43,911 - historical_importer - ERROR - Error saving historical data: (psycopg2.errors.UndefinedColumn) column "symbol" of relation "staging_stock_prices" does not exist
LINE 1: INSERT INTO staging_stock_prices (symbol, timestamp, open, h...
                                          ^

[SQL: INSERT INTO staging_stock_prices (symbol, timestamp, open, high, low, close, volume) VALUES (%(symbol__0)s, %(timestamp__0)s, %(open__0)s, %(high__0)s, %(low__0)s, %(close__0)s, %(volume__0)s), (%(symbol__1)s, %(timestamp__1)s, %(open__1)s, %(high__1 ... 10570 characters truncated ... ol__99)s, %(timestamp__99)s, %(open__99)s, %(high__99)s, %(low__99)s, %(close__99)s, %(volume__99)s)]
[parameters: {'high__0': 70.18863877824128, 'close__0': 66.01475524902344, 'open__0': 69.06562341377244, 'low__0': 65.5093961930252, 'volume__0': 1779132, 'symbol__0': 'KGH', 'timestamp__0': datetime.datetime(2020, 2, 28, 0, 0), 'high__1': 70.67527537939478, 'close__1': 68.31694030761719, 'open__1': 69.2527888049818, 'low__1': 66.1644859076956, 'volume__1': 1182780, 'symbol__1': 'KGH', 'timestamp__1': datetime.datetime(2020, 3, 2, 0, 0), 'high__2': 73.91332367625091, 'close__2': 72.8277359008789, 'open__2': 70.18864320207906, 'low__2': 69.60841451455698, 'volume__2': 1200095, 'symbol__2': 'KGH', 'timestamp__2': datetime.datetime(2020, 3, 3, 0, 0), 'high__3': 73.74486443343298, 'close__3': 70.7501449584961, 'open__3': 72.30365689098741, 'low__3': 70.7501449584961, 'volume__3': 584674, 'symbol__3': 'KGH', 'timestamp__3': datetime.datetime(2020, 3, 4, 0, 0), 'high__4': 72.3785196735974, 'close__4': 68.42924499511719, 'open__4': 72.1913528292939, 'low__4': 68.335654433008, 'volume__4': 619956, 'symbol__4': 'KGH', 'timestamp__4': datetime.datetime(2020, 3, 5, 0, 0), 'high__5': 67.21264863563732, 'close__5': 65.47196960449219, 'open__5': 67.11906520019092, 'low__5': 64.62970440555769, 'volume__5': 950443, 'symbol__5': 'KGH', 'timestamp__5': datetime.datetime(2020, 3, 6, 0, 0), 'high__6': 61.485240006225, 'close__6': 58.209774017333984, 'open__6': 58.93973466234607, 'low__6': 57.030602976953, 'volume__6': 1347285, 'symbol__6': 'KGH', 'timestamp__6': datetime.datetime(2020, 3, 9, 0, 0), 'high__7': 62.40237462428955 ... 600 parameters truncated ... 'timestamp__92': datetime.datetime(2020, 7, 7, 0, 0), 'high__93': 91.33881839254809, 'close__93': 90.9644775390625, 'open__93': 90.21580297204922, 'low__93': 90.08478474432295, 'volume__93': 383054, 'symbol__93': 'KGH', 'timestamp__93': datetime.datetime(2020, 7, 8, 0, 0), 'high__94': 95.78409566741375, 'close__94': 94.8950424194336, 'open__94': 91.4323985726549, 'low__94': 91.4323985726549, 'volume__94': 1490117, 'symbol__94': 'KGH', 'timestamp__94': datetime.datetime(2020, 7, 9, 0, 0), 'high__95': 95.45654296875, 'close__95': 95.45654296875, 'open__95': 93.86560344192034, 'low__95': 92.64899758731617, 'volume__95': 517415, 'symbol__95': 'KGH', 'timestamp__95': datetime.datetime(2020, 7, 10, 0, 0), 'high__96': 101.63314680785173, 'close__96': 100.83767700195312, 'open__96': 97.32824508773201, 'low__96': 96.76673740944814, 'volume__96': 1245530, 'symbol__96': 'KGH', 'timestamp__96': datetime.datetime(2020, 7, 13, 0, 0), 'high__97': 99.71466476286183, 'close__97': 98.77881622314453, 'open__97': 99.19994521003422, 'low__97': 97.14108127863925, 'volume__97': 845888, 'symbol__97': 'KGH', 'timestamp__97': datetime.datetime(2020, 7, 14, 0, 0), 'high__98': 100.83768072885437, 'close__98': 100.22937774658203, 'open__98': 99.19994577502148, 'low__98': 98.2640972299741, 'volume__98': 682497, 'symbol__98': 'KGH', 'timestamp__98': datetime.datetime(2020, 7, 15, 0, 0), 'high__99': 100.13578796386719, 'close__99': 100.13578796386719, 'open__99': 98.63843181482886, 'low__99': 97.79616674975814, 'volume__99': 606082, 'symbol__99': 'KGH', 'timestamp__99': datetime.datetime(2020, 7, 16, 0, 0)}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-02-26 23:00:43,913 - historical_importer - ERROR - Data columns: [('Date', ''), ('Close', 'KGH.WA'), ('High', 'KGH.WA'), ('Low', 'KGH.WA'), ('Open', 'KGH.WA'), ('Volume', 'KGH.WA'), ('symbol', '')]
2025-02-26 23:00:43,914 - historical_importer - ERROR - Data types: Price   Ticker
Date              datetime64[ns]
Close   KGH.WA           float64
High    KGH.WA           float64
Low     KGH.WA           float64
Open    KGH.WA           float64
Volume  KGH.WA             int64
symbol                    object
dtype: object
2025-02-26 23:00:43,915 - historical_importer - INFO - Imported 0 records for KGH
2025-02-26 23:00:44,920 - historical_importer - INFO - Fetching 5 years of data for LPP.WA
2025-02-26 23:00:45,308 - historical_importer - ERROR - Error saving historical data: (psycopg2.errors.UndefinedColumn) column "symbol" of relation "staging_stock_prices" does not exist
LINE 1: INSERT INTO staging_stock_prices (symbol, timestamp, open, h...
                                          ^

[SQL: INSERT INTO staging_stock_prices (symbol, timestamp, open, high, low, close, volume) VALUES (%(symbol__0)s, %(timestamp__0)s, %(open__0)s, %(high__0)s, %(low__0)s, %(close__0)s, %(volume__0)s), (%(symbol__1)s, %(timestamp__1)s, %(open__1)s, %(high__1 ... 10570 characters truncated ... ol__99)s, %(timestamp__99)s, %(open__99)s, %(high__99)s, %(low__99)s, %(close__99)s, %(volume__99)s)]
[parameters: {'high__0': 6082.690975996376, 'close__0': 5987.2421875, 'open__0': 5900.470561594203, 'low__0': 5813.698935688406, 'volume__0': 6505, 'symbol__0': 'LPP', 'timestamp__0': datetime.datetime(2020, 2, 28, 0, 0), 'high__1': 6139.092948481722, 'close__1': 5978.5654296875, 'open__1': 6108.72287735849, 'low__1': 5891.793797906839, 'volume__1': 4047, 'symbol__1': 'LPP', 'timestamp__1': datetime.datetime(2020, 3, 2, 0, 0), 'high__2': 6555.596356043822, 'close__2': 6395.06884765625, 'open__2': 5987.242204725661, 'low__2': 5987.242204725661, 'volume__2': 4153, 'symbol__2': 'LPP', 'timestamp__2': datetime.datetime(2020, 3, 3, 0, 0), 'high__3': 6364.698957928959, 'close__3': 6286.6044921875, 'open__3': 6316.974562198067, 'low__3': 6169.462793575311, 'volume__3': 2643, 'symbol__3': 'LPP', 'timestamp__3': datetime.datetime(2020, 3, 4, 0, 0), 'high__4': 6334.32848623198, 'close__4': 6169.46240234375, 'open__4': 6264.911187752726, 'low__4': 6160.785240033843, 'volume__4': 3178, 'symbol__4': 'LPP', 'timestamp__4': datetime.datetime(2020, 3, 5, 0, 0), 'high__5': 6169.4623784468595, 'close__5': 5939.517578125, 'open__5': 6160.785216170562, 'low__5': 5852.745955362035, 'volume__5': 4827, 'symbol__5': 'LPP', 'timestamp__5': datetime.datetime(2020, 3, 6, 0, 0), 'high__6': 5687.879576849168, 'close__6': 5379.84033203125, 'open__6': 5527.352083070817, 'low__6': 5254.021485556325, 'volume__6': 5345, 'symbol__6': 'LPP', 'timestamp__6': datetime.datetime(2020, 3, 9, 0, 0), 'high__7': 5431.903793525855 ... 600 parameters truncated ... 'timestamp__92': datetime.datetime(2020, 7, 7, 0, 0), 'high__93': 5783.328922488967, 'close__93': 5713.91162109375, 'open__93': 5661.848645047337, 'low__93': 5635.817157024132, 'volume__93': 4217, 'symbol__93': 'LPP', 'timestamp__93': datetime.datetime(2020, 7, 8, 0, 0), 'high__94': 5852.746822717912, 'close__94': 5826.71533203125, 'open__94': 5783.329514220146, 'low__94': 5713.91220572238, 'volume__94': 6006, 'symbol__94': 'LPP', 'timestamp__94': datetime.datetime(2020, 7, 9, 0, 0), 'high__95': 5813.69873046875, 'close__95': 5813.69873046875, 'open__95': 5761.635756763059, 'low__95': 5687.879877346665, 'volume__95': 3081, 'symbol__95': 'LPP', 'timestamp__95': datetime.datetime(2020, 7, 10, 0, 0), 'high__96': 5887.454579825822, 'close__96': 5709.57275390625, 'open__96': 5857.084511985895, 'low__96': 5696.557010546281, 'volume__96': 2064, 'symbol__96': 'LPP', 'timestamp__96': datetime.datetime(2020, 7, 13, 0, 0), 'high__97': 5709.572938849545, 'close__97': 5475.28955078125, 'open__97': 5692.2186138074485, 'low__97': 5449.258063218106, 'volume__97': 5145, 'symbol__97': 'LPP', 'timestamp__97': datetime.datetime(2020, 7, 14, 0, 0), 'high__98': 5592.43115234375, 'close__98': 5592.43115234375, 'open__98': 5523.013853323191, 'low__98': 5483.966622624127, 'volume__98': 3934, 'symbol__98': 'LPP', 'timestamp__98': datetime.datetime(2020, 7, 15, 0, 0), 'high__99': 5614.124465053176, 'close__99': 5583.75439453125, 'open__99': 5553.384324009324, 'low__99': 5505.659927474869, 'volume__99': 4539, 'symbol__99': 'LPP', 'timestamp__99': datetime.datetime(2020, 7, 16, 0, 0)}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-02-26 23:00:45,308 - historical_importer - ERROR - Data columns: [('Date', ''), ('Close', 'LPP.WA'), ('High', 'LPP.WA'), ('Low', 'LPP.WA'), ('Open', 'LPP.WA'), ('Volume', 'LPP.WA'), ('symbol', '')]
2025-02-26 23:00:45,310 - historical_importer - ERROR - Data types: Price   Ticker
Date              datetime64[ns]
Close   LPP.WA           float64
High    LPP.WA           float64
Low     LPP.WA           float64
Open    LPP.WA           float64
Volume  LPP.WA             int64
symbol                    object
dtype: object
2025-02-26 23:00:45,310 - historical_importer - INFO - Imported 0 records for LPP
2025-02-26 23:00:46,316 - historical_importer - INFO - Fetching 5 years of data for SPL.WA
2025-02-26 23:00:46,671 - historical_importer - ERROR - Error saving historical data: (psycopg2.errors.UndefinedColumn) column "symbol" of relation "staging_stock_prices" does not exist
LINE 1: INSERT INTO staging_stock_prices (symbol, timestamp, open, h...
                                          ^

[SQL: INSERT INTO staging_stock_prices (symbol, timestamp, open, high, low, close, volume) VALUES (%(symbol__0)s, %(timestamp__0)s, %(open__0)s, %(high__0)s, %(low__0)s, %(close__0)s, %(volume__0)s), (%(symbol__1)s, %(timestamp__1)s, %(open__1)s, %(high__1 ... 10570 characters truncated ... ol__99)s, %(timestamp__99)s, %(open__99)s, %(high__99)s, %(low__99)s, %(close__99)s, %(volume__99)s)]
[parameters: {'high__0': 227.75777439247904, 'close__0': 216.36988830566406, 'open__0': 221.3736602243684, 'low__0': 213.2640952074214, 'volume__0': 155782, 'symbol__0': 'SPL', 'timestamp__0': datetime.datetime(2020, 2, 28, 0, 0), 'high__1': 225.8597834164241, 'close__1': 224.30690002441406, 'open__1': 224.6519822972952, 'low__1': 217.4051492544321, 'volume__1': 108224, 'symbol__1': 'SPL', 'timestamp__1': datetime.datetime(2020, 3, 2, 0, 0), 'high__2': 240.6985545633419, 'close__2': 234.8320770263672, 'open__2': 224.30689672569497, 'low__2': 222.58145905857424, 'volume__2': 112138, 'symbol__2': 'SPL', 'timestamp__2': datetime.datetime(2020, 3, 3, 0, 0), 'high__3': 238.4554685632202, 'close__3': 236.38494873046875, 'open__3': 231.20863598454608, 'low__3': 231.20863598454608, 'volume__3': 53365, 'symbol__3': 'SPL', 'timestamp__3': datetime.datetime(2020, 3, 4, 0, 0), 'high__4': 238.45547628874732, 'close__4': 230.17337036132812, 'open__4': 232.93408111316418, 'low__4': 228.79304131349906, 'volume__4': 58814, 'symbol__4': 'SPL', 'timestamp__4': datetime.datetime(2020, 3, 5, 0, 0), 'high__5': 227.24013058963888, 'close__5': 217.5776824951172, 'open__5': 225.51469295975843, 'low__5': 213.9542661051771, 'volume__5': 74158, 'symbol__5': 'SPL', 'timestamp__5': datetime.datetime(2020, 3, 6, 0, 0), 'high__6': 208.7779535661664, 'close__6': 196.69989013671875, 'open__6': 207.5701524888394, 'low__6': 192.21375492430423, 'volume__6': 121099, 'symbol__6': 'SPL', 'timestamp__6': datetime.datetime(2020, 3, 9, 0, 0), 'high__7': 200.49585841701565 ... 600 parameters truncated ... 'timestamp__92': datetime.datetime(2020, 7, 7, 0, 0), 'high__93': 148.12881499168532, 'close__93': 146.48965454101562, 'open__93': 146.05829514199263, 'low__93': 145.1092991985244, 'volume__93': 44882, 'symbol__93': 'SPL', 'timestamp__93': datetime.datetime(2020, 7, 8, 0, 0), 'high__94': 147.7837503775502, 'close__94': 145.626953125, 'open__94': 146.83475432080982, 'low__94': 145.36813482188484, 'volume__94': 70001, 'symbol__94': 'SPL', 'timestamp__94': datetime.datetime(2020, 7, 9, 0, 0), 'high__95': 145.79948643275668, 'close__95': 144.936767578125, 'open__95': 144.50540815080916, 'low__95': 143.38387100697895, 'volume__95': 96470, 'symbol__95': 'SPL', 'timestamp__95': datetime.datetime(2020, 7, 10, 0, 0), 'high__96': 150.54444013323103, 'close__96': 147.95628356933594, 'open__96': 147.87000641825475, 'low__96': 145.1955858673235, 'volume__96': 92203, 'symbol__96': 'SPL', 'timestamp__96': datetime.datetime(2020, 7, 13, 0, 0), 'high__97': 147.69746569441068, 'close__97': 143.297607421875, 'open__97': 146.74848285008105, 'low__97': 142.86624799334922, 'volume__97': 78783, 'symbol__97': 'SPL', 'timestamp__97': datetime.datetime(2020, 7, 14, 0, 0), 'high__98': 145.1093140763805, 'close__98': 142.0897979736328, 'open__98': 144.76423178739898, 'low__98': 141.0545379426427, 'volume__98': 130851, 'symbol__98': 'SPL', 'timestamp__98': datetime.datetime(2020, 7, 15, 0, 0), 'high__99': 143.6426852927713, 'close__99': 142.00352478027344, 'open__99': 143.1250487288011, 'low__99': 138.9840088732182, 'volume__99': 71690, 'symbol__99': 'SPL', 'timestamp__99': datetime.datetime(2020, 7, 16, 0, 0)}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-02-26 23:00:46,671 - historical_importer - ERROR - Data columns: [('Date', ''), ('Close', 'SPL.WA'), ('High', 'SPL.WA'), ('Low', 'SPL.WA'), ('Open', 'SPL.WA'), ('Volume', 'SPL.WA'), ('symbol', '')]
2025-02-26 23:00:46,673 - historical_importer - ERROR - Data types: Price   Ticker
Date              datetime64[ns]
Close   SPL.WA           float64
High    SPL.WA           float64
Low     SPL.WA           float64
Open    SPL.WA           float64
Volume  SPL.WA             int64
symbol                    object
dtype: object
2025-02-26 23:00:46,673 - historical_importer - INFO - Imported 0 records for SPL
2025-02-26 23:00:47,677 - historical_importer - INFO - Fetching 5 years of data for ALE.WA
2025-02-26 23:00:47,982 - historical_importer - ERROR - Error saving historical data: (psycopg2.errors.UndefinedColumn) column "symbol" of relation "staging_stock_prices" does not exist
LINE 1: INSERT INTO staging_stock_prices (symbol, timestamp, open, h...
                                          ^

[SQL: INSERT INTO staging_stock_prices (symbol, timestamp, open, high, low, close, volume) VALUES (%(symbol__0)s, %(timestamp__0)s, %(open__0)s, %(high__0)s, %(low__0)s, %(close__0)s, %(volume__0)s), (%(symbol__1)s, %(timestamp__1)s, %(open__1)s, %(high__1 ... 10570 characters truncated ... ol__99)s, %(timestamp__99)s, %(open__99)s, %(high__99)s, %(low__99)s, %(close__99)s, %(volume__99)s)]
[parameters: {'high__0': 80.0, 'close__0': 80.0, 'open__0': 72.0, 'low__0': 71.08000183105469, 'volume__0': 18452974, 'symbol__0': 'ALE', 'timestamp__0': datetime.datetime(2020, 10, 13, 0, 0), 'high__1': 90.30000305175781, 'close__1': 75.95999908447266, 'open__1': 84.0, 'low__1': 71.25, 'volume__1': 16731591, 'symbol__1': 'ALE', 'timestamp__1': datetime.datetime(2020, 10, 14, 0, 0), 'high__2': 80.0, 'close__2': 79.22000122070312, 'open__2': 76.0, 'low__2': 71.5199966430664, 'volume__2': 6235974, 'symbol__2': 'ALE', 'timestamp__2': datetime.datetime(2020, 10, 15, 0, 0), 'high__3': 85.44000244140625, 'close__3': 81.44999694824219, 'open__3': 80.0, 'low__3': 79.25, 'volume__3': 15480831, 'symbol__3': 'ALE', 'timestamp__3': datetime.datetime(2020, 10, 16, 0, 0), 'high__4': 83.62000274658203, 'close__4': 83.4000015258789, 'open__4': 81.44999694824219, 'low__4': 79.80000305175781, 'volume__4': 3205087, 'symbol__4': 'ALE', 'timestamp__4': datetime.datetime(2020, 10, 19, 0, 0), 'high__5': 85.5999984741211, 'close__5': 85.0, 'open__5': 83.44999694824219, 'low__5': 83.33000183105469, 'volume__5': 3048042, 'symbol__5': 'ALE', 'timestamp__5': datetime.datetime(2020, 10, 20, 0, 0), 'high__6': 85.98999786376953, 'close__6': 84.16999816894531, 'open__6': 85.98999786376953, 'low__6': 82.12000274658203, 'volume__6': 2734889, 'symbol__6': 'ALE', 'timestamp__6': datetime.datetime(2020, 10, 21, 0, 0), 'high__7': 89.0 ... 600 parameters truncated ... 'timestamp__92': datetime.datetime(2021, 2, 25, 0, 0), 'high__93': 64.43000030517578, 'close__93': 64.31999969482422, 'open__93': 64.0999984741211, 'low__93': 61.5, 'volume__93': 1624343, 'symbol__93': 'ALE', 'timestamp__93': datetime.datetime(2021, 2, 26, 0, 0), 'high__94': 65.3499984741211, 'close__94': 63.06999969482422, 'open__94': 65.0, 'low__94': 62.5, 'volume__94': 1347372, 'symbol__94': 'ALE', 'timestamp__94': datetime.datetime(2021, 3, 1, 0, 0), 'high__95': 67.45999908447266, 'close__95': 66.76000213623047, 'open__95': 63.95000076293945, 'low__95': 63.189998626708984, 'volume__95': 3120360, 'symbol__95': 'ALE', 'timestamp__95': datetime.datetime(2021, 3, 2, 0, 0), 'high__96': 68.19999694824219, 'close__96': 66.45999908447266, 'open__96': 67.5, 'low__96': 65.0199966430664, 'volume__96': 2887525, 'symbol__96': 'ALE', 'timestamp__96': datetime.datetime(2021, 3, 3, 0, 0), 'high__97': 67.37999725341797, 'close__97': 64.73999786376953, 'open__97': 67.0, 'low__97': 63.689998626708984, 'volume__97': 3554548, 'symbol__97': 'ALE', 'timestamp__97': datetime.datetime(2021, 3, 4, 0, 0), 'high__98': 64.3499984741211, 'close__98': 64.0, 'open__98': 63.720001220703125, 'low__98': 63.459999084472656, 'volume__98': 2512451, 'symbol__98': 'ALE', 'timestamp__98': datetime.datetime(2021, 3, 5, 0, 0), 'high__99': 65.0, 'close__99': 63.540000915527344, 'open__99': 64.0999984741211, 'low__99': 63.029998779296875, 'volume__99': 1529124, 'symbol__99': 'ALE', 'timestamp__99': datetime.datetime(2021, 3, 8, 0, 0)}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-02-26 23:00:47,982 - historical_importer - ERROR - Data columns: [('Date', ''), ('Close', 'ALE.WA'), ('High', 'ALE.WA'), ('Low', 'ALE.WA'), ('Open', 'ALE.WA'), ('Volume', 'ALE.WA'), ('symbol', '')]
2025-02-26 23:00:47,984 - historical_importer - ERROR - Data types: Price   Ticker
Date              datetime64[ns]
Close   ALE.WA           float64
High    ALE.WA           float64
Low     ALE.WA           float64
Open    ALE.WA           float64
Volume  ALE.WA             int64
symbol                    object
dtype: object
2025-02-26 23:00:47,984 - historical_importer - INFO - Imported 0 records for ALE
2025-02-26 23:00:48,990 - historical_importer - INFO - Fetching 5 years of data for CPS.WA
2025-02-26 23:00:49,364 - historical_importer - ERROR - Error saving historical data: (psycopg2.errors.UndefinedColumn) column "symbol" of relation "staging_stock_prices" does not exist
LINE 1: INSERT INTO staging_stock_prices (symbol, timestamp, open, h...
                                          ^

[SQL: INSERT INTO staging_stock_prices (symbol, timestamp, open, high, low, close, volume) VALUES (%(symbol__0)s, %(timestamp__0)s, %(open__0)s, %(high__0)s, %(low__0)s, %(close__0)s, %(volume__0)s), (%(symbol__1)s, %(timestamp__1)s, %(open__1)s, %(high__1 ... 10570 characters truncated ... ol__99)s, %(timestamp__99)s, %(open__99)s, %(high__99)s, %(low__99)s, %(close__99)s, %(volume__99)s)]
[parameters: {'high__0': 22.931263829988, 'close__0': 21.93879508972168, 'open__0': 22.4611460095378, 'low__0': 21.72985272917954, 'volume__0': 1302422, 'symbol__0': 'CPS', 'timestamp__0': datetime.datetime(2020, 2, 28, 0, 0), 'high__1': 22.37408842478199, 'close__1': 21.956205368041992, 'open__1': 21.86914798921284, 'low__1': 21.799501089841687, 'volume__1': 778331, 'symbol__1': 'CPS', 'timestamp__1': datetime.datetime(2020, 3, 2, 0, 0), 'high__2': 22.879030138210386, 'close__2': 22.844205856323242, 'open__2': 21.956206594358907, 'low__2': 21.956206594358907, 'volume__2': 750446, 'symbol__2': 'CPS', 'timestamp__2': datetime.datetime(2020, 3, 3, 0, 0), 'high__3': 23.244676725414042, 'close__3': 23.105382919311523, 'open__3': 22.63526507833065, 'low__3': 22.548206034388286, 'volume__3': 396941, 'symbol__3': 'CPS', 'timestamp__3': datetime.datetime(2020, 3, 4, 0, 0), 'high__4': 23.366556850565225, 'close__4': 22.408910751342773, 'open__4': 23.349144710821733, 'low__4': 21.95620508109026, 'volume__4': 672328, 'symbol__4': 'CPS', 'timestamp__4': datetime.datetime(2020, 3, 5, 0, 0), 'high__5': 22.56561670540435, 'close__5': 22.32185173034668, 'open__5': 22.095498895045925, 'low__5': 21.66020536420133, 'volume__5': 621666, 'symbol__5': 'CPS', 'timestamp__5': datetime.datetime(2020, 3, 6, 0, 0), 'high__6': 21.764675679075047, 'close__6': 20.859264373779297, 'open__6': 21.764675679075047, 'low__6': 20.632913207968333, 'volume__6': 639131, 'symbol__6': 'CPS', 'timestamp__6': datetime.datetime(2020, 3, 9, 0, 0), 'high__7': 20.946323954953513 ... 600 parameters truncated ... 'timestamp__92': datetime.datetime(2020, 7, 7, 0, 0), 'high__93': 23.697380310192347, 'close__93': 23.50585174560547, 'open__93': 23.366557942176264, 'low__93': 23.296911040461662, 'volume__93': 211836, 'symbol__93': 'CPS', 'timestamp__93': datetime.datetime(2020, 7, 8, 0, 0), 'high__94': 24.115262959567232, 'close__94': 24.010791778564453, 'open__94': 23.34914539358176, 'low__94': 23.34914539358176, 'volume__94': 326610, 'symbol__94': 'CPS', 'timestamp__94': datetime.datetime(2020, 7, 9, 0, 0), 'high__95': 24.393848419189453, 'close__95': 24.393848419189453, 'open__95': 23.662555197934438, 'low__95': 23.645143059210998, 'volume__95': 345389, 'symbol__95': 'CPS', 'timestamp__95': datetime.datetime(2020, 7, 10, 0, 0), 'high__96': 24.637613976110735, 'close__96': 24.045616149902344, 'open__96': 24.550556595544833, 'low__96': 24.045616149902344, 'volume__96': 461023, 'symbol__96': 'CPS', 'timestamp__96': datetime.datetime(2020, 7, 13, 0, 0), 'high__97': 24.097850976110568, 'close__97': 23.975969314575195, 'open__97': 23.8889102732586, 'low__97': 23.592910529090034, 'volume__97': 334368, 'symbol__97': 'CPS', 'timestamp__97': datetime.datetime(2020, 7, 14, 0, 0), 'high__98': 24.411262485619556, 'close__98': 24.306791305541992, 'open__98': 24.16749750578062, 'low__98': 23.906320385843248, 'volume__98': 360317, 'symbol__98': 'CPS', 'timestamp__98': datetime.datetime(2020, 7, 15, 0, 0), 'high__99': 24.759496597156225, 'close__99': 24.724672317504883, 'open__99': 24.219731886151727, 'low__99': 24.219731886151727, 'volume__99': 196772, 'symbol__99': 'CPS', 'timestamp__99': datetime.datetime(2020, 7, 16, 0, 0)}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-02-26 23:00:49,365 - historical_importer - ERROR - Data columns: [('Date', ''), ('Close', 'CPS.WA'), ('High', 'CPS.WA'), ('Low', 'CPS.WA'), ('Open', 'CPS.WA'), ('Volume', 'CPS.WA'), ('symbol', '')]
2025-02-26 23:00:49,366 - historical_importer - ERROR - Data types: Price   Ticker
Date              datetime64[ns]
Close   CPS.WA           float64
High    CPS.WA           float64
Low     CPS.WA           float64
Open    CPS.WA           float64
Volume  CPS.WA             int64
symbol                    object
dtype: object
2025-02-26 23:00:49,366 - historical_importer - INFO - Imported 0 records for CPS
2025-02-26 23:00:50,373 - historical_importer - INFO - Fetching 5 years of data for CDR.WA
2025-02-26 23:00:50,701 - historical_importer - ERROR - Error saving historical data: (psycopg2.errors.UndefinedColumn) column "symbol" of relation "staging_stock_prices" does not exist
LINE 1: INSERT INTO staging_stock_prices (symbol, timestamp, open, h...
                                          ^

[SQL: INSERT INTO staging_stock_prices (symbol, timestamp, open, high, low, close, volume) VALUES (%(symbol__0)s, %(timestamp__0)s, %(open__0)s, %(high__0)s, %(low__0)s, %(close__0)s, %(volume__0)s), (%(symbol__1)s, %(timestamp__1)s, %(open__1)s, %(high__1 ... 10570 characters truncated ... ol__99)s, %(timestamp__99)s, %(open__99)s, %(high__99)s, %(low__99)s, %(close__99)s, %(volume__99)s)]
[parameters: {'high__0': 271.0517567167162, 'close__0': 263.9437561035156, 'open__0': 261.5744225657821, 'low__0': 247.92706717294263, 'volume__0': 1106623, 'symbol__0': 'CDR', 'timestamp__0': datetime.datetime(2020, 2, 28, 0, 0), 'high__1': 282.42454973962947, 'close__1': 269.5353698730469, 'open__1': 272.85243673240495, 'low__1': 257.783481641541, 'volume__1': 677207, 'symbol__1': 'CDR', 'timestamp__1': datetime.datetime(2020, 3, 2, 0, 0), 'high__2': 290.8593765448778, 'close__2': 289.8168640136719, 'open__2': 279.58135479689844, 'low__2': 275.03224601667205, 'volume__2': 745525, 'symbol__2': 'CDR', 'timestamp__2': datetime.datetime(2020, 3, 3, 0, 0), 'high__3': 288.4900675268502, 'close__3': 280.1500244140625, 'open__3': 284.60435444741455, 'low__3': 277.212044821195, 'volume__3': 412457, 'symbol__3': 'CDR', 'timestamp__3': datetime.datetime(2020, 3, 4, 0, 0), 'high__4': 289.5325594146778, 'close__4': 282.04547119140625, 'open__4': 287.16322586791284, 'low__4': 278.8231833523116, 'volume__4': 303548, 'symbol__4': 'CDR', 'timestamp__4': datetime.datetime(2020, 3, 5, 0, 0), 'high__5': 279.48655657283393, 'close__5': 277.87542724609375, 'open__5': 279.20224813944634, 'low__5': 268.20853559554763, 'volume__5': 363928, 'symbol__5': 'CDR', 'timestamp__5': datetime.datetime(2020, 3, 6, 0, 0), 'high__6': 269.1563153302228, 'close__6': 255.88804626464844, 'open__6': 252.09711224591288, 'low__6': 245.93684446546766, 'volume__6': 706198, 'symbol__6': 'CDR', 'timestamp__6': datetime.datetime(2020, 3, 9, 0, 0), 'high__7': 265.3653269264857 ... 600 parameters truncated ... 'timestamp__92': datetime.datetime(2020, 7, 7, 0, 0), 'high__93': 383.92678708083173, 'close__93': 378.2403869628906, 'open__93': 383.26336216472794, 'low__93': 376.1553620173015, 'volume__93': 182174, 'symbol__93': 'CDR', 'timestamp__93': datetime.datetime(2020, 7, 8, 0, 0), 'high__94': 379.9463172743126, 'close__94': 365.7303161621094, 'open__94': 378.33518783511323, 'low__94': 365.7303161621094, 'volume__94': 439101, 'symbol__94': 'CDR', 'timestamp__94': datetime.datetime(2020, 7, 9, 0, 0), 'high__95': 365.8251339561061, 'close__95': 360.13873291015625, 'open__95': 361.3707749010995, 'low__95': 359.19099940249794, 'volume__95': 390769, 'symbol__95': 'CDR', 'timestamp__95': datetime.datetime(2020, 7, 10, 0, 0), 'high__96': 365.256455649865, 'close__96': 350.1875, 'open__96': 362.98190121786195, 'low__96': 349.42932483017523, 'volume__96': 454143, 'symbol__96': 'CDR', 'timestamp__96': datetime.datetime(2020, 7, 13, 0, 0), 'high__97': 348.6711308637947, 'close__97': 335.4028625488281, 'open__97': 347.72339741272566, 'low__97': 332.7492204548467, 'volume__97': 624805, 'symbol__97': 'CDR', 'timestamp__97': datetime.datetime(2020, 7, 14, 0, 0), 'high__98': 359.38052513386594, 'close__98': 345.9226989746094, 'open__98': 338.71991918405695, 'low__98': 338.71991918405695, 'volume__98': 564238, 'symbol__98': 'CDR', 'timestamp__98': datetime.datetime(2020, 7, 15, 0, 0), 'high__99': 351.1352264755701, 'close__99': 349.0502014160156, 'open__99': 346.8704261540045, 'low__99': 342.70040495742376, 'volume__99': 216848, 'symbol__99': 'CDR', 'timestamp__99': datetime.datetime(2020, 7, 16, 0, 0)}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-02-26 23:00:50,701 - historical_importer - ERROR - Data columns: [('Date', ''), ('Close', 'CDR.WA'), ('High', 'CDR.WA'), ('Low', 'CDR.WA'), ('Open', 'CDR.WA'), ('Volume', 'CDR.WA'), ('symbol', '')]
2025-02-26 23:00:50,703 - historical_importer - ERROR - Data types: Price   Ticker
Date              datetime64[ns]
Close   CDR.WA           float64
High    CDR.WA           float64
Low     CDR.WA           float64
Open    CDR.WA           float64
Volume  CDR.WA             int64
symbol                    object
dtype: object
2025-02-26 23:00:50,703 - historical_importer - INFO - Imported 0 records for CDR
2025-02-26 23:00:51,710 - historical_importer - INFO - Fetching 5 years of data for MBK.WA
2025-02-26 23:00:52,093 - historical_importer - ERROR - Error saving historical data: (psycopg2.errors.UndefinedColumn) column "symbol" of relation "staging_stock_prices" does not exist
LINE 1: INSERT INTO staging_stock_prices (symbol, timestamp, open, h...
                                          ^

[SQL: INSERT INTO staging_stock_prices (symbol, timestamp, open, high, low, close, volume) VALUES (%(symbol__0)s, %(timestamp__0)s, %(open__0)s, %(high__0)s, %(low__0)s, %(close__0)s, %(volume__0)s), (%(symbol__1)s, %(timestamp__1)s, %(open__1)s, %(high__1 ... 10570 characters truncated ... ol__99)s, %(timestamp__99)s, %(open__99)s, %(high__99)s, %(low__99)s, %(close__99)s, %(volume__99)s)]
[parameters: {'high__0': 324.76412770752137, 'close__0': 296.1435546875, 'open__0': 319.00027199559565, 'low__0': 296.1435546875, 'volume__0': 42576, 'symbol__0': 'MBK', 'timestamp__0': datetime.datetime(2020, 2, 28, 0, 0), 'high__1': 305.08748869728805, 'close__1': 294.9510192871094, 'open__1': 302.10617773281945, 'low__1': 286.4046187842701, 'volume__1': 40944, 'symbol__1': 'MBK', 'timestamp__1': datetime.datetime(2020, 3, 2, 0, 0), 'high__2': 333.31055688685035, 'close__2': 328.3417053222656, 'open__2': 303.09994543966786, 'low__2': 296.34231944281794, 'volume__2': 25817, 'symbol__2': 'MBK', 'timestamp__2': datetime.datetime(2020, 3, 3, 0, 0), 'high__3': 328.9379554185536, 'close__3': 315.22393798828125, 'open__3': 328.9379554185536, 'low__3': 312.04386103149795, 'volume__3': 29914, 'symbol__3': 'MBK', 'timestamp__3': datetime.datetime(2020, 3, 4, 0, 0), 'high__4': 322.97536307724556, 'close__4': 307.2738037109375, 'open__4': 322.97536307724556, 'low__4': 304.09372646657584, 'volume__4': 13766, 'symbol__4': 'MBK', 'timestamp__4': datetime.datetime(2020, 3, 5, 0, 0), 'high__5': 303.0999378929846, 'close__5': 299.91986083984375, 'open__5': 298.7273546905127, 'low__5': 293.1622350112474, 'volume__5': 21850, 'symbol__5': 'MBK', 'timestamp__5': datetime.datetime(2020, 3, 6, 0, 0), 'high__6': 294.75227488413464, 'close__6': 261.9578552246094, 'open__6': 294.75227488413464, 'low__6': 261.9578552246094, 'volume__6': 28741, 'symbol__6': 'MBK', 'timestamp__6': datetime.datetime(2020, 3, 9, 0, 0), 'high__7': 267.1254467702055 ... 600 parameters truncated ... 'timestamp__92': datetime.datetime(2020, 7, 7, 0, 0), 'high__93': 234.0, 'close__93': 229.1999969482422, 'open__93': 231.60000610351562, 'low__93': 226.1999969482422, 'volume__93': 40771, 'symbol__93': 'MBK', 'timestamp__93': datetime.datetime(2020, 7, 8, 0, 0), 'high__94': 233.0, 'close__94': 228.1999969482422, 'open__94': 229.1999969482422, 'low__94': 226.60000610351562, 'volume__94': 27042, 'symbol__94': 'MBK', 'timestamp__94': datetime.datetime(2020, 7, 9, 0, 0), 'high__95': 229.1999969482422, 'close__95': 229.1999969482422, 'open__95': 226.0, 'low__95': 222.39999389648438, 'volume__95': 20472, 'symbol__95': 'MBK', 'timestamp__95': datetime.datetime(2020, 7, 10, 0, 0), 'high__96': 234.0, 'close__96': 230.0, 'open__96': 230.8000030517578, 'low__96': 225.0, 'volume__96': 32931, 'symbol__96': 'MBK', 'timestamp__96': datetime.datetime(2020, 7, 13, 0, 0), 'high__97': 229.39999389648438, 'close__97': 224.39999389648438, 'open__97': 228.0, 'low__97': 222.39999389648438, 'volume__97': 25613, 'symbol__97': 'MBK', 'timestamp__97': datetime.datetime(2020, 7, 14, 0, 0), 'high__98': 225.1999969482422, 'close__98': 223.0, 'open__98': 224.39999389648438, 'low__98': 221.0, 'volume__98': 32807, 'symbol__98': 'MBK', 'timestamp__98': datetime.datetime(2020, 7, 15, 0, 0), 'high__99': 223.0, 'close__99': 216.0, 'open__99': 223.0, 'low__99': 212.0, 'volume__99': 32797, 'symbol__99': 'MBK', 'timestamp__99': datetime.datetime(2020, 7, 16, 0, 0)}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-02-26 23:00:52,093 - historical_importer - ERROR - Data columns: [('Date', ''), ('Close', 'MBK.WA'), ('High', 'MBK.WA'), ('Low', 'MBK.WA'), ('Open', 'MBK.WA'), ('Volume', 'MBK.WA'), ('symbol', '')]
2025-02-26 23:00:52,094 - historical_importer - ERROR - Data types: Price   Ticker
Date              datetime64[ns]
Close   MBK.WA           float64
High    MBK.WA           float64
Low     MBK.WA           float64
Open    MBK.WA           float64
Volume  MBK.WA             int64
symbol                    object
dtype: object
2025-02-26 23:00:52,094 - historical_importer - INFO - Imported 0 records for MBK
2025-02-26 23:00:53,113 - historical_importer - INFO - Fetching 5 years of data for DNP.WA
2025-02-26 23:00:53,431 - historical_importer - ERROR - Error saving historical data: (psycopg2.errors.UndefinedColumn) column "symbol" of relation "staging_stock_prices" does not exist
LINE 1: INSERT INTO staging_stock_prices (symbol, timestamp, open, h...
                                          ^

[SQL: INSERT INTO staging_stock_prices (symbol, timestamp, open, high, low, close, volume) VALUES (%(symbol__0)s, %(timestamp__0)s, %(open__0)s, %(high__0)s, %(low__0)s, %(close__0)s, %(volume__0)s), (%(symbol__1)s, %(timestamp__1)s, %(open__1)s, %(high__1 ... 10570 characters truncated ... ol__99)s, %(timestamp__99)s, %(open__99)s, %(high__99)s, %(low__99)s, %(close__99)s, %(volume__99)s)]
[parameters: {'high__0': 145.6999969482422, 'close__0': 141.8000030517578, 'open__0': 139.39999389648438, 'low__0': 136.39999389648438, 'volume__0': 567867, 'symbol__0': 'DNP', 'timestamp__0': datetime.datetime(2020, 2, 28, 0, 0), 'high__1': 154.6999969482422, 'close__1': 151.8000030517578, 'open__1': 146.60000610351562, 'low__1': 146.60000610351562, 'volume__1': 375327, 'symbol__1': 'DNP', 'timestamp__1': datetime.datetime(2020, 3, 2, 0, 0), 'high__2': 161.10000610351562, 'close__2': 155.0, 'open__2': 153.0, 'low__2': 153.0, 'volume__2': 343482, 'symbol__2': 'DNP', 'timestamp__2': datetime.datetime(2020, 3, 3, 0, 0), 'high__3': 158.0, 'close__3': 154.6999969482422, 'open__3': 152.1999969482422, 'low__3': 152.1999969482422, 'volume__3': 134702, 'symbol__3': 'DNP', 'timestamp__3': datetime.datetime(2020, 3, 4, 0, 0), 'high__4': 159.1999969482422, 'close__4': 157.89999389648438, 'open__4': 157.39999389648438, 'low__4': 155.1999969482422, 'volume__4': 133927, 'symbol__4': 'DNP', 'timestamp__4': datetime.datetime(2020, 3, 5, 0, 0), 'high__5': 157.1999969482422, 'close__5': 156.5, 'open__5': 156.0, 'low__5': 153.1999969482422, 'volume__5': 137724, 'symbol__5': 'DNP', 'timestamp__5': datetime.datetime(2020, 3, 6, 0, 0), 'high__6': 152.0, 'close__6': 145.60000610351562, 'open__6': 145.0, 'low__6': 144.6999969482422, 'volume__6': 199497, 'symbol__6': 'DNP', 'timestamp__6': datetime.datetime(2020, 3, 9, 0, 0), 'high__7': 153.0 ... 600 parameters truncated ... 'timestamp__92': datetime.datetime(2020, 7, 7, 0, 0), 'high__93': 203.1999969482422, 'close__93': 199.0, 'open__93': 203.1999969482422, 'low__93': 198.39999389648438, 'volume__93': 232646, 'symbol__93': 'DNP', 'timestamp__93': datetime.datetime(2020, 7, 8, 0, 0), 'high__94': 200.60000610351562, 'close__94': 196.1999969482422, 'open__94': 200.0, 'low__94': 193.89999389648438, 'volume__94': 190262, 'symbol__94': 'DNP', 'timestamp__94': datetime.datetime(2020, 7, 9, 0, 0), 'high__95': 202.0, 'close__95': 201.8000030517578, 'open__95': 196.5, 'low__95': 196.39999389648438, 'volume__95': 202560, 'symbol__95': 'DNP', 'timestamp__95': datetime.datetime(2020, 7, 10, 0, 0), 'high__96': 203.1999969482422, 'close__96': 203.1999969482422, 'open__96': 202.1999969482422, 'low__96': 198.8000030517578, 'volume__96': 142095, 'symbol__96': 'DNP', 'timestamp__96': datetime.datetime(2020, 7, 13, 0, 0), 'high__97': 203.0, 'close__97': 200.0, 'open__97': 202.39999389648438, 'low__97': 199.0, 'volume__97': 182156, 'symbol__97': 'DNP', 'timestamp__97': datetime.datetime(2020, 7, 14, 0, 0), 'high__98': 201.39999389648438, 'close__98': 201.0, 'open__98': 201.0, 'low__98': 199.1999969482422, 'volume__98': 127360, 'symbol__98': 'DNP', 'timestamp__98': datetime.datetime(2020, 7, 15, 0, 0), 'high__99': 201.39999389648438, 'close__99': 199.60000610351562, 'open__99': 201.39999389648438, 'low__99': 198.1999969482422, 'volume__99': 69413, 'symbol__99': 'DNP', 'timestamp__99': datetime.datetime(2020, 7, 16, 0, 0)}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-02-26 23:00:53,432 - historical_importer - ERROR - Data columns: [('Date', ''), ('Close', 'DNP.WA'), ('High', 'DNP.WA'), ('Low', 'DNP.WA'), ('Open', 'DNP.WA'), ('Volume', 'DNP.WA'), ('symbol', '')]
2025-02-26 23:00:53,433 - historical_importer - ERROR - Data types: Price   Ticker
Date              datetime64[ns]
Close   DNP.WA           float64
High    DNP.WA           float64
Low     DNP.WA           float64
Open    DNP.WA           float64
Volume  DNP.WA             int64
symbol                    object
dtype: object
2025-02-26 23:00:53,433 - historical_importer - INFO - Imported 0 records for DNP
2025-02-26 23:00:54,440 - historical_importer - INFO - Completed historical data import. Processed 0 records for 12 symbols
2025-02-26 23:01:21,636 - historical_importer - INFO - Starting historical data import
2025-02-26 23:01:21,724 - historical_importer - INFO - Importing 5 years of historical data
2025-02-26 23:01:21,733 - historical_importer - INFO - Fetching 5 years of data for PKO.WA
2025-02-26 23:01:22,556 - historical_importer - ERROR - Error saving historical data: (psycopg2.errors.UndefinedColumn) column "symbol" of relation "staging_stock_prices" does not exist
LINE 1: INSERT INTO staging_stock_prices (symbol, timestamp, open, h...
                                          ^

[SQL: INSERT INTO staging_stock_prices (symbol, timestamp, open, high, low, close, volume) VALUES (%(symbol__0)s, %(timestamp__0)s, %(open__0)s, %(high__0)s, %(low__0)s, %(close__0)s, %(volume__0)s), (%(symbol__1)s, %(timestamp__1)s, %(open__1)s, %(high__1 ... 10570 characters truncated ... ol__99)s, %(timestamp__99)s, %(open__99)s, %(high__99)s, %(low__99)s, %(close__99)s, %(volume__99)s)]
[parameters: {'low__0': 26.37897223894127, 'symbol__0': 'PKO', 'open__0': 27.249935555910863, 'high__0': 27.646612683488865, 'volume__0': 5575049, 'timestamp__0': datetime.datetime(2020, 2, 28, 0, 0), 'close__0': 26.98261070251465, 'low__1': 27.00848145423398, 'symbol__1': 'PKO', 'open__1': 27.879446467992434, 'high__1': 28.06915898133804, 'volume__1': 3913456, 'timestamp__1': datetime.datetime(2020, 3, 2, 0, 0), 'close__1': 27.896690368652344, 'low__2': 28.069159362997492, 'symbol__2': 'PKO', 'open__2': 28.15539531529549, 'high__2': 29.129836904523703, 'volume__2': 4036412, 'timestamp__2': datetime.datetime(2020, 3, 3, 0, 0), 'close__2': 28.543445587158203, 'low__3': 28.034663965227118, 'symbol__3': 'PKO', 'open__3': 28.45721189224793, 'high__3': 28.767654730130143, 'volume__3': 2754026, 'timestamp__3': datetime.datetime(2020, 3, 4, 0, 0), 'close__3': 28.077783584594727, 'low__4': 27.2844295501709, 'symbol__4': 'PKO', 'open__4': 28.241627212560626, 'high__4': 28.508953723090908, 'volume__4': 2759371, 'timestamp__4': datetime.datetime(2020, 3, 5, 0, 0), 'close__4': 27.2844295501709, 'low__5': 26.189259343166423, 'symbol__5': 'PKO', 'open__5': 27.01710472669297, 'high__5': 27.344793113143254, 'volume__5': 2964149, 'timestamp__5': datetime.datetime(2020, 3, 6, 0, 0), 'close__5': 26.404844284057617, 'low__6': 23.67122607370572, 'symbol__6': 'PKO', 'open__6': 25.007851987540583, 'high__6': 25.4045274709508, 'volume__6': 3523517, 'timestamp__6': datetime.datetime(2020, 3, 9, 0, 0), 'close__6': 23.904056549072266, 'low__7': 23.5591224466416 ... 600 parameters truncated ... 'close__92': 20.11838722229004, 'low__93': 19.77345022421668, 'symbol__93': 'PKO', 'open__93': 19.945917182929836, 'high__93': 20.135632975731557, 'volume__93': 1671837, 'timestamp__93': datetime.datetime(2020, 7, 8, 0, 0), 'close__93': 20.10976219177246, 'low__94': 19.98041322991959, 'symbol__94': 'PKO', 'open__94': 20.135634657070273, 'high__94': 20.29947967959406, 'volume__94': 1839308, 'timestamp__94': datetime.datetime(2020, 7, 9, 0, 0), 'close__94': 20.083894729614258, 'low__95': 19.842439016836035, 'symbol__95': 'PKO', 'open__95': 19.842439016836035, 'high__95': 20.308101654052734, 'volume__95': 1670974, 'timestamp__95': datetime.datetime(2020, 7, 10, 0, 0), 'close__95': 20.308101654052734, 'low__96': 20.26498487474889, 'symbol__96': 'PKO', 'open__96': 20.523686151407112, 'high__96': 20.566804127371885, 'volume__96': 2225157, 'timestamp__96': datetime.datetime(2020, 7, 13, 0, 0), 'close__96': 20.446075439453125, 'low__97': 20.08389499500953, 'symbol__97': 'PKO', 'open__97': 20.264985565889887, 'high__97': 20.446076136770248, 'volume__97': 3154135, 'timestamp__97': datetime.datetime(2020, 7, 14, 0, 0), 'close__97': 20.273609161376953, 'low__98': 20.204620040580465, 'symbol__98': 'PKO', 'open__98': 20.437452161316404, 'high__98': 20.834127645726525, 'volume__98': 3341765, 'timestamp__98': datetime.datetime(2020, 7, 15, 0, 0), 'close__98': 20.765140533447266, 'low__99': 20.420206341414556, 'symbol__99': 'PKO', 'open__99': 20.627167692131007, 'high__99': 20.704778404247502, 'volume__99': 1764162, 'timestamp__99': datetime.datetime(2020, 7, 16, 0, 0), 'close__99': 20.609920501708984}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-02-26 23:01:22,557 - historical_importer - ERROR - Data columns: [('Date', ''), ('Close', 'PKO.WA'), ('High', 'PKO.WA'), ('Low', 'PKO.WA'), ('Open', 'PKO.WA'), ('Volume', 'PKO.WA'), ('symbol', '')]
2025-02-26 23:01:22,559 - historical_importer - ERROR - Data types: Price   Ticker
Date              datetime64[ns]
Close   PKO.WA           float64
High    PKO.WA           float64
Low     PKO.WA           float64
Open    PKO.WA           float64
Volume  PKO.WA             int64
symbol                    object
dtype: object
2025-02-26 23:01:22,560 - historical_importer - INFO - Imported 0 records for PKO
2025-02-26 23:01:23,564 - historical_importer - INFO - Fetching 5 years of data for PKN.WA
2025-02-26 23:01:23,865 - historical_importer - ERROR - Error saving historical data: (psycopg2.errors.UndefinedColumn) column "symbol" of relation "staging_stock_prices" does not exist
LINE 1: INSERT INTO staging_stock_prices (symbol, timestamp, open, h...
                                          ^

[SQL: INSERT INTO staging_stock_prices (symbol, timestamp, open, high, low, close, volume) VALUES (%(symbol__0)s, %(timestamp__0)s, %(open__0)s, %(high__0)s, %(low__0)s, %(close__0)s, %(volume__0)s), (%(symbol__1)s, %(timestamp__1)s, %(open__1)s, %(high__1 ... 10570 characters truncated ... ol__99)s, %(timestamp__99)s, %(open__99)s, %(high__99)s, %(low__99)s, %(close__99)s, %(volume__99)s)]
[parameters: {'low__0': 42.193363014034006, 'symbol__0': 'PKN', 'open__0': 45.61237386583663, 'high__0': 45.81168715400911, 'volume__0': 3039912, 'timestamp__0': datetime.datetime(2020, 2, 28, 0, 0), 'close__0': 44.953102111816406, 'low__1': 45.658370389394996, 'symbol__1': 'PKN', 'open__1': 47.14556269649454, 'high__1': 47.68217944213285, 'volume__1': 2037669, 'timestamp__1': datetime.datetime(2020, 3, 2, 0, 0), 'close__1': 46.424964904785156, 'low__2': 46.470957789639094, 'symbol__2': 'PKN', 'open__2': 47.37553953394432, 'high__2': 48.14213403424868, 'volume__2': 1804094, 'timestamp__2': datetime.datetime(2020, 3, 3, 0, 0), 'close__2': 47.728172302246094, 'low__3': 45.25973892211914, 'symbol__3': 'PKN', 'open__3': 47.52885788715139, 'high__3': 47.52885788715139, 'volume__3': 1696461, 'timestamp__3': datetime.datetime(2020, 3, 4, 0, 0), 'close__3': 45.25973892211914, 'low__4': 43.35858425569141, 'symbol__4': 'PKN', 'open__4': 46.30230713608854, 'high__4': 46.455623690556216, 'volume__4': 1742634, 'timestamp__4': datetime.datetime(2020, 3, 5, 0, 0), 'close__4': 43.58856201171875, 'low__5': 41.0281386445757, 'symbol__5': 'PKN', 'open__5': 43.128605970417624, 'high__5': 43.312589940052256, 'volume__5': 1785479, 'timestamp__5': datetime.datetime(2020, 3, 6, 0, 0), 'close__5': 41.65674591064453, 'low__6': 37.77777492276698, 'symbol__6': 'PKN', 'open__6': 38.32972388245866, 'high__6': 43.02128126686036, 'volume__6': 3127163, 'timestamp__6': datetime.datetime(2020, 3, 9, 0, 0), 'close__6': 41.58008575439453, 'low__7': 39.142317611214835 ... 600 parameters truncated ... 'close__92': 48.540767669677734, 'low__93': 46.93091652553708, 'symbol__93': 'PKN', 'open__93': 48.4181088122786, 'high__93': 48.46410553532972, 'volume__93': 1822974, 'timestamp__93': datetime.datetime(2020, 7, 8, 0, 0), 'close__93': 47.34487533569336, 'low__94': 46.65494231401737, 'symbol__94': 'PKN', 'open__94': 47.52885958691691, 'high__94': 47.66684683256694, 'volume__94': 1160444, 'timestamp__94': datetime.datetime(2020, 7, 9, 0, 0), 'close__94': 46.915584564208984, 'low__95': 45.99566955454123, 'symbol__95': 'PKN', 'open__95': 46.762264047116915, 'high__95': 47.09956457109289, 'volume__95': 853408, 'timestamp__95': datetime.datetime(2020, 7, 10, 0, 0), 'close__95': 47.084232330322266, 'low__96': 47.53621976683114, 'symbol__96': 'PKN', 'open__96': 47.86351690225165, 'high__96': 48.393429098126205, 'volume__96': 660364, 'timestamp__96': datetime.datetime(2020, 7, 13, 0, 0), 'close__96': 47.83234786987305, 'low__97': 45.588016510009766, 'symbol__97': 'PKN', 'open__97': 48.299918673878075, 'high__97': 49.936413357873114, 'volume__97': 3172279, 'timestamp__97': datetime.datetime(2020, 7, 14, 0, 0), 'close__97': 45.588016510009766, 'low__98': 44.69963668801589, 'symbol__98': 'PKN', 'open__98': 46.33612845649158, 'high__98': 46.33612845649158, 'volume__98': 3522263, 'timestamp__98': datetime.datetime(2020, 7, 15, 0, 0), 'close__98': 44.82432174682617, 'low__99': 44.21647980413767, 'symbol__99': 'PKN', 'open__99': 44.73080601246605, 'high__99': 46.47639673109067, 'volume__99': 1646698, 'timestamp__99': datetime.datetime(2020, 7, 16, 0, 0), 'close__99': 46.27378463745117}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-02-26 23:01:23,865 - historical_importer - ERROR - Data columns: [('Date', ''), ('Close', 'PKN.WA'), ('High', 'PKN.WA'), ('Low', 'PKN.WA'), ('Open', 'PKN.WA'), ('Volume', 'PKN.WA'), ('symbol', '')]
2025-02-26 23:01:23,869 - historical_importer - ERROR - Data types: Price   Ticker
Date              datetime64[ns]
Close   PKN.WA           float64
High    PKN.WA           float64
Low     PKN.WA           float64
Open    PKN.WA           float64
Volume  PKN.WA             int64
symbol                    object
dtype: object
2025-02-26 23:01:23,870 - historical_importer - INFO - Imported 0 records for PKN
2025-02-26 23:01:24,876 - historical_importer - INFO - Fetching 5 years of data for PZU.WA
2025-02-26 23:01:25,090 - historical_importer - ERROR - Error saving historical data: (psycopg2.errors.UndefinedColumn) column "symbol" of relation "staging_stock_prices" does not exist
LINE 1: INSERT INTO staging_stock_prices (symbol, timestamp, open, h...
                                          ^

[SQL: INSERT INTO staging_stock_prices (symbol, timestamp, open, high, low, close, volume) VALUES (%(symbol__0)s, %(timestamp__0)s, %(open__0)s, %(high__0)s, %(low__0)s, %(close__0)s, %(volume__0)s), (%(symbol__1)s, %(timestamp__1)s, %(open__1)s, %(high__1 ... 10570 characters truncated ... ol__99)s, %(timestamp__99)s, %(open__99)s, %(high__99)s, %(low__99)s, %(close__99)s, %(volume__99)s)]
[parameters: {'low__0': 24.93122999677175, 'symbol__0': 'PZU', 'open__0': 26.078997753054264, 'high__0': 26.078997753054264, 'volume__0': 3567606, 'timestamp__0': datetime.datetime(2020, 2, 28, 0, 0), 'close__0': 25.24359703063965, 'low__1': 24.698770335910552, 'symbol__1': 'PZU', 'open__1': 25.85380117717029, 'high__1': 26.093523095326702, 'volume__1': 2421089, 'timestamp__1': datetime.datetime(2020, 3, 2, 0, 0), 'close__1': 25.388883590698242, 'low__2': 25.54869730027647, 'symbol__2': 'PZU', 'open__2': 25.628605530103997, 'high__2': 26.58023562085308, 'volume__2': 2335620, 'timestamp__2': datetime.datetime(2020, 3, 3, 0, 0), 'close__2': 26.376834869384766, 'low__3': 26.158901307888918, 'symbol__3': 'PZU', 'open__3': 26.304188740910185, 'high__3': 26.979772949000868, 'volume__3': 2231654, 'timestamp__3': datetime.datetime(2020, 3, 4, 0, 0), 'close__3': 26.58749771118164, 'low__4': 26.006351470947266, 'symbol__4': 'PZU', 'open__4': 26.878073322105905, 'high__4': 27.342990903756547, 'volume__4': 1854994, 'timestamp__4': datetime.datetime(2020, 3, 5, 0, 0), 'close__4': 26.006351470947266, 'low__5': 24.953020726525917, 'symbol__5': 'PZU', 'open__5': 25.635870841383024, 'high__5': 26.049938230928262, 'volume__5': 2346680, 'timestamp__5': datetime.datetime(2020, 3, 6, 0, 0), 'close__5': 25.279916763305664, 'low__6': 22.613901472038364, 'symbol__6': 'PZU', 'open__6': 23.97233436221168, 'high__6': 24.081300626854443, 'volume__6': 2706524, 'timestamp__6': datetime.datetime(2020, 3, 9, 0, 0), 'close__6': 22.88268280029297, 'low__7': 22.59211219466746 ... 600 parameters truncated ... 'close__92': 21.044803619384766, 'low__93': 20.7978166261648, 'symbol__93': 'PZU', 'open__93': 20.99395425013108, 'high__93': 21.037539926935693, 'volume__93': 1673632, 'timestamp__93': datetime.datetime(2020, 7, 8, 0, 0), 'close__93': 20.892253875732422, 'low__94': 20.805080865707822, 'symbol__94': 'PZU', 'open__94': 20.921310259382775, 'high__94': 21.13197690139592, 'volume__94': 1450553, 'timestamp__94': datetime.datetime(2020, 7, 9, 0, 0), 'close__94': 20.943103790283203, 'low__95': 20.57262365313996, 'symbol__95': 'PZU', 'open__95': 20.841405012565108, 'high__95': 20.99395558385447, 'volume__95': 1871238, 'timestamp__95': datetime.datetime(2020, 7, 10, 0, 0), 'close__95': 20.884990692138672, 'low__96': 20.906782150268555, 'symbol__96': 'PZU', 'open__96': 21.182826607596127, 'high__96': 21.204620138002372, 'volume__96': 1824536, 'timestamp__96': datetime.datetime(2020, 7, 13, 0, 0), 'close__96': 20.906782150268555, 'low__97': 20.74696803172268, 'symbol__97': 'PZU', 'open__97': 20.877726457738603, 'high__97': 21.066599585810074, 'volume__97': 1626649, 'timestamp__97': datetime.datetime(2020, 7, 14, 0, 0), 'close__97': 20.83414077758789, 'low__98': 20.884989713801954, 'symbol__98': 'PZU', 'open__98': 21.044804788461153, 'high__98': 21.270000457763672, 'volume__98': 2018034, 'timestamp__98': datetime.datetime(2020, 7, 15, 0, 0), 'close__98': 21.270000457763672, 'low__99': 21.10291802578162, 'symbol__99': 'PZU', 'open__99': 21.16829723033413, 'high__99': 21.364434843991667, 'volume__99': 1454592, 'timestamp__99': datetime.datetime(2020, 7, 16, 0, 0), 'close__99': 21.197355270385742}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-02-26 23:01:25,091 - historical_importer - ERROR - Data columns: [('Date', ''), ('Close', 'PZU.WA'), ('High', 'PZU.WA'), ('Low', 'PZU.WA'), ('Open', 'PZU.WA'), ('Volume', 'PZU.WA'), ('symbol', '')]
2025-02-26 23:01:25,091 - historical_importer - ERROR - Data types: Price   Ticker
Date              datetime64[ns]
Close   PZU.WA           float64
High    PZU.WA           float64
Low     PZU.WA           float64
Open    PZU.WA           float64
Volume  PZU.WA             int64
symbol                    object
dtype: object
2025-02-26 23:01:25,092 - historical_importer - INFO - Imported 0 records for PZU
2025-02-26 23:01:26,100 - historical_importer - INFO - Fetching 5 years of data for PEO.WA
2025-02-26 23:01:26,429 - historical_importer - ERROR - Error saving historical data: (psycopg2.errors.UndefinedColumn) column "symbol" of relation "staging_stock_prices" does not exist
LINE 1: INSERT INTO staging_stock_prices (symbol, timestamp, open, h...
                                          ^

[SQL: INSERT INTO staging_stock_prices (symbol, timestamp, open, high, low, close, volume) VALUES (%(symbol__0)s, %(timestamp__0)s, %(open__0)s, %(high__0)s, %(low__0)s, %(close__0)s, %(volume__0)s), (%(symbol__1)s, %(timestamp__1)s, %(open__1)s, %(high__1 ... 10570 characters truncated ... ol__99)s, %(timestamp__99)s, %(open__99)s, %(high__99)s, %(low__99)s, %(close__99)s, %(volume__99)s)]
[parameters: {'low__0': 68.93540847547385, 'symbol__0': 'PEO', 'open__0': 71.66149316759018, 'high__0': 72.46051459069695, 'volume__0': 1628582, 'timestamp__0': datetime.datetime(2020, 2, 28, 0, 0), 'close__0': 68.96674346923828, 'low__1': 68.27739125679365, 'symbol__1': 'PEO', 'open__1': 70.42378752029794, 'high__1': 72.63285377107478, 'volume__1': 756361, 'timestamp__1': datetime.datetime(2020, 3, 2, 0, 0), 'close__1': 69.92243957519531, 'low__2': 70.51777897129502, 'symbol__2': 'PEO', 'open__2': 70.6587834392854, 'high__2': 74.63823755675764, 'volume__2': 998119, 'timestamp__2': datetime.datetime(2020, 3, 3, 0, 0), 'close__2': 74.2465591430664, 'low__3': 73.16553395056627, 'symbol__3': 'PEO', 'open__3': 73.94889083231422, 'high__3': 75.1082556704395, 'volume__3': 527940, 'timestamp__3': datetime.datetime(2020, 3, 4, 0, 0), 'close__3': 73.7452163696289, 'low__4': 72.58585313435901, 'symbol__4': 'PEO', 'open__4': 74.6695793780217, 'high__4': 74.99858784125176, 'volume__4': 515614, 'timestamp__4': datetime.datetime(2020, 3, 5, 0, 0), 'close__4': 72.77385711669922, 'low__5': 69.57775459211557, 'symbol__5': 'PEO', 'open__5': 71.99049510417028, 'high__5': 72.38217352587247, 'volume__5': 940230, 'timestamp__5': datetime.datetime(2020, 3, 6, 0, 0), 'close__5': 70.2514419555664, 'low__6': 63.091558582014706, 'symbol__6': 'PEO', 'open__6': 66.58532925888454, 'high__6': 67.36868607369495, 'volume__6': 833133, 'timestamp__6': datetime.datetime(2020, 3, 9, 0, 0), 'close__6': 64.47026824951172, 'low__7': 62.66855224685472 ... 600 parameters truncated ... 'close__92': 43.17863082885742, 'low__93': 42.53627922417945, 'symbol__93': 'PEO', 'open__93': 42.849623180605704, 'high__93': 43.131632143735445, 'volume__93': 543075, 'timestamp__93': datetime.datetime(2020, 7, 8, 0, 0), 'close__93': 42.69295120239258, 'low__94': 42.614616118958324, 'symbol__94': 'PEO', 'open__94': 43.06896156240598, 'high__94': 43.38230551450529, 'volume__94': 406571, 'timestamp__94': datetime.datetime(2020, 7, 9, 0, 0), 'close__94': 43.08462905883789, 'low__95': 42.28560181259364, 'symbol__95': 'PEO', 'open__95': 42.69294772748488, 'high__95': 43.63297653198242, 'volume__95': 551367, 'timestamp__95': datetime.datetime(2020, 7, 10, 0, 0), 'close__95': 43.63297653198242, 'low__96': 43.695646054918726, 'symbol__96': 'PEO', 'open__96': 43.86798552573029, 'high__96': 44.228328975364136, 'volume__96': 532016, 'timestamp__96': datetime.datetime(2020, 7, 13, 0, 0), 'close__96': 43.75831604003906, 'low__97': 42.59894862252642, 'symbol__97': 'PEO', 'open__97': 43.476307504827325, 'high__97': 43.85231845438486, 'volume__97': 823747, 'timestamp__97': datetime.datetime(2020, 7, 14, 0, 0), 'close__97': 43.08462905883789, 'low__98': 43.10029306728444, 'symbol__98': 'PEO', 'open__98': 43.1629600596712, 'high__98': 44.60433674379654, 'volume__98': 1090942, 'timestamp__98': datetime.datetime(2020, 7, 15, 0, 0), 'close__98': 44.400665283203125, 'low__99': 43.57030631010989, 'symbol__99': 'PEO', 'open__99': 44.25966116137409, 'high__99': 44.25966116137409, 'volume__99': 555936, 'timestamp__99': datetime.datetime(2020, 7, 16, 0, 0), 'close__99': 44.102989196777344}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-02-26 23:01:26,430 - historical_importer - ERROR - Data columns: [('Date', ''), ('Close', 'PEO.WA'), ('High', 'PEO.WA'), ('Low', 'PEO.WA'), ('Open', 'PEO.WA'), ('Volume', 'PEO.WA'), ('symbol', '')]
2025-02-26 23:01:26,437 - historical_importer - ERROR - Data types: Price   Ticker
Date              datetime64[ns]
Close   PEO.WA           float64
High    PEO.WA           float64
Low     PEO.WA           float64
Open    PEO.WA           float64
Volume  PEO.WA             int64
symbol                    object
dtype: object
2025-02-26 23:01:26,439 - historical_importer - INFO - Imported 0 records for PEO
2025-02-26 23:01:27,449 - historical_importer - INFO - Fetching 5 years of data for KGH.WA
2025-02-26 23:01:27,737 - historical_importer - ERROR - Error saving historical data: (psycopg2.errors.UndefinedColumn) column "symbol" of relation "staging_stock_prices" does not exist
LINE 1: INSERT INTO staging_stock_prices (symbol, timestamp, open, h...
                                          ^

[SQL: INSERT INTO staging_stock_prices (symbol, timestamp, open, high, low, close, volume) VALUES (%(symbol__0)s, %(timestamp__0)s, %(open__0)s, %(high__0)s, %(low__0)s, %(close__0)s, %(volume__0)s), (%(symbol__1)s, %(timestamp__1)s, %(open__1)s, %(high__1 ... 10570 characters truncated ... ol__99)s, %(timestamp__99)s, %(open__99)s, %(high__99)s, %(low__99)s, %(close__99)s, %(volume__99)s)]
[parameters: {'low__0': 65.5093961930252, 'symbol__0': 'KGH', 'open__0': 69.06562341377244, 'high__0': 70.18863877824128, 'volume__0': 1779132, 'timestamp__0': datetime.datetime(2020, 2, 28, 0, 0), 'close__0': 66.01475524902344, 'low__1': 66.16449329671163, 'symbol__1': 'KGH', 'open__1': 69.25279653888859, 'high__1': 70.67528327215983, 'volume__1': 1182780, 'timestamp__1': datetime.datetime(2020, 3, 2, 0, 0), 'close__1': 68.31694793701172, 'low__2': 69.60840722241683, 'symbol__2': 'KGH', 'open__2': 70.18863584915445, 'high__2': 73.91331593313078, 'volume__2': 1200095, 'timestamp__2': datetime.datetime(2020, 3, 3, 0, 0), 'close__2': 72.82772827148438, 'low__3': 70.7501449584961, 'symbol__3': 'KGH', 'open__3': 72.30365689098741, 'high__3': 73.74486443343298, 'volume__3': 584674, 'timestamp__3': datetime.datetime(2020, 3, 4, 0, 0), 'close__3': 70.7501449584961, 'low__4': 68.33566205196782, 'symbol__4': 'KGH', 'open__4': 72.19136087813783, 'high__4': 72.37852774330915, 'volume__4': 619956, 'timestamp__4': datetime.datetime(2020, 3, 5, 0, 0), 'close__4': 68.42925262451172, 'low__5': 64.62969687431163, 'symbol__5': 'KGH', 'open__5': 67.11905737886171, 'high__5': 67.2126408034029, 'volume__5': 950443, 'timestamp__5': datetime.datetime(2020, 3, 6, 0, 0), 'close__5': 65.47196197509766, 'low__6': 57.03060671437491, 'symbol__6': 'KGH', 'open__6': 58.9397385248803, 'high__6': 61.485244035575406, 'volume__6': 1347285, 'timestamp__6': datetime.datetime(2020, 3, 9, 0, 0), 'close__6': 58.20977783203125, 'low__7': 58.022607416691336 ... 600 parameters truncated ... 'close__92': 90.77731323242188, 'low__93': 90.08477718871022, 'symbol__93': 'KGH', 'open__93': 90.21579540544771, 'high__93': 91.33881073175677, 'volume__93': 383054, 'timestamp__93': datetime.datetime(2020, 7, 8, 0, 0), 'close__93': 90.96446990966797, 'low__94': 91.4323985726549, 'symbol__94': 'KGH', 'open__94': 91.4323985726549, 'high__94': 95.78409566741375, 'volume__94': 1490117, 'timestamp__94': datetime.datetime(2020, 7, 9, 0, 0), 'close__94': 94.8950424194336, 'low__95': 92.64899758731617, 'symbol__95': 'KGH', 'open__95': 93.86560344192034, 'high__95': 95.45654296875, 'volume__95': 517415, 'timestamp__95': datetime.datetime(2020, 7, 10, 0, 0), 'close__95': 95.45654296875, 'low__96': 96.76673740944814, 'symbol__96': 'KGH', 'open__96': 97.32824508773201, 'high__96': 101.63314680785173, 'volume__96': 1245530, 'timestamp__96': datetime.datetime(2020, 7, 13, 0, 0), 'close__96': 100.83767700195312, 'low__97': 97.14108127863925, 'symbol__97': 'KGH', 'open__97': 99.19994521003422, 'high__97': 99.71466476286183, 'volume__97': 845888, 'timestamp__97': datetime.datetime(2020, 7, 14, 0, 0), 'close__97': 98.77881622314453, 'low__98': 98.2640972299741, 'symbol__98': 'KGH', 'open__98': 99.19994577502148, 'high__98': 100.83768072885437, 'volume__98': 682497, 'timestamp__98': datetime.datetime(2020, 7, 15, 0, 0), 'close__98': 100.22937774658203, 'low__99': 97.79616674975814, 'symbol__99': 'KGH', 'open__99': 98.63843181482886, 'high__99': 100.13578796386719, 'volume__99': 606082, 'timestamp__99': datetime.datetime(2020, 7, 16, 0, 0), 'close__99': 100.13578796386719}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-02-26 23:01:27,738 - historical_importer - ERROR - Data columns: [('Date', ''), ('Close', 'KGH.WA'), ('High', 'KGH.WA'), ('Low', 'KGH.WA'), ('Open', 'KGH.WA'), ('Volume', 'KGH.WA'), ('symbol', '')]
2025-02-26 23:01:27,739 - historical_importer - ERROR - Data types: Price   Ticker
Date              datetime64[ns]
Close   KGH.WA           float64
High    KGH.WA           float64
Low     KGH.WA           float64
Open    KGH.WA           float64
Volume  KGH.WA             int64
symbol                    object
dtype: object
2025-02-26 23:01:27,739 - historical_importer - INFO - Imported 0 records for KGH
2025-02-26 23:01:28,743 - historical_importer - INFO - Fetching 5 years of data for LPP.WA
2025-02-26 23:01:29,009 - historical_importer - ERROR - Error saving historical data: (psycopg2.errors.UndefinedColumn) column "symbol" of relation "staging_stock_prices" does not exist
LINE 1: INSERT INTO staging_stock_prices (symbol, timestamp, open, h...
                                          ^

[SQL: INSERT INTO staging_stock_prices (symbol, timestamp, open, high, low, close, volume) VALUES (%(symbol__0)s, %(timestamp__0)s, %(open__0)s, %(high__0)s, %(low__0)s, %(close__0)s, %(volume__0)s), (%(symbol__1)s, %(timestamp__1)s, %(open__1)s, %(high__1 ... 10570 characters truncated ... ol__99)s, %(timestamp__99)s, %(open__99)s, %(high__99)s, %(low__99)s, %(close__99)s, %(volume__99)s)]
[parameters: {'low__0': 5813.698935688406, 'symbol__0': 'LPP', 'open__0': 5900.470561594203, 'high__0': 6082.690975996376, 'volume__0': 6505, 'timestamp__0': datetime.datetime(2020, 2, 28, 0, 0), 'close__0': 5987.2421875, 'low__1': 5891.792835517961, 'symbol__1': 'LPP', 'open__1': 6108.721879535558, 'high__1': 6139.091945698023, 'volume__1': 4047, 'timestamp__1': datetime.datetime(2020, 3, 2, 0, 0), 'close__1': 5978.564453125, 'low__2': 5987.241747583107, 'symbol__2': 'LPP', 'open__2': 5987.241747583107, 'high__2': 6555.595855505851, 'volume__2': 4153, 'timestamp__2': datetime.datetime(2020, 3, 3, 0, 0), 'close__2': 6395.068359375, 'low__3': 6169.462793575311, 'symbol__3': 'LPP', 'open__3': 6316.974562198067, 'high__3': 6364.698957928959, 'volume__3': 2643, 'timestamp__3': datetime.datetime(2020, 3, 4, 0, 0), 'close__3': 6286.6044921875, 'low__4': 6160.78572762834, 'symbol__4': 'LPP', 'open__4': 6264.911683588256, 'high__4': 6334.328987561533, 'volume__4': 3178, 'timestamp__4': datetime.datetime(2020, 3, 5, 0, 0), 'close__4': 6169.462890625, 'low__5': 5852.745955362035, 'symbol__5': 'LPP', 'open__5': 6160.785216170562, 'high__5': 6169.4623784468595, 'volume__5': 4827, 'timestamp__5': datetime.datetime(2020, 3, 6, 0, 0), 'close__5': 5939.517578125, 'low__6': 5254.0219624180945, 'symbol__6': 'LPP', 'open__6': 5527.3525847404235, 'high__6': 5687.880093088457, 'volume__6': 5345, 'timestamp__6': datetime.datetime(2020, 3, 9, 0, 0), 'close__6': 5379.8408203125, 'low__7': 5201.958984375 ... 600 parameters truncated ... 'close__92': 5648.83251953125, 'low__93': 5635.817157024132, 'symbol__93': 'LPP', 'open__93': 5661.848645047337, 'high__93': 5783.328922488967, 'volume__93': 4217, 'timestamp__93': datetime.datetime(2020, 7, 8, 0, 0), 'close__93': 5713.91162109375, 'low__94': 5713.91220572238, 'symbol__94': 'LPP', 'open__94': 5783.329514220146, 'high__94': 5852.746822717912, 'volume__94': 6006, 'timestamp__94': datetime.datetime(2020, 7, 9, 0, 0), 'close__94': 5826.71533203125, 'low__95': 5687.880355060634, 'symbol__95': 'LPP', 'open__95': 5761.636240671642, 'high__95': 5813.69921875, 'volume__95': 3081, 'timestamp__95': datetime.datetime(2020, 7, 10, 0, 0), 'close__95': 5813.69921875, 'low__96': 5696.557497714428, 'symbol__96': 'LPP', 'open__96': 5857.085012882314, 'high__96': 5887.455083319482, 'volume__96': 2064, 'timestamp__96': datetime.datetime(2020, 7, 13, 0, 0), 'close__96': 5709.5732421875, 'low__97': 5449.258063218106, 'symbol__97': 'LPP', 'open__97': 5692.2186138074485, 'high__97': 5709.572938849545, 'volume__97': 5145, 'timestamp__97': datetime.datetime(2020, 7, 14, 0, 0), 'close__97': 5475.28955078125, 'low__98': 5483.967101435222, 'symbol__98': 'LPP', 'open__98': 5523.014335543541, 'high__98': 5592.431640625, 'volume__98': 3934, 'timestamp__98': datetime.datetime(2020, 7, 15, 0, 0), 'close__98': 5592.431640625, 'low__99': 5505.659927474869, 'symbol__99': 'LPP', 'open__99': 5553.384324009324, 'high__99': 5614.124465053176, 'volume__99': 4539, 'timestamp__99': datetime.datetime(2020, 7, 16, 0, 0), 'close__99': 5583.75439453125}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-02-26 23:01:29,010 - historical_importer - ERROR - Data columns: [('Date', ''), ('Close', 'LPP.WA'), ('High', 'LPP.WA'), ('Low', 'LPP.WA'), ('Open', 'LPP.WA'), ('Volume', 'LPP.WA'), ('symbol', '')]
2025-02-26 23:01:29,012 - historical_importer - ERROR - Data types: Price   Ticker
Date              datetime64[ns]
Close   LPP.WA           float64
High    LPP.WA           float64
Low     LPP.WA           float64
Open    LPP.WA           float64
Volume  LPP.WA             int64
symbol                    object
dtype: object
2025-02-26 23:01:29,012 - historical_importer - INFO - Imported 0 records for LPP
2025-02-26 23:01:30,017 - historical_importer - INFO - Fetching 5 years of data for SPL.WA
2025-02-26 23:01:30,269 - historical_importer - ERROR - Error saving historical data: (psycopg2.errors.UndefinedColumn) column "symbol" of relation "staging_stock_prices" does not exist
LINE 1: INSERT INTO staging_stock_prices (symbol, timestamp, open, h...
                                          ^

[SQL: INSERT INTO staging_stock_prices (symbol, timestamp, open, high, low, close, volume) VALUES (%(symbol__0)s, %(timestamp__0)s, %(open__0)s, %(high__0)s, %(low__0)s, %(close__0)s, %(volume__0)s), (%(symbol__1)s, %(timestamp__1)s, %(open__1)s, %(high__1 ... 10570 characters truncated ... ol__99)s, %(timestamp__99)s, %(open__99)s, %(high__99)s, %(low__99)s, %(close__99)s, %(volume__99)s)]
[parameters: {'low__0': 213.2640952074214, 'symbol__0': 'SPL', 'open__0': 221.3736602243684, 'high__0': 227.75777439247904, 'volume__0': 155782, 'timestamp__0': datetime.datetime(2020, 2, 28, 0, 0), 'close__0': 216.36988830566406, 'low__1': 217.4051492544321, 'symbol__1': 'SPL', 'open__1': 224.6519822972952, 'high__1': 225.8597834164241, 'volume__1': 108224, 'timestamp__1': datetime.datetime(2020, 3, 2, 0, 0), 'close__1': 224.30690002441406, 'low__2': 222.5814735213494, 'symbol__2': 'SPL', 'open__2': 224.30691130058466, 'high__2': 240.6985702033197, 'volume__2': 112138, 'timestamp__2': datetime.datetime(2020, 3, 3, 0, 0), 'close__2': 234.83209228515625, 'low__3': 231.20865090920108, 'symbol__3': 'SPL', 'open__3': 231.20865090920108, 'high__3': 238.45548395566254, 'volume__3': 53365, 'timestamp__3': datetime.datetime(2020, 3, 4, 0, 0), 'close__3': 236.3849639892578, 'low__4': 228.7930261462156, 'symbol__4': 'SPL', 'open__4': 232.93406567136046, 'high__4': 238.455460480916, 'volume__4': 58814, 'timestamp__4': datetime.datetime(2020, 3, 5, 0, 0), 'close__4': 230.17335510253906, 'low__5': 213.9542811098549, 'symbol__5': 'SPL', 'open__5': 225.51470877517244, 'high__5': 227.24014652605837, 'volume__5': 74158, 'timestamp__5': datetime.datetime(2020, 3, 6, 0, 0), 'close__5': 217.57769775390625, 'low__6': 192.21375492430423, 'symbol__6': 'SPL', 'open__6': 207.5701524888394, 'high__6': 208.7779535661664, 'volume__6': 121099, 'timestamp__6': datetime.datetime(2020, 3, 9, 0, 0), 'close__6': 196.69989013671875, 'low__7': 187.72762978085512 ... 600 parameters truncated ... 'close__92': 147.26609802246094, 'low__93': 145.1092991985244, 'symbol__93': 'SPL', 'open__93': 146.05829514199263, 'high__93': 148.12881499168532, 'volume__93': 44882, 'timestamp__93': datetime.datetime(2020, 7, 8, 0, 0), 'close__93': 146.48965454101562, 'low__94': 145.36811959021475, 'symbol__94': 'SPL', 'open__94': 146.83473893546739, 'high__94': 147.78373489277197, 'volume__94': 70001, 'timestamp__94': datetime.datetime(2020, 7, 9, 0, 0), 'close__94': 145.62693786621094, 'low__95': 143.38387100697895, 'symbol__95': 'SPL', 'open__95': 144.50540815080916, 'high__95': 145.79948643275668, 'volume__95': 96470, 'timestamp__95': datetime.datetime(2020, 7, 10, 0, 0), 'close__95': 144.936767578125, 'low__96': 145.1955708932463, 'symbol__96': 'SPL', 'open__96': 147.8699911683635, 'high__96': 150.54442460752438, 'volume__96': 92203, 'timestamp__96': datetime.datetime(2020, 7, 13, 0, 0), 'close__96': 147.95626831054688, 'low__97': 142.86626320620576, 'symbol__97': 'SPL', 'open__97': 146.7484984763304, 'high__97': 147.6974814217108, 'volume__97': 78783, 'timestamp__97': datetime.datetime(2020, 7, 14, 0, 0), 'close__97': 143.29762268066406, 'low__98': 141.0545379426427, 'symbol__98': 'SPL', 'open__98': 144.76423178739898, 'high__98': 145.1093140763805, 'volume__98': 130851, 'timestamp__98': datetime.datetime(2020, 7, 15, 0, 0), 'close__98': 142.0897979736328, 'low__99': 138.9840088732182, 'symbol__99': 'SPL', 'open__99': 143.1250487288011, 'high__99': 143.6426852927713, 'volume__99': 71690, 'timestamp__99': datetime.datetime(2020, 7, 16, 0, 0), 'close__99': 142.00352478027344}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-02-26 23:01:30,269 - historical_importer - ERROR - Data columns: [('Date', ''), ('Close', 'SPL.WA'), ('High', 'SPL.WA'), ('Low', 'SPL.WA'), ('Open', 'SPL.WA'), ('Volume', 'SPL.WA'), ('symbol', '')]
2025-02-26 23:01:30,270 - historical_importer - ERROR - Data types: Price   Ticker
Date              datetime64[ns]
Close   SPL.WA           float64
High    SPL.WA           float64
Low     SPL.WA           float64
Open    SPL.WA           float64
Volume  SPL.WA             int64
symbol                    object
dtype: object
2025-02-26 23:01:30,270 - historical_importer - INFO - Imported 0 records for SPL
2025-02-26 23:01:31,275 - historical_importer - INFO - Fetching 5 years of data for ALE.WA
2025-02-26 23:01:31,501 - historical_importer - ERROR - Error saving historical data: (psycopg2.errors.UndefinedColumn) column "symbol" of relation "staging_stock_prices" does not exist
LINE 1: INSERT INTO staging_stock_prices (symbol, timestamp, open, h...
                                          ^

[SQL: INSERT INTO staging_stock_prices (symbol, timestamp, open, high, low, close, volume) VALUES (%(symbol__0)s, %(timestamp__0)s, %(open__0)s, %(high__0)s, %(low__0)s, %(close__0)s, %(volume__0)s), (%(symbol__1)s, %(timestamp__1)s, %(open__1)s, %(high__1 ... 10570 characters truncated ... ol__99)s, %(timestamp__99)s, %(open__99)s, %(high__99)s, %(low__99)s, %(close__99)s, %(volume__99)s)]
[parameters: {'low__0': 71.08000183105469, 'symbol__0': 'ALE', 'open__0': 72.0, 'high__0': 80.0, 'volume__0': 18452974, 'timestamp__0': datetime.datetime(2020, 10, 13, 0, 0), 'close__0': 80.0, 'low__1': 71.25, 'symbol__1': 'ALE', 'open__1': 84.0, 'high__1': 90.30000305175781, 'volume__1': 16731591, 'timestamp__1': datetime.datetime(2020, 10, 14, 0, 0), 'close__1': 75.95999908447266, 'low__2': 71.5199966430664, 'symbol__2': 'ALE', 'open__2': 76.0, 'high__2': 80.0, 'volume__2': 6235974, 'timestamp__2': datetime.datetime(2020, 10, 15, 0, 0), 'close__2': 79.22000122070312, 'low__3': 79.25, 'symbol__3': 'ALE', 'open__3': 80.0, 'high__3': 85.44000244140625, 'volume__3': 15480831, 'timestamp__3': datetime.datetime(2020, 10, 16, 0, 0), 'close__3': 81.44999694824219, 'low__4': 79.80000305175781, 'symbol__4': 'ALE', 'open__4': 81.44999694824219, 'high__4': 83.62000274658203, 'volume__4': 3205087, 'timestamp__4': datetime.datetime(2020, 10, 19, 0, 0), 'close__4': 83.4000015258789, 'low__5': 83.33000183105469, 'symbol__5': 'ALE', 'open__5': 83.44999694824219, 'high__5': 85.5999984741211, 'volume__5': 3048042, 'timestamp__5': datetime.datetime(2020, 10, 20, 0, 0), 'close__5': 85.0, 'low__6': 82.12000274658203, 'symbol__6': 'ALE', 'open__6': 85.98999786376953, 'high__6': 85.98999786376953, 'volume__6': 2734889, 'timestamp__6': datetime.datetime(2020, 10, 21, 0, 0), 'close__6': 84.16999816894531, 'low__7': 83.72000122070312 ... 600 parameters truncated ... 'close__92': 64.44999694824219, 'low__93': 61.5, 'symbol__93': 'ALE', 'open__93': 64.0999984741211, 'high__93': 64.43000030517578, 'volume__93': 1624343, 'timestamp__93': datetime.datetime(2021, 2, 26, 0, 0), 'close__93': 64.31999969482422, 'low__94': 62.5, 'symbol__94': 'ALE', 'open__94': 65.0, 'high__94': 65.3499984741211, 'volume__94': 1347372, 'timestamp__94': datetime.datetime(2021, 3, 1, 0, 0), 'close__94': 63.06999969482422, 'low__95': 63.189998626708984, 'symbol__95': 'ALE', 'open__95': 63.95000076293945, 'high__95': 67.45999908447266, 'volume__95': 3120360, 'timestamp__95': datetime.datetime(2021, 3, 2, 0, 0), 'close__95': 66.76000213623047, 'low__96': 65.0199966430664, 'symbol__96': 'ALE', 'open__96': 67.5, 'high__96': 68.19999694824219, 'volume__96': 2887525, 'timestamp__96': datetime.datetime(2021, 3, 3, 0, 0), 'close__96': 66.45999908447266, 'low__97': 63.689998626708984, 'symbol__97': 'ALE', 'open__97': 67.0, 'high__97': 67.37999725341797, 'volume__97': 3554548, 'timestamp__97': datetime.datetime(2021, 3, 4, 0, 0), 'close__97': 64.73999786376953, 'low__98': 63.459999084472656, 'symbol__98': 'ALE', 'open__98': 63.720001220703125, 'high__98': 64.3499984741211, 'volume__98': 2512451, 'timestamp__98': datetime.datetime(2021, 3, 5, 0, 0), 'close__98': 64.0, 'low__99': 63.029998779296875, 'symbol__99': 'ALE', 'open__99': 64.0999984741211, 'high__99': 65.0, 'volume__99': 1529124, 'timestamp__99': datetime.datetime(2021, 3, 8, 0, 0), 'close__99': 63.540000915527344}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-02-26 23:01:31,506 - historical_importer - ERROR - Data columns: [('Date', ''), ('Close', 'ALE.WA'), ('High', 'ALE.WA'), ('Low', 'ALE.WA'), ('Open', 'ALE.WA'), ('Volume', 'ALE.WA'), ('symbol', '')]
2025-02-26 23:01:31,512 - historical_importer - ERROR - Data types: Price   Ticker
Date              datetime64[ns]
Close   ALE.WA           float64
High    ALE.WA           float64
Low     ALE.WA           float64
Open    ALE.WA           float64
Volume  ALE.WA             int64
symbol                    object
dtype: object
2025-02-26 23:01:31,512 - historical_importer - INFO - Imported 0 records for ALE
2025-02-26 23:01:32,522 - historical_importer - INFO - Fetching 5 years of data for CPS.WA
2025-02-26 23:01:32,839 - historical_importer - ERROR - Error saving historical data: (psycopg2.errors.UndefinedColumn) column "symbol" of relation "staging_stock_prices" does not exist
LINE 1: INSERT INTO staging_stock_prices (symbol, timestamp, open, h...
                                          ^

[SQL: INSERT INTO staging_stock_prices (symbol, timestamp, open, high, low, close, volume) VALUES (%(symbol__0)s, %(timestamp__0)s, %(open__0)s, %(high__0)s, %(low__0)s, %(close__0)s, %(volume__0)s), (%(symbol__1)s, %(timestamp__1)s, %(open__1)s, %(high__1 ... 10570 characters truncated ... ol__99)s, %(timestamp__99)s, %(open__99)s, %(high__99)s, %(low__99)s, %(close__99)s, %(volume__99)s)]
[parameters: {'low__0': 21.72985272917954, 'symbol__0': 'CPS', 'open__0': 22.4611460095378, 'high__0': 22.931263829988, 'volume__0': 1302422, 'timestamp__0': datetime.datetime(2020, 2, 28, 0, 0), 'close__0': 21.93879508972168, 'low__1': 21.799501089841687, 'symbol__1': 'CPS', 'open__1': 21.86914798921284, 'high__1': 22.37408842478199, 'volume__1': 778331, 'timestamp__1': datetime.datetime(2020, 3, 2, 0, 0), 'close__1': 21.956205368041992, 'low__2': 21.95620476115267, 'symbol__2': 'CPS', 'open__2': 21.95620476115267, 'high__2': 22.879028227954144, 'volume__2': 750446, 'timestamp__2': datetime.datetime(2020, 3, 3, 0, 0), 'close__2': 22.84420394897461, 'low__3': 22.54820417303459, 'symbol__3': 'CPS', 'open__3': 22.63526320979023, 'high__3': 23.244674806566714, 'volume__3': 396941, 'timestamp__3': datetime.datetime(2020, 3, 4, 0, 0), 'close__3': 23.10538101196289, 'low__4': 21.95620508109026, 'symbol__4': 'CPS', 'open__4': 23.349144710821733, 'high__4': 23.366556850565225, 'volume__4': 672328, 'timestamp__4': datetime.datetime(2020, 3, 5, 0, 0), 'close__4': 22.408910751342773, 'low__5': 21.66020536420133, 'symbol__5': 'CPS', 'open__5': 22.095498895045925, 'high__5': 22.56561670540435, 'volume__5': 621666, 'timestamp__5': datetime.datetime(2020, 3, 6, 0, 0), 'close__5': 22.32185173034668, 'low__6': 20.632913207968333, 'symbol__6': 'CPS', 'open__6': 21.764675679075047, 'high__6': 21.764675679075047, 'volume__6': 639131, 'timestamp__6': datetime.datetime(2020, 3, 9, 0, 0), 'close__6': 20.859264373779297, 'low__7': 20.093149044603024 ... 600 parameters truncated ... 'close__92': 23.52326202392578, 'low__93': 23.296911040461662, 'symbol__93': 'CPS', 'open__93': 23.366557942176264, 'high__93': 23.697380310192347, 'volume__93': 211836, 'timestamp__93': datetime.datetime(2020, 7, 8, 0, 0), 'close__93': 23.50585174560547, 'low__94': 23.34914539358176, 'symbol__94': 'CPS', 'open__94': 23.34914539358176, 'high__94': 24.115262959567232, 'volume__94': 326610, 'timestamp__94': datetime.datetime(2020, 7, 9, 0, 0), 'close__94': 24.010791778564453, 'low__95': 23.645144908018555, 'symbol__95': 'CPS', 'open__95': 23.662557048103444, 'high__95': 24.393850326538086, 'volume__95': 345389, 'timestamp__95': datetime.datetime(2020, 7, 10, 0, 0), 'close__95': 24.393850326538086, 'low__96': 24.045616149902344, 'symbol__96': 'CPS', 'open__96': 24.550556595544833, 'high__96': 24.637613976110735, 'volume__96': 461023, 'timestamp__96': datetime.datetime(2020, 7, 13, 0, 0), 'close__96': 24.045616149902344, 'low__97': 23.592910529090034, 'symbol__97': 'CPS', 'open__97': 23.8889102732586, 'high__97': 24.097850976110568, 'volume__97': 334368, 'timestamp__97': datetime.datetime(2020, 7, 14, 0, 0), 'close__97': 23.975969314575195, 'low__98': 23.906320385843248, 'symbol__98': 'CPS', 'open__98': 24.16749750578062, 'high__98': 24.411262485619556, 'volume__98': 360317, 'timestamp__98': datetime.datetime(2020, 7, 15, 0, 0), 'close__98': 24.306791305541992, 'low__99': 24.219731886151727, 'symbol__99': 'CPS', 'open__99': 24.219731886151727, 'high__99': 24.759496597156225, 'volume__99': 196772, 'timestamp__99': datetime.datetime(2020, 7, 16, 0, 0), 'close__99': 24.724672317504883}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-02-26 23:01:32,839 - historical_importer - ERROR - Data columns: [('Date', ''), ('Close', 'CPS.WA'), ('High', 'CPS.WA'), ('Low', 'CPS.WA'), ('Open', 'CPS.WA'), ('Volume', 'CPS.WA'), ('symbol', '')]
2025-02-26 23:01:32,844 - historical_importer - ERROR - Data types: Price   Ticker
Date              datetime64[ns]
Close   CPS.WA           float64
High    CPS.WA           float64
Low     CPS.WA           float64
Open    CPS.WA           float64
Volume  CPS.WA             int64
symbol                    object
dtype: object
2025-02-26 23:01:32,845 - historical_importer - INFO - Imported 0 records for CPS
2025-02-26 23:01:33,847 - historical_importer - INFO - Fetching 5 years of data for CDR.WA
2025-02-26 23:01:34,204 - historical_importer - ERROR - Error saving historical data: (psycopg2.errors.UndefinedColumn) column "symbol" of relation "staging_stock_prices" does not exist
LINE 1: INSERT INTO staging_stock_prices (symbol, timestamp, open, h...
                                          ^

[SQL: INSERT INTO staging_stock_prices (symbol, timestamp, open, high, low, close, volume) VALUES (%(symbol__0)s, %(timestamp__0)s, %(open__0)s, %(high__0)s, %(low__0)s, %(close__0)s, %(volume__0)s), (%(symbol__1)s, %(timestamp__1)s, %(open__1)s, %(high__1 ... 10570 characters truncated ... ol__99)s, %(timestamp__99)s, %(open__99)s, %(high__99)s, %(low__99)s, %(close__99)s, %(volume__99)s)]
[parameters: {'low__0': 247.92706717294263, 'symbol__0': 'CDR', 'open__0': 261.5744225657821, 'high__0': 271.0517567167162, 'volume__0': 1106623, 'timestamp__0': datetime.datetime(2020, 2, 28, 0, 0), 'close__0': 263.9437561035156, 'low__1': 257.7835108285362, 'symbol__1': 'CDR', 'open__1': 272.852467625551, 'high__1': 282.424581716558, 'volume__1': 677207, 'timestamp__1': datetime.datetime(2020, 3, 2, 0, 0), 'close__1': 269.535400390625, 'low__2': 275.03224601667205, 'symbol__2': 'CDR', 'open__2': 279.58135479689844, 'high__2': 290.8593765448778, 'volume__2': 745525, 'timestamp__2': datetime.datetime(2020, 3, 3, 0, 0), 'close__2': 289.8168640136719, 'low__3': 277.212044821195, 'symbol__3': 'CDR', 'open__3': 284.60435444741455, 'high__3': 288.4900675268502, 'volume__3': 412457, 'timestamp__3': datetime.datetime(2020, 3, 4, 0, 0), 'close__3': 280.1500244140625, 'low__4': 278.8231833523116, 'symbol__4': 'CDR', 'open__4': 287.16322586791284, 'high__4': 289.5325594146778, 'volume__4': 303548, 'timestamp__4': datetime.datetime(2020, 3, 5, 0, 0), 'close__4': 282.04547119140625, 'low__5': 268.20853559554763, 'symbol__5': 'CDR', 'open__5': 279.20224813944634, 'high__5': 279.48655657283393, 'volume__5': 363928, 'timestamp__5': datetime.datetime(2020, 3, 6, 0, 0), 'close__5': 277.87542724609375, 'low__6': 245.93682980007594, 'symbol__6': 'CDR', 'open__6': 252.09709721317998, 'high__6': 269.15629928023725, 'volume__6': 706198, 'timestamp__6': datetime.datetime(2020, 3, 9, 0, 0), 'close__6': 255.88803100585938, 'low__7': 253.99258771687184 ... 600 parameters truncated ... 'close__92': 383.2633972167969, 'low__93': 376.1553620173015, 'symbol__93': 'CDR', 'open__93': 383.26336216472794, 'high__93': 383.92678708083173, 'volume__93': 182174, 'timestamp__93': datetime.datetime(2020, 7, 8, 0, 0), 'close__93': 378.2403869628906, 'low__94': 365.7303161621094, 'symbol__94': 'CDR', 'open__94': 378.33518783511323, 'high__94': 379.9463172743126, 'volume__94': 439101, 'timestamp__94': datetime.datetime(2020, 7, 9, 0, 0), 'close__94': 365.7303161621094, 'low__95': 359.1909689652292, 'symbol__95': 'CDR', 'open__95': 361.3707442791201, 'high__95': 365.82510295667146, 'volume__95': 390769, 'timestamp__95': datetime.datetime(2020, 7, 10, 0, 0), 'close__95': 360.1387023925781, 'low__96': 349.42932483017523, 'symbol__96': 'CDR', 'open__96': 362.98190121786195, 'high__96': 365.256455649865, 'volume__96': 454143, 'timestamp__96': datetime.datetime(2020, 7, 13, 0, 0), 'close__96': 350.1875, 'low__97': 332.74919017871764, 'symbol__97': 'CDR', 'open__97': 347.7233657741288, 'high__97': 348.67109913896564, 'volume__97': 624805, 'timestamp__97': datetime.datetime(2020, 7, 14, 0, 0), 'close__97': 335.40283203125, 'low__98': 338.71991918405695, 'symbol__98': 'CDR', 'open__98': 338.71991918405695, 'high__98': 359.38052513386594, 'volume__98': 564238, 'timestamp__98': datetime.datetime(2020, 7, 15, 0, 0), 'close__98': 345.9226989746094, 'low__99': 342.70040495742376, 'symbol__99': 'CDR', 'open__99': 346.8704261540045, 'high__99': 351.1352264755701, 'volume__99': 216848, 'timestamp__99': datetime.datetime(2020, 7, 16, 0, 0), 'close__99': 349.0502014160156}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-02-26 23:01:34,207 - historical_importer - ERROR - Data columns: [('Date', ''), ('Close', 'CDR.WA'), ('High', 'CDR.WA'), ('Low', 'CDR.WA'), ('Open', 'CDR.WA'), ('Volume', 'CDR.WA'), ('symbol', '')]
2025-02-26 23:01:34,210 - historical_importer - ERROR - Data types: Price   Ticker
Date              datetime64[ns]
Close   CDR.WA           float64
High    CDR.WA           float64
Low     CDR.WA           float64
Open    CDR.WA           float64
Volume  CDR.WA             int64
symbol                    object
dtype: object
2025-02-26 23:01:34,210 - historical_importer - INFO - Imported 0 records for CDR
2025-02-26 23:01:35,225 - historical_importer - INFO - Fetching 5 years of data for MBK.WA
2025-02-26 23:01:35,495 - historical_importer - ERROR - Error saving historical data: (psycopg2.errors.UndefinedColumn) column "symbol" of relation "staging_stock_prices" does not exist
LINE 1: INSERT INTO staging_stock_prices (symbol, timestamp, open, h...
                                          ^

[SQL: INSERT INTO staging_stock_prices (symbol, timestamp, open, high, low, close, volume) VALUES (%(symbol__0)s, %(timestamp__0)s, %(open__0)s, %(high__0)s, %(low__0)s, %(close__0)s, %(volume__0)s), (%(symbol__1)s, %(timestamp__1)s, %(open__1)s, %(high__1 ... 10570 characters truncated ... ol__99)s, %(timestamp__99)s, %(open__99)s, %(high__99)s, %(low__99)s, %(close__99)s, %(volume__99)s)]
[parameters: {'low__0': 296.1435546875, 'symbol__0': 'MBK', 'open__0': 319.00027199559565, 'high__0': 324.76412770752137, 'volume__0': 42576, 'timestamp__0': datetime.datetime(2020, 2, 28, 0, 0), 'close__0': 296.1435546875, 'low__1': 286.4046187842701, 'symbol__1': 'MBK', 'open__1': 302.10617773281945, 'high__1': 305.08748869728805, 'volume__1': 40944, 'timestamp__1': datetime.datetime(2020, 3, 2, 0, 0), 'close__1': 294.9510192871094, 'low__2': 296.34231944281794, 'symbol__2': 'MBK', 'open__2': 303.09994543966786, 'high__2': 333.31055688685035, 'volume__2': 25817, 'timestamp__2': datetime.datetime(2020, 3, 3, 0, 0), 'close__2': 328.3417053222656, 'low__3': 312.04386103149795, 'symbol__3': 'MBK', 'open__3': 328.9379554185536, 'high__3': 328.9379554185536, 'volume__3': 29914, 'timestamp__3': datetime.datetime(2020, 3, 4, 0, 0), 'close__3': 315.22393798828125, 'low__4': 304.09372646657584, 'symbol__4': 'MBK', 'open__4': 322.97536307724556, 'high__4': 322.97536307724556, 'volume__4': 13766, 'timestamp__4': datetime.datetime(2020, 3, 5, 0, 0), 'close__4': 307.2738037109375, 'low__5': 293.1622350112474, 'symbol__5': 'MBK', 'open__5': 298.7273546905127, 'high__5': 303.0999378929846, 'volume__5': 21850, 'timestamp__5': datetime.datetime(2020, 3, 6, 0, 0), 'close__5': 299.91986083984375, 'low__6': 261.9578552246094, 'symbol__6': 'MBK', 'open__6': 294.75227488413464, 'high__6': 294.75227488413464, 'volume__6': 28741, 'timestamp__6': datetime.datetime(2020, 3, 9, 0, 0), 'close__6': 261.9578552246094, 'low__7': 239.8961463852047 ... 600 parameters truncated ... 'close__92': 234.0, 'low__93': 226.1999969482422, 'symbol__93': 'MBK', 'open__93': 231.60000610351562, 'high__93': 234.0, 'volume__93': 40771, 'timestamp__93': datetime.datetime(2020, 7, 8, 0, 0), 'close__93': 229.1999969482422, 'low__94': 226.60000610351562, 'symbol__94': 'MBK', 'open__94': 229.1999969482422, 'high__94': 233.0, 'volume__94': 27042, 'timestamp__94': datetime.datetime(2020, 7, 9, 0, 0), 'close__94': 228.1999969482422, 'low__95': 222.39999389648438, 'symbol__95': 'MBK', 'open__95': 226.0, 'high__95': 229.1999969482422, 'volume__95': 20472, 'timestamp__95': datetime.datetime(2020, 7, 10, 0, 0), 'close__95': 229.1999969482422, 'low__96': 225.0, 'symbol__96': 'MBK', 'open__96': 230.8000030517578, 'high__96': 234.0, 'volume__96': 32931, 'timestamp__96': datetime.datetime(2020, 7, 13, 0, 0), 'close__96': 230.0, 'low__97': 222.39999389648438, 'symbol__97': 'MBK', 'open__97': 228.0, 'high__97': 229.39999389648438, 'volume__97': 25613, 'timestamp__97': datetime.datetime(2020, 7, 14, 0, 0), 'close__97': 224.39999389648438, 'low__98': 221.0, 'symbol__98': 'MBK', 'open__98': 224.39999389648438, 'high__98': 225.1999969482422, 'volume__98': 32807, 'timestamp__98': datetime.datetime(2020, 7, 15, 0, 0), 'close__98': 223.0, 'low__99': 212.0, 'symbol__99': 'MBK', 'open__99': 223.0, 'high__99': 223.0, 'volume__99': 32797, 'timestamp__99': datetime.datetime(2020, 7, 16, 0, 0), 'close__99': 216.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-02-26 23:01:35,496 - historical_importer - ERROR - Data columns: [('Date', ''), ('Close', 'MBK.WA'), ('High', 'MBK.WA'), ('Low', 'MBK.WA'), ('Open', 'MBK.WA'), ('Volume', 'MBK.WA'), ('symbol', '')]
2025-02-26 23:01:35,497 - historical_importer - ERROR - Data types: Price   Ticker
Date              datetime64[ns]
Close   MBK.WA           float64
High    MBK.WA           float64
Low     MBK.WA           float64
Open    MBK.WA           float64
Volume  MBK.WA             int64
symbol                    object
dtype: object
2025-02-26 23:01:35,497 - historical_importer - INFO - Imported 0 records for MBK
2025-02-26 23:01:36,504 - historical_importer - INFO - Fetching 5 years of data for DNP.WA
2025-02-26 23:01:36,689 - historical_importer - ERROR - Error saving historical data: (psycopg2.errors.UndefinedColumn) column "symbol" of relation "staging_stock_prices" does not exist
LINE 1: INSERT INTO staging_stock_prices (symbol, timestamp, open, h...
                                          ^

[SQL: INSERT INTO staging_stock_prices (symbol, timestamp, open, high, low, close, volume) VALUES (%(symbol__0)s, %(timestamp__0)s, %(open__0)s, %(high__0)s, %(low__0)s, %(close__0)s, %(volume__0)s), (%(symbol__1)s, %(timestamp__1)s, %(open__1)s, %(high__1 ... 10570 characters truncated ... ol__99)s, %(timestamp__99)s, %(open__99)s, %(high__99)s, %(low__99)s, %(close__99)s, %(volume__99)s)]
[parameters: {'low__0': 136.39999389648438, 'symbol__0': 'DNP', 'open__0': 139.39999389648438, 'high__0': 145.6999969482422, 'volume__0': 567867, 'timestamp__0': datetime.datetime(2020, 2, 28, 0, 0), 'close__0': 141.8000030517578, 'low__1': 146.60000610351562, 'symbol__1': 'DNP', 'open__1': 146.60000610351562, 'high__1': 154.6999969482422, 'volume__1': 375327, 'timestamp__1': datetime.datetime(2020, 3, 2, 0, 0), 'close__1': 151.8000030517578, 'low__2': 153.0, 'symbol__2': 'DNP', 'open__2': 153.0, 'high__2': 161.10000610351562, 'volume__2': 343482, 'timestamp__2': datetime.datetime(2020, 3, 3, 0, 0), 'close__2': 155.0, 'low__3': 152.1999969482422, 'symbol__3': 'DNP', 'open__3': 152.1999969482422, 'high__3': 158.0, 'volume__3': 134702, 'timestamp__3': datetime.datetime(2020, 3, 4, 0, 0), 'close__3': 154.6999969482422, 'low__4': 155.1999969482422, 'symbol__4': 'DNP', 'open__4': 157.39999389648438, 'high__4': 159.1999969482422, 'volume__4': 133927, 'timestamp__4': datetime.datetime(2020, 3, 5, 0, 0), 'close__4': 157.89999389648438, 'low__5': 153.1999969482422, 'symbol__5': 'DNP', 'open__5': 156.0, 'high__5': 157.1999969482422, 'volume__5': 137724, 'timestamp__5': datetime.datetime(2020, 3, 6, 0, 0), 'close__5': 156.5, 'low__6': 144.6999969482422, 'symbol__6': 'DNP', 'open__6': 145.0, 'high__6': 152.0, 'volume__6': 199497, 'timestamp__6': datetime.datetime(2020, 3, 9, 0, 0), 'close__6': 145.60000610351562, 'low__7': 146.0 ... 600 parameters truncated ... 'close__92': 203.0, 'low__93': 198.39999389648438, 'symbol__93': 'DNP', 'open__93': 203.1999969482422, 'high__93': 203.1999969482422, 'volume__93': 232646, 'timestamp__93': datetime.datetime(2020, 7, 8, 0, 0), 'close__93': 199.0, 'low__94': 193.89999389648438, 'symbol__94': 'DNP', 'open__94': 200.0, 'high__94': 200.60000610351562, 'volume__94': 190262, 'timestamp__94': datetime.datetime(2020, 7, 9, 0, 0), 'close__94': 196.1999969482422, 'low__95': 196.39999389648438, 'symbol__95': 'DNP', 'open__95': 196.5, 'high__95': 202.0, 'volume__95': 202560, 'timestamp__95': datetime.datetime(2020, 7, 10, 0, 0), 'close__95': 201.8000030517578, 'low__96': 198.8000030517578, 'symbol__96': 'DNP', 'open__96': 202.1999969482422, 'high__96': 203.1999969482422, 'volume__96': 142095, 'timestamp__96': datetime.datetime(2020, 7, 13, 0, 0), 'close__96': 203.1999969482422, 'low__97': 199.0, 'symbol__97': 'DNP', 'open__97': 202.39999389648438, 'high__97': 203.0, 'volume__97': 182156, 'timestamp__97': datetime.datetime(2020, 7, 14, 0, 0), 'close__97': 200.0, 'low__98': 199.1999969482422, 'symbol__98': 'DNP', 'open__98': 201.0, 'high__98': 201.39999389648438, 'volume__98': 127360, 'timestamp__98': datetime.datetime(2020, 7, 15, 0, 0), 'close__98': 201.0, 'low__99': 198.1999969482422, 'symbol__99': 'DNP', 'open__99': 201.39999389648438, 'high__99': 201.39999389648438, 'volume__99': 69413, 'timestamp__99': datetime.datetime(2020, 7, 16, 0, 0), 'close__99': 199.60000610351562}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-02-26 23:01:36,690 - historical_importer - ERROR - Data columns: [('Date', ''), ('Close', 'DNP.WA'), ('High', 'DNP.WA'), ('Low', 'DNP.WA'), ('Open', 'DNP.WA'), ('Volume', 'DNP.WA'), ('symbol', '')]
2025-02-26 23:01:36,690 - historical_importer - ERROR - Data types: Price   Ticker
Date              datetime64[ns]
Close   DNP.WA           float64
High    DNP.WA           float64
Low     DNP.WA           float64
Open    DNP.WA           float64
Volume  DNP.WA             int64
symbol                    object
dtype: object
2025-02-26 23:01:36,690 - historical_importer - INFO - Imported 0 records for DNP
2025-02-26 23:01:37,698 - historical_importer - INFO - Completed historical data import. Processed 0 records for 12 symbols
2025-02-26 23:06:08,503 - historical_importer - INFO - Starting historical data import
2025-02-26 23:06:08,537 - historical_importer - INFO - Importing 5 years of historical data
2025-02-26 23:06:08,550 - historical_importer - INFO - Fetching 5 years of data for PKO.WA
2025-02-26 23:06:09,620 - historical_importer - ERROR - Error saving historical data: (psycopg2.errors.UndefinedTable) relation "historical_stock_prices" does not exist
LINE 2:                 INSERT INTO historical_stock_prices 
                                    ^

[SQL: 
                INSERT INTO historical_stock_prices 
                (symbol, timestamp, open, high, low, close, volume)
                SELECT symbol, timestamp, open, high, low, close, volume 
                FROM staging_stock_prices
                ON CONFLICT (symbol, timestamp) 
                DO UPDATE SET
                    open = EXCLUDED.open,
                    high = EXCLUDED.high,
                    low = EXCLUDED.low,
                    close = EXCLUDED.close,
                    volume = EXCLUDED.volume;
            ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-02-26 23:06:09,621 - historical_importer - ERROR - Data columns: [('Date', ''), ('Close', 'PKO.WA'), ('High', 'PKO.WA'), ('Low', 'PKO.WA'), ('Open', 'PKO.WA'), ('Volume', 'PKO.WA'), ('symbol', '')]
2025-02-26 23:06:09,622 - historical_importer - ERROR - Data types: Price   Ticker
Date              datetime64[ns]
Close   PKO.WA           float64
High    PKO.WA           float64
Low     PKO.WA           float64
Open    PKO.WA           float64
Volume  PKO.WA             int64
symbol                    object
dtype: object
2025-02-26 23:06:09,622 - historical_importer - INFO - Imported 0 records for PKO
2025-02-26 23:06:10,631 - historical_importer - INFO - Fetching 5 years of data for PKN.WA
2025-02-26 23:06:11,008 - historical_importer - ERROR - Error saving historical data: (psycopg2.errors.UndefinedTable) relation "historical_stock_prices" does not exist
LINE 2:                 INSERT INTO historical_stock_prices 
                                    ^

[SQL: 
                INSERT INTO historical_stock_prices 
                (symbol, timestamp, open, high, low, close, volume)
                SELECT symbol, timestamp, open, high, low, close, volume 
                FROM staging_stock_prices
                ON CONFLICT (symbol, timestamp) 
                DO UPDATE SET
                    open = EXCLUDED.open,
                    high = EXCLUDED.high,
                    low = EXCLUDED.low,
                    close = EXCLUDED.close,
                    volume = EXCLUDED.volume;
            ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-02-26 23:06:11,008 - historical_importer - ERROR - Data columns: [('Date', ''), ('Close', 'PKN.WA'), ('High', 'PKN.WA'), ('Low', 'PKN.WA'), ('Open', 'PKN.WA'), ('Volume', 'PKN.WA'), ('symbol', '')]
2025-02-26 23:06:11,009 - historical_importer - ERROR - Data types: Price   Ticker
Date              datetime64[ns]
Close   PKN.WA           float64
High    PKN.WA           float64
Low     PKN.WA           float64
Open    PKN.WA           float64
Volume  PKN.WA             int64
symbol                    object
dtype: object
2025-02-26 23:06:11,009 - historical_importer - INFO - Imported 0 records for PKN
2025-02-26 23:06:12,011 - historical_importer - INFO - Fetching 5 years of data for PZU.WA
2025-02-26 23:06:12,357 - historical_importer - ERROR - Error saving historical data: (psycopg2.errors.UndefinedTable) relation "historical_stock_prices" does not exist
LINE 2:                 INSERT INTO historical_stock_prices 
                                    ^

[SQL: 
                INSERT INTO historical_stock_prices 
                (symbol, timestamp, open, high, low, close, volume)
                SELECT symbol, timestamp, open, high, low, close, volume 
                FROM staging_stock_prices
                ON CONFLICT (symbol, timestamp) 
                DO UPDATE SET
                    open = EXCLUDED.open,
                    high = EXCLUDED.high,
                    low = EXCLUDED.low,
                    close = EXCLUDED.close,
                    volume = EXCLUDED.volume;
            ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-02-26 23:06:12,358 - historical_importer - ERROR - Data columns: [('Date', ''), ('Close', 'PZU.WA'), ('High', 'PZU.WA'), ('Low', 'PZU.WA'), ('Open', 'PZU.WA'), ('Volume', 'PZU.WA'), ('symbol', '')]
2025-02-26 23:06:12,359 - historical_importer - ERROR - Data types: Price   Ticker
Date              datetime64[ns]
Close   PZU.WA           float64
High    PZU.WA           float64
Low     PZU.WA           float64
Open    PZU.WA           float64
Volume  PZU.WA             int64
symbol                    object
dtype: object
2025-02-26 23:06:12,359 - historical_importer - INFO - Imported 0 records for PZU
2025-02-26 23:06:13,365 - historical_importer - INFO - Fetching 5 years of data for PEO.WA
2025-02-26 23:06:13,730 - historical_importer - ERROR - Error saving historical data: (psycopg2.errors.UndefinedTable) relation "historical_stock_prices" does not exist
LINE 2:                 INSERT INTO historical_stock_prices 
                                    ^

[SQL: 
                INSERT INTO historical_stock_prices 
                (symbol, timestamp, open, high, low, close, volume)
                SELECT symbol, timestamp, open, high, low, close, volume 
                FROM staging_stock_prices
                ON CONFLICT (symbol, timestamp) 
                DO UPDATE SET
                    open = EXCLUDED.open,
                    high = EXCLUDED.high,
                    low = EXCLUDED.low,
                    close = EXCLUDED.close,
                    volume = EXCLUDED.volume;
            ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-02-26 23:06:13,730 - historical_importer - ERROR - Data columns: [('Date', ''), ('Close', 'PEO.WA'), ('High', 'PEO.WA'), ('Low', 'PEO.WA'), ('Open', 'PEO.WA'), ('Volume', 'PEO.WA'), ('symbol', '')]
2025-02-26 23:06:13,731 - historical_importer - ERROR - Data types: Price   Ticker
Date              datetime64[ns]
Close   PEO.WA           float64
High    PEO.WA           float64
Low     PEO.WA           float64
Open    PEO.WA           float64
Volume  PEO.WA             int64
symbol                    object
dtype: object
2025-02-26 23:06:13,731 - historical_importer - INFO - Imported 0 records for PEO
2025-02-26 23:06:14,736 - historical_importer - INFO - Fetching 5 years of data for KGH.WA
2025-02-26 23:06:15,097 - historical_importer - ERROR - Error saving historical data: (psycopg2.errors.UndefinedTable) relation "historical_stock_prices" does not exist
LINE 2:                 INSERT INTO historical_stock_prices 
                                    ^

[SQL: 
                INSERT INTO historical_stock_prices 
                (symbol, timestamp, open, high, low, close, volume)
                SELECT symbol, timestamp, open, high, low, close, volume 
                FROM staging_stock_prices
                ON CONFLICT (symbol, timestamp) 
                DO UPDATE SET
                    open = EXCLUDED.open,
                    high = EXCLUDED.high,
                    low = EXCLUDED.low,
                    close = EXCLUDED.close,
                    volume = EXCLUDED.volume;
            ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-02-26 23:06:15,097 - historical_importer - ERROR - Data columns: [('Date', ''), ('Close', 'KGH.WA'), ('High', 'KGH.WA'), ('Low', 'KGH.WA'), ('Open', 'KGH.WA'), ('Volume', 'KGH.WA'), ('symbol', '')]
2025-02-26 23:06:15,098 - historical_importer - ERROR - Data types: Price   Ticker
Date              datetime64[ns]
Close   KGH.WA           float64
High    KGH.WA           float64
Low     KGH.WA           float64
Open    KGH.WA           float64
Volume  KGH.WA             int64
symbol                    object
dtype: object
2025-02-26 23:06:15,098 - historical_importer - INFO - Imported 0 records for KGH
2025-02-26 23:06:16,101 - historical_importer - INFO - Fetching 5 years of data for LPP.WA
2025-02-26 23:06:16,452 - historical_importer - ERROR - Error saving historical data: (psycopg2.errors.UndefinedTable) relation "historical_stock_prices" does not exist
LINE 2:                 INSERT INTO historical_stock_prices 
                                    ^

[SQL: 
                INSERT INTO historical_stock_prices 
                (symbol, timestamp, open, high, low, close, volume)
                SELECT symbol, timestamp, open, high, low, close, volume 
                FROM staging_stock_prices
                ON CONFLICT (symbol, timestamp) 
                DO UPDATE SET
                    open = EXCLUDED.open,
                    high = EXCLUDED.high,
                    low = EXCLUDED.low,
                    close = EXCLUDED.close,
                    volume = EXCLUDED.volume;
            ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-02-26 23:06:16,452 - historical_importer - ERROR - Data columns: [('Date', ''), ('Close', 'LPP.WA'), ('High', 'LPP.WA'), ('Low', 'LPP.WA'), ('Open', 'LPP.WA'), ('Volume', 'LPP.WA'), ('symbol', '')]
2025-02-26 23:06:16,453 - historical_importer - ERROR - Data types: Price   Ticker
Date              datetime64[ns]
Close   LPP.WA           float64
High    LPP.WA           float64
Low     LPP.WA           float64
Open    LPP.WA           float64
Volume  LPP.WA             int64
symbol                    object
dtype: object
2025-02-26 23:06:16,453 - historical_importer - INFO - Imported 0 records for LPP
2025-02-26 23:06:17,459 - historical_importer - INFO - Fetching 5 years of data for SPL.WA
2025-02-26 23:06:17,831 - historical_importer - ERROR - Error saving historical data: (psycopg2.errors.UndefinedTable) relation "historical_stock_prices" does not exist
LINE 2:                 INSERT INTO historical_stock_prices 
                                    ^

[SQL: 
                INSERT INTO historical_stock_prices 
                (symbol, timestamp, open, high, low, close, volume)
                SELECT symbol, timestamp, open, high, low, close, volume 
                FROM staging_stock_prices
                ON CONFLICT (symbol, timestamp) 
                DO UPDATE SET
                    open = EXCLUDED.open,
                    high = EXCLUDED.high,
                    low = EXCLUDED.low,
                    close = EXCLUDED.close,
                    volume = EXCLUDED.volume;
            ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-02-26 23:06:17,832 - historical_importer - ERROR - Data columns: [('Date', ''), ('Close', 'SPL.WA'), ('High', 'SPL.WA'), ('Low', 'SPL.WA'), ('Open', 'SPL.WA'), ('Volume', 'SPL.WA'), ('symbol', '')]
2025-02-26 23:06:17,832 - historical_importer - ERROR - Data types: Price   Ticker
Date              datetime64[ns]
Close   SPL.WA           float64
High    SPL.WA           float64
Low     SPL.WA           float64
Open    SPL.WA           float64
Volume  SPL.WA             int64
symbol                    object
dtype: object
2025-02-26 23:06:17,832 - historical_importer - INFO - Imported 0 records for SPL
2025-02-26 23:06:18,835 - historical_importer - INFO - Fetching 5 years of data for ALE.WA
2025-02-26 23:06:19,106 - historical_importer - ERROR - Error saving historical data: (psycopg2.errors.UndefinedTable) relation "historical_stock_prices" does not exist
LINE 2:                 INSERT INTO historical_stock_prices 
                                    ^

[SQL: 
                INSERT INTO historical_stock_prices 
                (symbol, timestamp, open, high, low, close, volume)
                SELECT symbol, timestamp, open, high, low, close, volume 
                FROM staging_stock_prices
                ON CONFLICT (symbol, timestamp) 
                DO UPDATE SET
                    open = EXCLUDED.open,
                    high = EXCLUDED.high,
                    low = EXCLUDED.low,
                    close = EXCLUDED.close,
                    volume = EXCLUDED.volume;
            ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-02-26 23:06:19,106 - historical_importer - ERROR - Data columns: [('Date', ''), ('Close', 'ALE.WA'), ('High', 'ALE.WA'), ('Low', 'ALE.WA'), ('Open', 'ALE.WA'), ('Volume', 'ALE.WA'), ('symbol', '')]
2025-02-26 23:06:19,107 - historical_importer - ERROR - Data types: Price   Ticker
Date              datetime64[ns]
Close   ALE.WA           float64
High    ALE.WA           float64
Low     ALE.WA           float64
Open    ALE.WA           float64
Volume  ALE.WA             int64
symbol                    object
dtype: object
2025-02-26 23:06:19,107 - historical_importer - INFO - Imported 0 records for ALE
2025-02-26 23:06:20,117 - historical_importer - INFO - Fetching 5 years of data for CPS.WA
2025-02-26 23:06:20,487 - historical_importer - ERROR - Error saving historical data: (psycopg2.errors.UndefinedTable) relation "historical_stock_prices" does not exist
LINE 2:                 INSERT INTO historical_stock_prices 
                                    ^

[SQL: 
                INSERT INTO historical_stock_prices 
                (symbol, timestamp, open, high, low, close, volume)
                SELECT symbol, timestamp, open, high, low, close, volume 
                FROM staging_stock_prices
                ON CONFLICT (symbol, timestamp) 
                DO UPDATE SET
                    open = EXCLUDED.open,
                    high = EXCLUDED.high,
                    low = EXCLUDED.low,
                    close = EXCLUDED.close,
                    volume = EXCLUDED.volume;
            ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-02-26 23:06:20,487 - historical_importer - ERROR - Data columns: [('Date', ''), ('Close', 'CPS.WA'), ('High', 'CPS.WA'), ('Low', 'CPS.WA'), ('Open', 'CPS.WA'), ('Volume', 'CPS.WA'), ('symbol', '')]
2025-02-26 23:06:20,488 - historical_importer - ERROR - Data types: Price   Ticker
Date              datetime64[ns]
Close   CPS.WA           float64
High    CPS.WA           float64
Low     CPS.WA           float64
Open    CPS.WA           float64
Volume  CPS.WA             int64
symbol                    object
dtype: object
2025-02-26 23:06:20,488 - historical_importer - INFO - Imported 0 records for CPS
2025-02-26 23:06:21,492 - historical_importer - INFO - Fetching 5 years of data for CDR.WA
2025-02-26 23:06:21,830 - historical_importer - ERROR - Error saving historical data: (psycopg2.errors.UndefinedTable) relation "historical_stock_prices" does not exist
LINE 2:                 INSERT INTO historical_stock_prices 
                                    ^

[SQL: 
                INSERT INTO historical_stock_prices 
                (symbol, timestamp, open, high, low, close, volume)
                SELECT symbol, timestamp, open, high, low, close, volume 
                FROM staging_stock_prices
                ON CONFLICT (symbol, timestamp) 
                DO UPDATE SET
                    open = EXCLUDED.open,
                    high = EXCLUDED.high,
                    low = EXCLUDED.low,
                    close = EXCLUDED.close,
                    volume = EXCLUDED.volume;
            ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-02-26 23:06:21,830 - historical_importer - ERROR - Data columns: [('Date', ''), ('Close', 'CDR.WA'), ('High', 'CDR.WA'), ('Low', 'CDR.WA'), ('Open', 'CDR.WA'), ('Volume', 'CDR.WA'), ('symbol', '')]
2025-02-26 23:06:21,831 - historical_importer - ERROR - Data types: Price   Ticker
Date              datetime64[ns]
Close   CDR.WA           float64
High    CDR.WA           float64
Low     CDR.WA           float64
Open    CDR.WA           float64
Volume  CDR.WA             int64
symbol                    object
dtype: object
2025-02-26 23:06:21,831 - historical_importer - INFO - Imported 0 records for CDR
2025-02-26 23:06:22,850 - historical_importer - INFO - Fetching 5 years of data for MBK.WA
2025-02-26 23:06:23,223 - historical_importer - ERROR - Error saving historical data: (psycopg2.errors.UndefinedTable) relation "historical_stock_prices" does not exist
LINE 2:                 INSERT INTO historical_stock_prices 
                                    ^

[SQL: 
                INSERT INTO historical_stock_prices 
                (symbol, timestamp, open, high, low, close, volume)
                SELECT symbol, timestamp, open, high, low, close, volume 
                FROM staging_stock_prices
                ON CONFLICT (symbol, timestamp) 
                DO UPDATE SET
                    open = EXCLUDED.open,
                    high = EXCLUDED.high,
                    low = EXCLUDED.low,
                    close = EXCLUDED.close,
                    volume = EXCLUDED.volume;
            ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-02-26 23:06:23,223 - historical_importer - ERROR - Data columns: [('Date', ''), ('Close', 'MBK.WA'), ('High', 'MBK.WA'), ('Low', 'MBK.WA'), ('Open', 'MBK.WA'), ('Volume', 'MBK.WA'), ('symbol', '')]
2025-02-26 23:06:23,224 - historical_importer - ERROR - Data types: Price   Ticker
Date              datetime64[ns]
Close   MBK.WA           float64
High    MBK.WA           float64
Low     MBK.WA           float64
Open    MBK.WA           float64
Volume  MBK.WA             int64
symbol                    object
dtype: object
2025-02-26 23:06:23,224 - historical_importer - INFO - Imported 0 records for MBK
2025-02-26 23:06:24,229 - historical_importer - INFO - Fetching 5 years of data for DNP.WA
2025-02-26 23:06:24,595 - historical_importer - ERROR - Error saving historical data: (psycopg2.errors.UndefinedTable) relation "historical_stock_prices" does not exist
LINE 2:                 INSERT INTO historical_stock_prices 
                                    ^

[SQL: 
                INSERT INTO historical_stock_prices 
                (symbol, timestamp, open, high, low, close, volume)
                SELECT symbol, timestamp, open, high, low, close, volume 
                FROM staging_stock_prices
                ON CONFLICT (symbol, timestamp) 
                DO UPDATE SET
                    open = EXCLUDED.open,
                    high = EXCLUDED.high,
                    low = EXCLUDED.low,
                    close = EXCLUDED.close,
                    volume = EXCLUDED.volume;
            ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-02-26 23:06:24,595 - historical_importer - ERROR - Data columns: [('Date', ''), ('Close', 'DNP.WA'), ('High', 'DNP.WA'), ('Low', 'DNP.WA'), ('Open', 'DNP.WA'), ('Volume', 'DNP.WA'), ('symbol', '')]
2025-02-26 23:06:24,596 - historical_importer - ERROR - Data types: Price   Ticker
Date              datetime64[ns]
Close   DNP.WA           float64
High    DNP.WA           float64
Low     DNP.WA           float64
Open    DNP.WA           float64
Volume  DNP.WA             int64
symbol                    object
dtype: object
2025-02-26 23:06:24,596 - historical_importer - INFO - Imported 0 records for DNP
2025-02-26 23:06:25,599 - historical_importer - INFO - Completed historical data import. Processed 0 records for 12 symbols
